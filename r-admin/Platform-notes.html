<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.30">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Appendix C — Platform notes – R Manuals :: R Installation and Administration ¶</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Configuration-on-a-Unix-alike.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-de070a7b0ab54f8780927367ac907214.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-f840150906254a7d63b5d791c75ffa18.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">R Manuals :: R Installation and Administration ¶</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-manuals" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Manuals</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-manuals">    
        <li>
    <a class="dropdown-item" href="./../r-intro/index.html">
 <span class="dropdown-text">An Introduction to R ¶</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./../r-data/index.html">
 <span class="dropdown-text">R Data Import/Export ¶</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./../r-admin/index.html">
 <span class="dropdown-text">R Installation and Administration ¶</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./../r-exts/index.html">
 <span class="dropdown-text">Writing R Extensions ¶</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./../r-lang/index.html">
 <span class="dropdown-text">R Language Definition ¶</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./../r-ints/index.html">
 <span class="dropdown-text">R Internals ¶</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Essential-and-useful-other-programs-under-a-Unix-alike.html">Appendices</a></li><li class="breadcrumb-item"><a href="./Platform-notes.html"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Platform notes</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Top (R Installation and Administration)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Obtaining-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Obtaining R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Installing-R-under-Unix-alikes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Installing R under Unix-alikes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Installing-R-under-Windows.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Installing R under Windows</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Installing-R-under-macOS.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Installing R under macOS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Running-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Running R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Add-on-packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Add-on packages</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Internationalization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Internationalization and Localization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Choosing-between-32--and-64-bit-builds.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Choosing between 32- and 64-bit builds</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./The-standalone-Rmath-library.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">The standalone Rmath library</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Function-and-variable-index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Function and variable index</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Environment-variable-index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Environment variable index</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Concept-index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Concept index</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Essential-and-useful-other-programs-under-a-Unix-alike.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Essential and useful other programs under a Unix-alike</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Configuration-on-a-Unix-alike.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Configuration on a Unix-alike</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Platform-notes.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Platform notes</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#x11-issues" id="toc-x11-issues" class="nav-link active" data-scroll-target="#x11-issues"><span class="header-section-number">C.1</span> X11 issues</a></li>
  <li><a href="#linux" id="toc-linux" class="nav-link" data-scroll-target="#linux"><span class="header-section-number">C.2</span> Linux</a>
  <ul class="collapse">
  <li><a href="#clang" id="toc-clang" class="nav-link" data-scroll-target="#clang"><span class="header-section-number">C.2.1</span> Clang</a></li>
  <li><a href="#flang" id="toc-flang" class="nav-link" data-scroll-target="#flang"><span class="header-section-number">C.2.2</span> flang</a></li>
  <li><a href="#intel-compilers" id="toc-intel-compilers" class="nav-link" data-scroll-target="#intel-compilers"><span class="header-section-number">C.2.3</span> Intel compilers</a></li>
  </ul></li>
  <li><a href="#macos" id="toc-macos" class="nav-link" data-scroll-target="#macos"><span class="header-section-number">C.3</span> macOS</a>
  <ul class="collapse">
  <li><a href="#prerequisites" id="toc-prerequisites" class="nav-link" data-scroll-target="#prerequisites"><span class="header-section-number">C.3.1</span> Prerequisites</a></li>
  <li><a href="#fortran-compiler" id="toc-fortran-compiler" class="nav-link" data-scroll-target="#fortran-compiler"><span class="header-section-number">C.3.2</span> Fortran compiler</a></li>
  <li><a href="#cairo-graphics" id="toc-cairo-graphics" class="nav-link" data-scroll-target="#cairo-graphics"><span class="header-section-number">C.3.3</span> Cairo graphics</a></li>
  <li><a href="#other-cc-compilers" id="toc-other-cc-compilers" class="nav-link" data-scroll-target="#other-cc-compilers"><span class="header-section-number">C.3.4</span> Other C/C++ compilers</a></li>
  <li><a href="#other-libraries" id="toc-other-libraries" class="nav-link" data-scroll-target="#other-libraries"><span class="header-section-number">C.3.5</span> Other libraries</a></li>
  <li><a href="#accelerate" id="toc-accelerate" class="nav-link" data-scroll-target="#accelerate"><span class="header-section-number">C.3.6</span> Accelerate</a></li>
  <li><a href="#openblas" id="toc-openblas" class="nav-link" data-scroll-target="#openblas"><span class="header-section-number">C.3.7</span> OpenBLAS</a></li>
  <li><a href="#tcltk-headers-and-libraries" id="toc-tcltk-headers-and-libraries" class="nav-link" data-scroll-target="#tcltk-headers-and-libraries"><span class="header-section-number">C.3.8</span> Tcl/Tk headers and libraries</a></li>
  <li><a href="#java" id="toc-java" class="nav-link" data-scroll-target="#java"><span class="header-section-number">C.3.9</span> Java</a></li>
  <li><a href="#frameworks" id="toc-frameworks" class="nav-link" data-scroll-target="#frameworks"><span class="header-section-number">C.3.10</span> Frameworks</a></li>
  <li><a href="#building-r.app" id="toc-building-r.app" class="nav-link" data-scroll-target="#building-r.app"><span class="header-section-number">C.3.11</span> Building R.app</a></li>
  <li><a href="#building-binary-packages" id="toc-building-binary-packages" class="nav-link" data-scroll-target="#building-binary-packages"><span class="header-section-number">C.3.12</span> Building binary packages</a></li>
  <li><a href="#building-for-intel-on-arm64" id="toc-building-for-intel-on-arm64" class="nav-link" data-scroll-target="#building-for-intel-on-arm64"><span class="header-section-number">C.3.13</span> Building for Intel on <samp class="samp">arm64</samp>’</a></li>
  <li><a href="#installer" id="toc-installer" class="nav-link" data-scroll-target="#installer"><span class="header-section-number">C.3.14</span> Installer</a></li>
  </ul></li>
  <li><a href="#freebsd" id="toc-freebsd" class="nav-link" data-scroll-target="#freebsd"><span class="header-section-number">C.4</span> FreeBSD</a></li>
  <li><a href="#openbsd" id="toc-openbsd" class="nav-link" data-scroll-target="#openbsd"><span class="header-section-number">C.5</span> OpenBSD</a></li>
  <li><a href="#cygwin" id="toc-cygwin" class="nav-link" data-scroll-target="#cygwin"><span class="header-section-number">C.6</span> Cygwin</a></li>
  <li><a href="#new-platforms" id="toc-new-platforms" class="nav-link" data-scroll-target="#new-platforms"><span class="header-section-number">C.7</span> New platforms</a>
  <ul class="collapse">
  <li><a href="#footnotes" id="toc-footnotes" class="nav-link" data-scroll-target="#footnotes"><span class="header-section-number">C.7.1</span> Footnotes</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Essential-and-useful-other-programs-under-a-Unix-alike.html">Appendices</a></li><li class="breadcrumb-item"><a href="./Platform-notes.html"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Platform notes</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Appendix C — Platform notes</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Next: <a href="Function-and-variable-index.html" accesskey="n" rel="next">Function and variable index</a>, Previous: <a href="Configuration-on-a-Unix-alike.html#configuration-on-a-unix-alike" accesskey="p" rel="prev">Configuration on a Unix-alike</a>, Up: <a href="index.html" accesskey="u" rel="up">R Installation and Administration</a> &nbsp; [<a href="index.html#sec_contents" rel="contents" title="Table of contents">Contents</a>][<a href="Function-and-variable-index.html" rel="index" title="Index">Index</a>]</p>
<p>This section provides some notes on building R on different Unix-alike platforms. These notes are based on tests run on one or two systems in each case with particular sets of compilers and support libraries. Success in building R depends on the proper installation and functioning of support software; your results may differ if you have other versions of compilers and support libraries.</p>
<p>Older versions of this manual contain notes on platforms such as HP-UX, IRIX, Alpha/OSF1 (for R &lt; 2.10.0, and support has since been removed for all of these) and AIX (for R &lt; = 3.5.x) for which we have had no recent reports.</p>
<p>C macros to select particular platforms can be tricky to track down (there is a fair amount of misinformation on the Web). The Wiki (currently) at <a href="https://sourceforge.net/p/predef/wiki/Home/" class="uref">https://sourceforge.net/p/predef/wiki/Home/</a> can be helpful. The R sources have used (often in included software under <samp class="file">src/extra</samp>)</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>AIX<span class="sc">:</span> _AIX</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>Cygwin<span class="sc">:</span> __CYGWIN__</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>FreeBSD<span class="sc">:</span> __FreeBSD__</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>HP<span class="sc">-</span>UX<span class="sc">:</span> __hpux__, __hpux</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>IRIX<span class="sc">:</span> sgi, __sgi</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>Linux<span class="sc">:</span> __linux__</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>macOS<span class="sc">:</span> __APPLE__</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>NetBSD<span class="sc">:</span> __NetBSD__</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>OpenBSD<span class="sc">:</span> __OpenBSD__</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>Windows<span class="sc">:</span> _WIN32, _WIN64</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>Windows on <span class="dv">64</span><span class="sc">-</span>but ARM<span class="sc">:</span> _M_ARM64 or _WIN32 plus __aarch64__</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Identifying compilers can be very tricky. GCC defines <code class="code">__GNUC__</code>, but so do other compilers claiming conformance with it, notably (LLVM and Apple) <code class="command">clang</code> and Intel compilers. Further, some use the value of <code class="code">__GNUC__</code> for their version, not the version of GCC they claim to be compatible with.<a href="#FOOT76" id="DOCF76" class="footnote"><sup>76</sup></a> <code class="command">clang</code>-based compilers define <code class="code">__clang__</code>. Both LLVM and Apple <code class="command">clang</code> define <code class="code">__clang_major__</code> as a string giving their major version, but for example Apple’s 13.x.y is very different from LLVM’s 13.x.y. And compilers based on LLVM <code class="command">clang</code>, for example from Intel and IBM, will define these. Some of the included software uses <code class="code">__APPLE_CC__</code> to identify an Apple compiler (which used to include Apple builds of GCC), but Apple <code class="command">clang</code> is better identified by the <code class="code">__apple_build_version__</code> macro.</p>
<section id="x11-issues" class="level2 section" data-number="C.1">
<h2 class="section anchored" data-number="C.1" data-anchor-id="x11-issues"><span class="header-section-number">C.1</span> X11 issues</h2>
<p>The <samp class="samp">X11()</samp>’ graphics device is the one started automatically on Unix-alikes (except most macOS builds) when plotting. As its name implies, it displays on a (local or remote) X server, and relies on the services provided by the X server.</p>
<p>The ‘modern’ version of the <samp class="samp">X11()</samp>’ device is based on <samp class="samp">cairo</samp>’ graphics and (in most implementations) uses <samp class="samp">fontconfig</samp>’ to pick and render fonts. This is done on the server, and although there can be selection issues, they are more amenable than the issues with <samp class="samp">X11()</samp>’ discussed in the rest of this section.</p>
<p>When X11 was designed, most displays were around 75dpi, whereas today they are of the order of 100dpi or more. If you find that X11() is reporting<a href="#FOOT77" id="DOCF77" class="footnote"><sup>77</sup></a> missing font sizes, especially larger ones, it is likely that you are not using scalable fonts and have not installed the 100dpi versions of the X11 fonts. The names and details differ by system, but will likely have something like Fedora’s</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>xorg<span class="sc">-</span>x11<span class="sc">-</span>fonts<span class="dv">-75</span>dpi</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>xorg<span class="sc">-</span>x11<span class="sc">-</span>fonts<span class="dv">-100</span>dpi</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>xorg<span class="sc">-</span>x11<span class="sc">-</span>fonts<span class="sc">-</span>ISO8859<span class="dv">-2-75</span>dpi</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>xorg<span class="sc">-</span>x11<span class="sc">-</span>fonts<span class="sc">-</span>Type1</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>xorg<span class="sc">-</span>x11<span class="sc">-</span>fonts<span class="sc">-</span>cyrillic</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and you need to ensure that the <samp class="samp">-100dpi</samp>’ versions are installed and on the X11 font path (check via <code class="command">xset -q</code>). The <samp class="samp">X11()</samp>’ device does try to set a pointsize and not a pixel size: laptop users may find the default setting of 12 too large (although very frequently laptop screens are set to a fictitious dpi to appear like a scaled-down desktop screen).</p>
<p>More complicated problems can occur in non-Western-European locales, so if you are using one, the first thing to check is that things work in the <code class="code">C</code> locale. The likely issues are a failure to find any fonts or glyphs being rendered incorrectly (often as a pair of ASCII characters). X11 works by being asked for a font specification and coming up with its idea of a close match. For text (as distinct from the symbols used by plotmath), the specification is the first element of the option <code class="code">"X11fonts"</code> which defaults to</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="st">"-adobe-helvetica-%s-%s-*-*-%d-*-*-*-*-*-*-*"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If you are using a single-byte encoding, for example ISO 8859-2 in Eastern Europe or KOI8-R in Russian, use <code class="command">xlsfonts</code> to find an appropriate family of fonts in your encoding (the last field in the listing). If you find none, it is likely that you need to install further font packages, such as <samp class="samp">xorg-x11-fonts-ISO8859-2-75dpi</samp>’ and <samp class="samp">xorg-x11-fonts-cyrillic</samp>’ shown in the listing above.</p>
<p>Multi-byte encodings (most commonly UTF-8) are even more complicated. There are few fonts in <samp class="samp">iso10646-1</samp>‘, the Unicode encoding, and they only contain a subset of the available glyphs (and are often fixed-width designed for use in terminals). In such locales <em>fontsets</em> are used, made up of fonts encoded in other encodings. If the locale you are using has an entry in the <samp class="samp">XLC_LOCALE</samp>’ directory (typically <samp class="file">/usr/share/X11/locale</samp>), it is likely that all you need to do is to pick a suitable font specification that has fonts in the encodings specified there. If not, you may have to get hold of a suitable locale entry for X11. This may mean that, for example, Japanese text can be displayed when running in <samp class="samp">ja_JP.UTF-8</samp>’ but not when running in <samp class="samp">en_GB.UTF-8</samp>’ on the same machine (although on some systems many UTF-8 X11 locales are aliased to <samp class="samp">en_US.UTF-8</samp>’ which covers several character sets, e.g.&nbsp;ISO 8859-1 (Western European), JISX0208 (Kanji), KSC5601 (Korean), GB2312 (Chinese Han) and JISX0201 (Kana)).</p>
<p>On some systems scalable fonts are available covering a wide range of glyphs. One source is TrueType/OpenType fonts, and these can provide high coverage. Another is Type 1 fonts: the URW set of Type 1 fonts provides standard typefaces such as Helvetica with a larger coverage of Unicode glyphs than the standard X11 bitmaps, including Cyrillic. These are generally not part of the default install, and the X server may need to be configured to use them. They might be under the X11 <samp class="file">fonts</samp> directory or elsewhere, for example,</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="sc">/</span>usr<span class="sc">/</span>share<span class="sc">/</span>fonts<span class="sc">/</span>default<span class="sc">/</span>Type1</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="sc">/</span>usr<span class="sc">/</span>share<span class="sc">/</span>fonts<span class="sc">/</span>ja<span class="sc">/</span>TrueType</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="linux" class="level2 section" data-number="C.2">
<h2 class="section anchored" data-number="C.2" data-anchor-id="linux"><span class="header-section-number">C.2</span> Linux</h2>
<p>Linux is the main development platform for R, so compilation from the sources is normally straightforward with the most common compilers and libraries.<a href="#FOOT78" id="DOCF78" class="footnote"><sup>78</sup></a></p>
<p>This section is about the GCC compilers: <code class="command">gcc</code>/<code class="command">gfortran</code>/<code class="command">g++</code>.</p>
<p>Recall that some package management systems (such as RPM and deb) make a distinction between the user version of a package and the developer version. The latter usually has the same name but with the extension <samp class="samp">-devel</samp>’ or <samp class="samp">-dev</samp>‘: you need both versions installed. So please check the <code class="code">configure</code> output to see if the expected features are detected: if for example <samp class="samp">readline</samp>’ is missing add the developer package. (On most systems you will also need <samp class="samp">ncurses</samp>’ and its developer package, although these should be dependencies of the <samp class="samp">readline</samp>’ package(s).) You should expect to see in the <code class="command">configure</code> summary</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>  Interfaces supported<span class="sc">:</span>      X11, tcltk</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  External libraries<span class="sc">:</span>        pcre2, readline, curl</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  Additional capabilities<span class="sc">:</span>   PNG, JPEG, TIFF, NLS, cairo, ICU</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>When R has been installed from a binary distribution there are sometimes problems with missing components such as the Fortran compiler. Searching the <samp class="samp">R-help</samp>’ archives will normally reveal what is needed.</p>
<p>It seems that <samp class="samp">ix86</samp>’ Linux accepts non-PIC code in shared libraries, but this is not necessarily so on other platforms, in particular on 64-bit CPUs such as <samp class="samp">x86_64</samp>’. So care can be needed with BLAS libraries and when building R as a shared library to ensure that position-independent code is used in any static libraries (such as the Tcl/Tk libraries, <code class="code">libpng</code>, <code class="code">libjpeg</code> and <code class="code">zlib</code>) which might be linked against. Fortunately these are normally built as shared libraries with the exception of the ATLAS BLAS libraries.</p>
<p>The default optimization settings chosen for <code class="code">CFLAGS</code> etc are conservative. It is likely that using <samp class="option">-mtune</samp> will result in significant performance improvements on recent CPUs: one possibility is to add <samp class="option">-mtune=native</samp> for the best possible performance on the machine on which R is being installed. It is also possible to increase the optimization levels to <samp class="option">-O3</samp>: however for many versions of the compilers this has caused problems in at least one CRAN package.</p>
<p>Do not use <samp class="option">-O3</samp> with <code class="command">gcc</code> 11.0 or 11.1: it mis-compiles code resulting in plausible but incorrect results. (This was seen in package <a href="https://CRAN.R-project.org/package=MASS" class="url"><strong>MASS</strong></a> but has been worked around there as from version 3.1-57.)</p>
<p>For comments on <samp class="samp">ix86</samp>’ builds (including 32-bit builds on <samp class="samp">x86_64</samp>’) see the version of this manual for R 4.3.x.</p>
<p>To build a 64-bit version of R on <samp class="samp">ppc64</samp>’ (also known as <samp class="samp">powerpc64</samp>’) with <code class="command">gcc</code>&nbsp;4.1.1, Ei-ji Nakama used</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode makefile code-with-copy"><code class="sourceCode makefile"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="dt">CC</span><span class="ch">=</span><span class="st">"gcc -m64"</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="dt">CXX</span><span class="ch">=</span><span class="st">"gxx -m64"</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="dt">FC</span><span class="ch">=</span><span class="st">"gfortran -m64"</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="dt">CFLAGS</span><span class="ch">=</span><span class="st">"-mminimal-toc -fno-optimize-sibling-calls -g -O2"</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="dt">FFLAGS</span><span class="ch">=</span><span class="st">"-mminimal-toc -fno-optimize-sibling-calls -g -O2"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>the additional flags being needed to resolve problems linking against <samp class="file">libnmath.a</samp> and when linking R as a shared library.</p>
<p>The setting of the macro <samp class="samp">SAFE_FFLAGS</samp>’ may need some help. It should not need additional flags on platforms other than <samp class="samp">68000</samp>’ (not likely to be encountered) and <samp class="samp">ix86</samp>’. For the latter, if the Fortran compiler is GNU (<code class="command">gfortran</code> or possibly <code class="command">g77</code>) the flags</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span>msse2 <span class="sc">-</span>mfpmath<span class="ot">=</span>sse</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>are added: earlier versions of R added <samp class="option">-ffloat-store</samp> and this might still be needed if a <samp class="samp">ix86</samp>’ CPU is encountered without SSE2 support. Note that it is a <em>replacement</em> for <samp class="samp">FFLAGS</samp>’, so should include all the flags in that macro (except perhaps the optimization level).</p>
<p>Additional compilation flags can be specified for added safety/security checks. For example Fedora adds</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode makefile code-with-copy"><code class="sourceCode makefile"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="dt">-Werror</span><span class="ch">=</span><span class="st">format-security -Wp,-D_FORTIFY_SOURCE=3 -Wp,-D_GLIBCXX_ASSERTIONS</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="ch">-</span><span class="fu">Fexceptions -fstack-protector-strong -fasynchronous-unwind-tables</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="ch">-</span><span class="fu">fstack-clash-protection -fcf-protection</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>to all the C, C++ and Fortran compiler flags (even though <code class="code">_GLIBCXX_ASSERTIONS</code> is only for C++ in current GCC and <code class="code">glibc</code> and none of these are documented for <code class="code">gfortran</code>). Use of <code class="code">_GLIBCXX_ASSERTIONS</code> will link <code class="code">abort</code> and <code class="code">printf</code> into almost all C++ code, and <code class="command">R CMD check --as-cran</code> will warn.</p>
<section id="clang" class="level3 subsection" data-number="C.2.1">
<h3 class="subsection anchored" data-number="C.2.1" data-anchor-id="clang"><span class="header-section-number">C.2.1</span> Clang</h3>
<p>R has been built with Linux <samp class="samp">ix86</samp>’ and <samp class="samp">x86_64</samp>’ C and C++ compilers (<a href="https://clang.llvm.org" class="uref">https://clang.llvm.org</a>) based on the Clang front-ends, invoked by <code class="code">CC=clang CXX=clang++</code>, together with <code class="command">gfortran</code>. These take very similar options to the corresponding GCC compilers.</p>
<p>This has to be used in conjunction with a Fortran compiler: the <code class="command">configure</code> code will remove <samp class="option">-lgcc</samp> from <code class="env">FLIBS</code>, which is needed for some versions of <code class="command">gfortran</code>.</p>
<p>The current out-of-the-box default for <code class="command">clang++</code> is to use the C++ runtime from the installed <code class="command">g++</code>. Using the runtime from the <a href="https://libcxx.llvm.org/" class="url"><code class="code">libc++</code></a> project (Fedora RPM <code class="code">libcxx-devel</code>) <em>via</em> <samp class="option">-stdlib=libc++</samp> has also been tested.</p>
<p>Recent versions have (optional when built) OpenMP support.<a href="#FOOT79" id="DOCF79" class="footnote"><sup>79</sup></a></p>
<p>There are problems mixing <code class="command">clang</code> 15.0.0 and later built as default on Linux to produce PIE code and <code class="command">gfortran</code> 11 or later, which does not. One symptom is that <code class="command">configure</code> does not detect <code class="code">FC_LEN_T</code>, which can be overcome by setting</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>FPIEFLAGS<span class="ot">=</span><span class="sc">-</span>fPIE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>in <samp class="file">config.site</samp>. (<code class="command">configure</code> tries that value if it is unset.)</p>
</section>
<section id="flang" class="level3 subsection" data-number="C.2.2">
<h3 class="subsection anchored" data-number="C.2.2" data-anchor-id="flang"><span class="header-section-number">C.2.2</span> flang</h3>
<p>The name <code class="command">flang</code> has been used for two projects: this is about the sub-project of LLVM which builds a Fortran compiler and runtime libraries. The compiler command was <code class="command">flang-new</code> prior to version 20.</p>
<p>The version in LLVM 16 and later was able to build R on <samp class="samp">x86_64</samp>’ Linux with</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>FC<span class="ot">=</span><span class="er">/</span>path<span class="sc">/</span>to<span class="sc">/</span>flang</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>with the matching <code class="command">clang</code> used as the C compiler, and the build passed <code class="command">make check-all</code>. There is also support for <samp class="samp">aarch64</samp>’ and <samp class="samp">ppc64le</samp>’ Linux, but these have not been tested with R.</p>
</section>
<section id="intel-compilers" class="level3 subsection" data-number="C.2.3">
<h3 class="subsection anchored" data-number="C.2.3" data-anchor-id="intel-compilers"><span class="header-section-number">C.2.3</span> Intel compilers</h3>
<p>In late 2020 Intel revamped their C/C++ compilers (and later their Fortran compiler) to use an LLVM back-end (and for the C/C++ compilers, a modified version of <code class="command">clang</code> as the front-end). Those compilers are only for <samp class="samp">x86_64</samp>‘: the earlier (now called ’Classic’) C/C++ compilers were discontinued in late 2023 (and are covered in the version of this manual for R 4.3.x: the Fortran compiler <code class="command">ifort</code> remains part of the Fortran distribution)..</p>
<p>The compilers are now all under Intel’s ‘oneAPI’ brand. The revamped ones are <code class="command">icx</code>, <code class="command">icpx</code> and <code class="command">ifx</code>; they are identified by the C/C++ macro <code class="code">__INTEL_LLVM_COMPILER</code> (and do not define <code class="code">__INTEL_COMPILER</code>: they also define <code class="code">__clang__</code> and <code class="code">__clang_major__</code>).</p>
<p>The C++ compiler uses the system’s <code class="code">libstdc++</code> as its runtime library rather than LLVM’s <code class="code">libc++</code>.</p>
<p>Standalone installers (which are free-of-charge) are available from <a href="https://www.intel.com/content/www/us/en/developer/articles/tool/oneapi-standalone-components.html" class="uref">https://www.intel.com/content/www/us/en/developer/articles/tool/oneapi-standalone-components.html</a>: they are also part of the oneAPI Base and HPC (for Fortran) toolkits.</p>
<p>We tried the compilers in oneAPI 2025.1.0, 2024.2.1 and 2023.x.y using (the paths do differ by compiler version)</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode makefile code-with-copy"><code class="sourceCode makefile"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="dt">IP</span><span class="ch">=</span><span class="st">/path/to/compilers/bin/</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="dt">CC</span><span class="ch">=$I</span><span class="st">P/icx</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="dt">CXX</span><span class="ch">=$I</span><span class="st">P/icpx</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="dt">FC</span><span class="ch">=$I</span><span class="st">P/ifx</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="dt">CFLAGS</span><span class="ch">=</span><span class="st">"-O3 -fp-model precise -Wall -Wstrict-prototypes"</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="dt">C17FLAGS</span><span class="ch">=</span><span class="st">"-O3 -fp-model precise -Wall -Wno-strict-prototypes"</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="dt">FFLAGS</span><span class="ch">=</span><span class="st">"-O3 -fp-model precise -warn all,noexternals"</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="dt">FCFLAGS</span><span class="ch">=</span><span class="st">"-free -O3 -fp-model precise -warn all,noexternals"</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="dt">CXXFLAGS</span><span class="ch">=</span><span class="st">"-O3 -fp-model precise -Wall"</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="dt">LDFLAGS</span><span class="ch">=</span><span class="st">"-L/path/to/compilers/compiler/lib -L/usr/local/lib64"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>but the build segfaulted in the checks (in complex arithmetic in <samp class="file">tests/lapack.R</samp>).</p>
<p>Intel document building R with MKL: for the Intel compilers this needed something like</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>MKL_LIB_PATH<span class="op">=/</span>path<span class="op">/</span>to<span class="op">/</span>intel_mkl<span class="op">/</span>mkl<span class="op">/</span>lib<span class="op">/</span>intel64</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>export LD_LIBRARY_PATH<span class="op">=</span><span class="st">"$MKL_LIB_PATH"</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>MKL<span class="op">=</span><span class="st">"-L${MKL_LIB_PATH} -lmkl_intel_lp64 -lmkl_core -lmkl_sequential"</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="op">./</span>configure <span class="op">--</span>with<span class="op">-</span>blas<span class="op">=</span><span class="st">"$MKL"</span> <span class="op">--</span>with<span class="op">-</span>lapack</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and the build passed its checks with MKL 2023.2.0 (but not 2024.x on the hardware tested). It may also be possible to use a compiler option like <samp class="option">-qmkl=sequential</samp>.</p>
<p>One quirk is that the Intel Fortran compilers do not accept <samp class="file">.f95</samp> files, only <samp class="file">.f90</samp>, for free-format Fortran. <code class="command">configure</code> adds <samp class="option">-Tf</samp> which tells the compiler this is indeed a Fortran file (and needs to immediately precede the file name), but <samp class="option">-free</samp> is needed to say it is free-format. Hence setting the <code class="code">FCFLAGS</code> macro.</p>
<p>The compilers have many options: as the C/C++ and Fortran compilers have different origins for their front-ends, there is little consistency in their options. (The C/C++ compilers support ‘all’ <code class="command">clang</code> options even if undocumented for <code class="command">icx</code>/<code class="command">icpc</code>, such as <samp class="option">-Wno-strict-prototypes</samp> above, However it is unclear for which version of <code class="command">clang</code>: the Intel manual suggests checking <code class="command">icx -help</code>.) The C/C++ compilers support clang-style LTO: it is not clear if the Fortran one does.</p>
<p>The preferred Fortran standard for <code class="command">ifx</code> can be set by one of <samp class="option">-std90</samp>, <samp class="option">-std95</samp>, <samp class="option">-std03</samp>, <samp class="option">-std08</samp> or <samp class="option">-std18</samp> (and variants). However, this is documented to only affect warnings on non-standard features: the default is no such warnings.</p>
<p>Warning to package maintainers: the Intel Fortran compiler interprets comments intended for Visual Fortran<a href="#FOOT80" id="DOCF80" class="footnote"><sup>80</sup></a> like</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="sc">!</span>DEC<span class="sc">$</span> ATTRIBUTES DLLEXPORT,C,REFERENCE,ALIAS<span class="sc">:</span><span class="st">'kdenestmlcvb'</span> <span class="sc">::</span> kdenestmlcvb</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The <code class="code">DLLEXPORT</code> gives a warning but the remainder silently generates incorrectly named entry points. Such comment lines need to be removed from code for use with R (even if using Intel Fortran on Windows).</p>
</section>
</section>
<section id="macos" class="level2 section" data-number="C.3">
<h2 class="section anchored" data-number="C.3" data-anchor-id="macos"><span class="header-section-number">C.3</span> macOS</h2>
<p>The instructions here are for ‘Apple Silicon’ (<samp class="samp">arm64</samp>‘) or Intel 64-bit (<samp class="samp">x86_64</samp>’) builds on macOS 11 (Big Sur), 12 (Monterey), 13 (Ventura), 14 (Sonoma) and likely later. (They may well work on Intel macOS 10.14 or 10.15, but are untested there.)</p>
<section id="prerequisites" class="level3 subsection" data-number="C.3.1">
<h3 class="subsection anchored" data-number="C.3.1" data-anchor-id="prerequisites"><span class="header-section-number">C.3.1</span> Prerequisites</h3>
<p>The Apple silicon components install into <samp class="file">/opt/R/arm64</samp>, the Intel ones into <samp class="file">/opt/R/x86_64</samp>. That may not exist<a href="#FOOT81" id="DOCF81" class="footnote"><sup>81</sup></a> so it is simplest to first create the directory and adjust its ownership if desired: for example by</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> mkdir <span class="at">-p</span> /opt/R/arm64</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> chown <span class="at">-R</span> <span class="va">$USER</span> /opt/R</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Also, add <samp class="file">/opt/R/arm64/bin</samp> or <samp class="file">/opt/R/x86_64/bin</samp> to your path.</p>
<p>Define an appropriate variable in your Terminal:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>set LOCAL<span class="ot">=</span><span class="er">/</span>opt<span class="sc">/</span>R<span class="sc">/</span>arm64  <span class="co"># Apple Silicon</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>set LOCAL<span class="ot">=</span><span class="er">/</span>opt<span class="sc">/</span>R<span class="sc">/</span>x86_64 <span class="co"># Intel</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>to use the code snippets here.</p>
<p>The following are essential to build R:</p>
<ul>
<li><p>Apple’s ‘Command Line Tools’: these can be (re-)installed by running <code class="command">xcode-select --install</code> in a terminal.</p>
<p>If you have a fresh OS installation, running e.g.&nbsp;<code class="command">make</code> in a terminal will offer the installation of the command-line tools. If you have installed Xcode, this provides the command-line tools. The tools may need to be reinstalled when macOS is upgraded, as upgrading may partially or completely remove them.</p>
<p>The Command Line Tools provide C and C++ compilers derived from LLVM’s <code class="command">clang</code> but nowadays known as ‘Apple clang’ with different versioning (so Apple clang 15 is unrelated to LLVM clang 15).</p></li>
<li><p>A Fortran compiler. See <a href="#fortran-compilers" class="xref">Fortran compiler</a>.</p></li>
<li><p>Binary components <code class="code">pcre2</code><a href="#FOOT82" id="DOCF82" class="footnote"><sup>82</sup></a> and <code class="code">xz</code> (for <code class="code">liblzma</code>) from <a href="https://mac.r-project.org/bin/" class="uref">https://mac.r-project.org/bin/</a>. There is an R script there to help with installing all the needed components. (At the time of writing <code class="code">install.libs("r-base-dev")</code> installed neither <code class="code">readline5</code> nor those needed to support Pango.)</p>
<p>Intel users want the <code class="code">darwin20</code> components: the <code class="code">darwin17</code> ones are for macOS 10.13–10.15.</p>
<p>Or this can be done manually, by for example</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-OL</span> https://mac.r-project.org/bin/darwin20/arm64/pcre2-10.44-darwin.20-arm64.tar.xz</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tar <span class="at">-xvzf</span> pcre2-10.44-darwin.20-arm64.tar.gz <span class="at">-C</span> /</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-OL</span> https://mac.r-project.org/bin/darwin20/arm64/xz-5.6.3-darwin.20-arm64.tar.xz</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tar <span class="at">-xvzf</span> xz-5.6.3-darwin.20-arm64.tar.xz <span class="at">-C</span> /</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>(<code class="command">sudo</code> is not needed if your account owns <samp class="file">/opt/R/arm64</samp> or <samp class="file">/opt/R/x86_64</samp> as appropriate.)</p>
<p>Messages like <samp class="samp">opt/R/: Can't restore time</samp>’ should be ignored.</p></li>
</ul>
<p>and desirable</p>
<ul>
<li><p>Component <code class="code">readline5</code>.<a href="#FOOT83" id="DOCF83" class="footnote"><sup>83</sup></a> If <code class="code">readline</code> is not present, the emulation in Apple’s version of <code class="code">libedit</code> (aka <code class="code">editline</code>) will be used: if you wish to avoid that, configure with <samp class="option">--without-readline</samp>.</p></li>
<li><p>Components <code class="code">jpeg</code>, <code class="code">libpng</code>, <code class="code">pkgconfig</code>, <code class="code">tiff</code> and <code class="code">zlib-system-stub</code> from <a href="https://mac.r-project.org/bin//" class="uref">https://mac.r-project.org/bin//</a> for the full range of bitmapped graphics devices. (Some builds of <code class="code">tiff</code> may require <code class="code">libwebp</code> and/or <code class="code">openjpeg</code>.)</p></li>
<li><p>Component <code class="code">libdeflate</code> for faster internal (de)compression and <code class="code">zstd</code> for support for that type of compression.</p></li>
<li><p>Component <code class="code">gettext</code> for <code class="code">libintl</code>.</p></li>
<li><p>An X sub-system unless configuring using <samp class="option">--without-x</samp>: see <a href="https://www.xquartz.org/" class="uref">https://www.xquartz.org/</a>. R’s <code class="command">configure</code> script can be told to look for <code class="code">X11</code> in XQuartz’s main location of <samp class="file">/opt/X11</samp>, e.g.&nbsp;by</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="sc">--</span>x<span class="sc">-</span>includes<span class="ot">=</span><span class="er">/</span>opt<span class="sc">/</span>X11<span class="sc">/</span>include <span class="sc">--</span>x<span class="sc">-</span>libraries<span class="ot">=</span><span class="er">/</span>opt<span class="sc">/</span>X11<span class="sc">/</span>lib</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Be wary of pre-release versions of XQuartz, which may be offered as an update.</p></li>
<li><p>An Objective-C compiler, as provided by <code class="command">clang</code> in the Command Line Tools: this is needed for the <code class="code">quartz()</code> graphics device.</p>
<p>Use <samp class="option">--without-aqua</samp> if you want a standard Unix-alike build: apart from disabling <code class="code">quartz()</code> and the ability to use the build with <span class="small">R.APP</span>, it also changes the default location of the personal library (see <code class="code">?.libPaths</code>).</p></li>
<li><p>A Tcl/Tk installation, See <a href="#tcl_002ftk-headers-and-libraries" class="xref">Tcl/Tk headers and libraries</a>.</p></li>
<li><p>Support for Cairo-based graphics devices. See <a href="#cairo-graphics" class="xref">Cairo graphics</a>.</p></li>
<li><p>A TeX installation. See <a href="#other-libraries" class="xref">Other libraries</a>.</p></li>
<li><p><code class="command">texi2any</code> from a Texinfo distribution, which requires <code class="command">perl</code> (currently a default part of macOS but it has been announced that it may not be in future). A version of <code class="command">texi2any</code> has been included in the binary distribution of R and there is a <samp class="samp">texinfo</samp>’ component at <a href="https://mac.r-project.org/bin/" class="uref">https://mac.r-project.org/bin/</a>.</p></li>
</ul>
<p>To build R itself from the sources with the C/C++ compilers in the Command Line Tools (or Xcode) and <code class="command">gfortran</code> from the installer mentioned below, use a file <samp class="file">config.site</samp> containing</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode makefile code-with-copy"><code class="sourceCode makefile"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="dt">CC</span><span class="ch">=</span><span class="st">clang</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="dt">OBJC</span><span class="ch">=$C</span><span class="st">C</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="dt">FC</span><span class="ch">=</span><span class="st">"/opt/gfortran/bin/gfortran -mtune=native"</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="dt">CPPFLAGS</span><span class="ch">=</span><span class="st">'-isystem </span><span class="ch">$L</span><span class="st">OCAL/include'</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="dt">CXX</span><span class="ch">=</span><span class="st">clang++</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and configure by something like</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="op">./</span>configure <span class="op">-</span>C \</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="op">--</span>enable<span class="op">-</span>R<span class="op">-</span>shlib <span class="op">--</span>enable<span class="op">-</span>memory<span class="op">-</span>profiling \</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="op">--</span>x<span class="op">-</span>includes<span class="op">=/</span>opt<span class="op">/</span>X11<span class="op">/</span>include <span class="op">--</span>x<span class="op">-</span>libraries<span class="op">=/</span>opt<span class="op">/</span>X11<span class="op">/</span>lib \</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="op">--</span>with<span class="op">-</span>tcl<span class="op">-</span>config<span class="op">=</span>$LOCAL<span class="op">/</span>lib<span class="op">/</span>tclConfig<span class="op">.</span>sh \</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="op">--</span>with<span class="op">-</span>tk<span class="op">-</span>config<span class="op">=</span>$LOCAL<span class="op">/</span>lib<span class="op">/</span>tkConfig<span class="op">.</span>sh \</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>PKG_CONFIG_PATH<span class="op">=</span>$LOCAL<span class="op">/</span>lib<span class="op">/</span>pkgconfig<span class="op">:/</span>usr<span class="op">/</span>lib<span class="op">/</span>pkgconfig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>(See below for other options for Tcl/Tk.) For an <samp class="samp">arm64</samp>’ build further flags are desirable in <samp class="file">config.site</samp>:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>CFLAGS<span class="ot">=</span><span class="st">"-falign-functions=8 -g -O2"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>is needed to inter-work with <code class="command">gfortran</code> without segfaulting in some packages. Some builds of <code class="command">gfortran</code> have targetted the current version of macOS (unlike <code class="command">clang</code>), causing linker warnings: to avoid these use</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>FFLAGS<span class="ot">=</span><span class="st">"-g -O2 -mmacosx-version-min=11.0"</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>FCFLAGS<span class="ot">=</span><span class="st">"-g -O2 -mmacosx-version-min=11.0"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>or perhaps</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>FFLAGS<span class="ot">=</span><span class="st">"-g -O2 -mmacos-version-min=11.0"</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>FCFLAGS<span class="ot">=</span><span class="st">"-g -O2 -mmacos-version-min=11.0"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>where <code class="code">11.0</code> can be replaced by <code class="code">12.0</code>, <code class="code">13.0</code>, <code class="code">14.0</code> or <code class="code">15.0</code></p>
<p>To install packages using compiled code one needs the Command Line Tools (or Xcode) and appropriate compilers, e.g.&nbsp;the C/C++ compilers from those tools and/or <code class="command">gfortran</code>. Some packages have further requirements such as component <code class="command">pkgconfig</code> (and to set <code class="env">PKG_CONFIG_PATH=</code> as above).</p>
<p>A subversion client can be obtained from <a href="https://mac.r-project.org/tools/" class="uref">https://mac.r-project.org/tools/</a>, for example by (Apple Silicon)</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-OL</span> https://mac.r-project.org/tools/subversion-1.14.3-darwin.20-arm64.tar.gz</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tar</span> xf subversion-1.14.3-darwin.20-arm64.tar.gz </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> cp subversion-1.14.3-darwin-20-arm64/svn <span class="va">$LOCAL</span>/bin</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>or (Intel)</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-OL</span> https://mac.r-project.org/tools/subversion-1.14.3-darwin15.6.tar.gz</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tar</span> xf subversion-1.14.3-darwin15.6.tar.gz</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> cp subversion-1.14.3-darwin15.6/svn <span class="va">$LOCAL</span>/bin</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If building software or installing source packages with <code class="command">cmake</code> (or a non-Apple <code class="command">make</code>) for ‘Apple Silicon’ ensure it contains the <samp class="samp">arm64</samp>’ architecture (use <code class="command">file</code> to be sure). Running Apple compilers from an <samp class="samp">x86_64</samp>’ executable will generate <samp class="samp">x86_64</samp>’ code ….</p>
<p>Updating an <samp class="samp">arm64</samp>’ build may fail because of the bug described at <a href="https://openradar.appspot.com/FB8914243" class="uref">https://openradar.appspot.com/FB8914243</a> but <em>ab initio</em> builds work. This has been far rarer since macOS 13.</p>
<p>If you are using the macOS 13 SDK<a href="#FOOT84" id="DOCF84" class="footnote"><sup>84</sup></a>, you may need to add something like <code class="code">-mmacos-version-min=12.0</code> to <samp class="samp">CFLAGS</samp>’.</p>
<p>Linker warnings like</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>ld<span class="sc">:</span> warning<span class="sc">:</span> could not create compact unwind <span class="cf">for</span> _sort_<span class="sc">:</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>   register <span class="dv">26</span> saved somewhere other than <span class="cf">in</span> frame</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>ld<span class="sc">:</span> warning<span class="sc">:</span> ld<span class="sc">:</span> warning<span class="sc">:</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>   could not create compact unwind <span class="cf">for</span> _arcoef_<span class="sc">:</span> registers <span class="dv">23</span> and <span class="dv">24</span> not saved contiguously <span class="cf">in</span> frame</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>ld<span class="sc">:</span> warning<span class="sc">:</span> could not create compact unwind <span class="cf">for</span> ___emutls_get_address<span class="sc">:</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>   registers <span class="dv">23</span> and <span class="dv">24</span> not saved contiguously <span class="cf">in</span> frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>can be ignored. These stem from compiled Fortran code, including its run-time libraries.</p>
<p>The default security settings can make it difficult to install Apple packages which have not been ‘notarized’<a href="#FOOT85" id="DOCF85" class="footnote"><sup>85</sup></a> by Apple. And not just packages, as this has been seen for executables contained in tarballs/zipfiles (for example, for <code class="command">pandoc</code>). Usually one can use <samp class="samp">Open With</samp>’ (Control/right/two-finger-click in Finder), then select <samp class="samp">Installer</samp>’ and <samp class="samp">Open</samp>’ if you get a further warning message.</p>
<p>If you run into problems with ‘quarantine’ for tarballs downloaded in a browser, consider using <code class="command">curl -OL</code> to download (as illustrated above) or <code class="command">xattr -c</code> to remove extended attributes.</p>
<p><code class="command">configure</code> defaults to <samp class="option">--with-internal-tzcode</samp> on macOS. The native implementation used to be unusable on earlier versions (with a 32-bit <code class="code">time_t</code> and/or timezone tables missing information beyond the 32-bit range). As from macOS 12.6, option <samp class="option">--without-internal-tzcode</samp> can be used to override this and R contains sufficient workarounds (for example, the native code fails to recognize dates with a negative <code class="code">tm_year</code>, that is dates before 1900) for R to pass its checks. However, there are discrepancies, notably in Europe in the 1900s and 1940s, even though the Olson database contains the correct information.</p>
</section>
<section id="fortran-compiler" class="level3 subsection" data-number="C.3.2">
<h3 class="subsection anchored" data-number="C.3.2" data-anchor-id="fortran-compiler"><span class="header-section-number">C.3.2</span> Fortran compiler</h3>
<p>There is a ‘universal’ (<code class="code">arm64</code> and Intel) build of <code class="command">gfortran</code> 14.2 at <a href="https://mac.r-project.org/tools/gfortran-14.2-universal.pkg" class="uref">https://mac.r-project.org/tools/gfortran-14.2-universal.pkg</a>/ This installs into <samp class="file">/opt/gfortran</samp>.</p>
<p>The <samp class="file">/opt/gfortran/SDK</samp> symlink should point to the desired path to the SDK (defaults to the command line tools SDK). This can be updated by running <samp class="file">/opt/gfortran/bin/gfortran-update-sdk</samp> or manually. If the symlink is broken, the driver will issue a warning and use <code class="code">xcrun -show-sdk-path</code> to try to find an SDK and use its path. (The SDK path is used when using <code class="command">gfortran</code> to link, so not when building R but when installing a few packages.)</p>
<p>Other builds of <code class="command">gfortran</code> for <code class="code">arm64</code> macOS 14 are available at <a href="https://github.com/fxcoudert/gfortran-for-macOS/releases" class="uref">https://github.com/fxcoudert/gfortran-for-macOS/releases</a>. To use one of the pre-built compilers with Apple <code class="command">clang</code> needs something like</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>LDFLAGS<span class="ot">=</span><span class="st">"-L/opt/R/arm64/lib -rpath /usr/local/gfortran/lib"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>in <samp class="file">config.site</samp> to ensure the matching Fortran run-time libraries are found.</p>
</section>
<section id="cairo-graphics" class="level3 subsection" data-number="C.3.3">
<h3 class="subsection anchored" data-number="C.3.3" data-anchor-id="cairo-graphics"><span class="header-section-number">C.3.3</span> Cairo graphics</h3>
<p>Cairo-based graphics devices such as <code class="code">cairo_ps</code>, <code class="code">cairo_pdf</code>, <code class="code">X11(type = "cairo")</code> and the Cairo-based types of devices <code class="code">bmp</code> <code class="code">jpeg</code>, <code class="code">png</code> and <code class="code">tiff</code> are not the default on macOS, and much less used than the Quartz-based devices. However, the only SVG device in the R distribution, <code class="code">svg</code>, is based on Cairo.</p>
<p>Support for Cairo is optional and can be added in several ways, all of which need <code class="code">pkg-config</code>. <code class="command">configure</code> will add Cairo support if <code class="code">pkg-config</code> finds package <code class="code">cairo</code> unless <code class="code">--without-cairo</code> is used.</p>
<p>A way to statically link Cairo is by downloading and unpacking components <code class="code">cairo</code>, <code class="code">fontconfig</code>, <code class="code">freetype</code>, <code class="code">pixman</code> and <code class="code">zlib-system-stub</code> (and do not have <samp class="file">/opt/X11/lib/pkgconfig</samp> in <code class="env">PKG_CONFIG_PATH</code>). Some static builds of <code class="code">fontconfig</code> need <code class="code">libxml2</code> (from component <code class="code">xml2</code>) and others <code class="code">expat</code>, supplied by macOS but needing a file <samp class="file">$LOCAL/lib/pkgconfig/expat.pc</samp> along the lines of</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>Name<span class="sc">:</span> expat</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>Version<span class="sc">:</span> <span class="dv">2</span>.<span class="fl">2.8</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>Description<span class="sc">:</span> expat XML parser</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>URL<span class="sc">:</span> http<span class="sc">:</span><span class="er">//</span>www.libexpat.org</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>Libs<span class="sc">:</span> <span class="sc">-</span>lexpat</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>Cflags<span class="sc">:</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Note that the list of components is liable to change: running <code class="command">pkg-config cairo --exists --print-errors</code> should tell you if any others are required.</p>
<p>The best font experience of Cairo graphics will be to use it in combination with Pango which will match that supported on most other Unix-alikes. <code class="command">configure</code> uses <code class="command">pkg-config</code> to determine if all the external software required by both Pango and Cairo is available: running <code class="command">pkg-config pangocairo --exists --print-errors</code> should show if the installation suffices and if not, what is missing. At the time of writing using pre-built components <code class="code">cairo</code>, <code class="code">fontconfig</code>, <code class="code">freetype</code>, <code class="code">ffi</code>, <code class="code">fribidi</code>, <code class="code">gettext</code>, <code class="code">icu</code>, <code class="code">glib</code>, <code class="code">harfbuzz</code>, <code class="code">pango</code>, <code class="code">pcre</code>, <code class="code">pixman</code> and <code class="code">xml2</code> sufficed.</p>
</section>
<section id="other-cc-compilers" class="level3 subsection" data-number="C.3.4">
<h3 class="subsection anchored" data-number="C.3.4" data-anchor-id="other-cc-compilers"><span class="header-section-number">C.3.4</span> Other C/C++ compilers</h3>
<p>Other pre-compiled distributions of <code class="command">clang</code> may be available from <a href="https://github.com/llvm/llvm-project/releases/" class="uref">https://github.com/llvm/llvm-project/releases/</a> (recently only for <code class="code">arm64</code> and usually unsigned/not notarized which makes them hard to use). In particular, these include support for OpenMP which Apple <code class="command">clang</code> does not.</p>
<p>Suppose one of these distributions is installed under <samp class="file">$LOCAL/llvm</samp>. Use a file <samp class="file">config.site</samp> containing</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>SDK<span class="op">=</span>`xcrun <span class="op">-</span>show<span class="op">-</span>sdk<span class="op">-</span>path`</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>CC<span class="op">=</span><span class="st">"$LOCAL/llvm/bin/clang -isysroot $SDK"</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>CXX<span class="op">=</span><span class="st">"$LOCAL/llvm/bin/clang++ -isysroot $SDK"</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>OBJC<span class="op">=</span>$CC</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>FC<span class="op">=/</span>opt<span class="op">/</span>gfortran<span class="op">/</span>bin<span class="op">/</span>gfortran</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>LDFLAGS<span class="op">=</span><span class="st">"-L$LOCAL/llvm/lib -L$LOCAL/lib"</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>R_LD_LIBRARY_PATH<span class="op">=</span>$LOCAL<span class="op">/</span>llvm<span class="op">/</span>lib<span class="op">:</span>$LOCAL<span class="op">/</span>lib</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The care to specify library paths is to ensure that the OpenMP runtime library, here <samp class="file">$LOCAL/llvm/lib/libomp.dylib</samp>, is found when needed. If this works, you should see the line</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>checking whether OpenMP SIMD reduction is supported... yes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>in the <code class="command">configure</code> output. Also, <samp class="samp">R_LD_LIBRARY_PATH</samp>’ needs to be set to find the latest version of the C++ run-time libraries rather than the system ones.</p>
<p>It is normally possible to build R with GCC (built from the sources, from a <code class="command">gfortran</code> distribution, from Homebrew, …). When last tested it was not possible to use <code class="command">gcc</code> to build the <code class="code">quartz()</code> device, so <code class="command">configure --without-aqua</code> may be required. R was built and tested with the GCC 14.2 compilers in the <code class="code">arm64</code> <code class="command">gfortran</code> distribution mentioned above using a <samp class="file">config.site</samp> containing</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode makefile code-with-copy"><code class="sourceCode makefile"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="dt">CC</span><span class="ch">=</span><span class="st">/opt/gfortran/bin/gcc</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="dt">CXX</span><span class="ch">=</span><span class="st">/opt/gfortran/bin/g++</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="dt">FC</span><span class="ch">=</span><span class="st">/opt/gfortran/bin/gfortran</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="dt">CFLAGS</span><span class="ch">=</span><span class="st">"-g -O2 -Wall -pedantic -Wstrict-prototypes"</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="dt">C17FLAGS</span><span class="ch">=</span><span class="st">"-g -O2 -Wall -pedantic -Wno-strict-prototypes"</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="dt">C90FLAGS</span><span class="ch">=$C</span><span class="st">17FLAGS</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="dt">C99FLAGS</span><span class="ch">=$C</span><span class="st">17FLAGS</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="dt">CXXFLAGS</span><span class="ch">=</span><span class="st">"-g -O2 -Wall -pedantic"</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="dt">CPPFLAGS</span><span class="ch">=</span><span class="st">'-isystem /opt/R/arm64/include'</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="dt">LDFLAGS</span><span class="ch">=</span><span class="st">-L/opt/R/arm64/lib</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>It is usually possible to add some OpenMP support to the Apple <code class="command">clang</code> compilers: see <a href="https://mac.r-project.org/openmp/" class="uref">https://mac.r-project.org/openmp/</a>. Note that that approach is somewhat fragile as it needs a <samp class="file">libomp.dylib</samp> library matching the version of the compiler used.</p>
</section>
<section id="other-libraries" class="level3 subsection" data-number="C.3.5">
<h3 class="subsection anchored" data-number="C.3.5" data-anchor-id="other-libraries"><span class="header-section-number">C.3.5</span> Other libraries</h3>
<p>Pre-compiled versions of many of the <a href="Essential-and-useful-other-programs-under-a-Unix-alike.html#useful-libraries-and-programs" class="ref">Useful libraries and programs</a> are available from <a href="https://mac.r-project.org/bin//" class="uref">https://mac.r-project.org/bin//</a>.</p>
<p>Looking at the top of <samp class="file">/Library/Frameworks/R.framework/Resources/etc/Makeconf</samp> will show the compilers and configuration options used for the CRAN binary package for R: at the time of writing the non-default options</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="sc">--</span>enable<span class="sc">-</span>memory<span class="sc">-</span>profiling <span class="sc">--</span>enable<span class="sc">-</span>R<span class="sc">-</span>framework</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="sc">--</span>x<span class="sc">-</span>libraries<span class="ot">=</span><span class="er">/</span>opt<span class="sc">/</span>X11<span class="sc">/</span>lib <span class="sc">--</span>x<span class="sc">-</span>includes<span class="ot">=</span><span class="er">/</span>opt<span class="sc">/</span>X11<span class="sc">/</span>include</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>were used. (<samp class="option">--enable-R-framework</samp> implies <samp class="option">--enable-R-shlib</samp>.)</p>
<p>The main TeX implementation used by the developers is MacTeX<a href="#FOOT86" id="DOCF86" class="footnote"><sup>86</sup></a> (<a href="https://www.tug.org/mactex/" class="uref">https://www.tug.org/mactex/</a>): the full installation is about 8.5GB, but a much smaller version (‘Basic TeX’) is available at <a href="https://www.tug.org/mactex/morepackages.html" class="uref">https://www.tug.org/mactex/morepackages.html</a> to which you will need to add some packages to build R, e.g.&nbsp;for the 2022 version we needed to add<a href="#FOOT87" id="DOCF87" class="footnote"><sup>87</sup></a> <strong>helvetic</strong>, <strong>inconsolata</strong> and <strong>texinfo</strong> which brought this to about 310MB.<a href="#FOOT88" id="DOCF88" class="footnote"><sup>88</sup></a> <samp class="samp">TeX Live Utility</samp>’ (available <em>via</em> the MacTeX front page) provides a graphical means to manage TeX packages. These contain executables which run natively on both <samp class="samp">arm64</samp>’ and <samp class="samp">x86_64</samp>’.</p>
<p>Checking packages thoroughly requires Ghostscript (part of the full MacTeX distribution or separately from <a href="https://www.tug.org/mactex/morepackages.html" class="uref">https://www.tug.org/mactex/morepackages.html</a>) and <code class="command">qpdf</code> (from <a href="https://mac.r-project.org/bin//" class="uref">https://mac.r-project.org/bin//</a>, a version of which is in the <samp class="file">bin</samp> directory of a binary installation of R, usually <samp class="file">/Library/Frameworks/R.framework/Resources/bin/qpdf</samp>).</p>
<p><code class="command">R CMD check --as-cran</code> makes use of ‘HTML Tidy’. macOS at the time of writing has a version in <samp class="file">/usr/bin/tidy</samp> dating from 2006 which is far too old. Up-to-date versions can be installed from <a href="http://binaries.html-tidy.org/" class="uref">http://binaries.html-tidy.org/</a>.</p>
<p>One macOS quirk is that the default path has <samp class="file">/usr/local/bin</samp> after <samp class="file">/usr/bin</samp>, contrary to common practice on Unix-alikes. This means that if you install tools from the sources they will by default be installed under <samp class="file">/usr/local</samp> and not supersede the system versions.</p>
<p>Parallel installation of packages will make use of the utility <code class="command">timeout</code> if available. A ‘universal’ build can be downloaded from <a href="https://www.stats.ox.ac.uk/pub/bdr/timeout" class="uref">https://www.stats.ox.ac.uk/pub/bdr/timeout</a>: make it executable (<code class="code">chmod 755 timeout</code>) and put it somewhere on your path.</p>
</section>
<section id="accelerate" class="level3 subsubsection" data-number="C.3.6">
<h3 class="subsubsection anchored" data-number="C.3.6" data-anchor-id="accelerate"><span class="header-section-number">C.3.6</span> Accelerate</h3>
<p><span id="index-BLAS-library-1" class="index-entry-id"></span> <span id="index-LAPACK-library-1" class="index-entry-id"></span></p>
<p>The <code class="code">Accelerate</code> library<a href="#FOOT89" id="DOCF89" class="footnote"><sup>89</sup></a> can be used <em>via</em> the configuration option</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="sc">--</span>with<span class="sc">-</span>blas<span class="ot">=</span><span class="st">"-framework Accelerate"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>to provide potentially higher-performance versions of the BLAS and LAPACK routines.<a href="#FOOT90" id="DOCF90" class="footnote"><sup>90</sup></a> This includes a full LAPACK which can be used <em>via</em> <samp class="option">--with-lapack</samp>: however, the version of LAPACK it contains has often been seriously old (and is not used unless <samp class="option">--with-lapack</samp> is specified). Some CRAN builds of R can be switched<a href="#FOOT91" id="DOCF91" class="footnote"><sup>91</sup></a> to use Accelerate’s BLAS.</p>
<p>As from macOS 13.3, the BLAS and LAPACK libraries under the Accelerate framework are ‘now inline with reference version 3.9.1’.<a href="#FOOT92" id="DOCF92" class="footnote"><sup>92</sup></a> However, this has been done by naming new entry points and so only accessible <em>via</em> their C headers. That version can be used for BLAS calls <em>via</em> <code class="command">configure</code> option <samp class="option">--with-newAccelerate</samp>: it requires at least macOS 13.3 and SDK 13.3 (from Xcode CLT 14.3). To use it for both BLAS and LAPACK calls, configure with <samp class="option">--with-newAccelerate=lapack</samp>. These options cannot be used with others such as <samp class="option">--with-blas</samp> and <samp class="option">--with-lapack</samp>.</p>
<p>As from R&nbsp;4.5.0, specifying <samp class="option">--with-newAccelerate</samp> also requires the option <samp class="option">--with-2025blas</samp>. (Using <samp class="option">--with-newAccelerate=lapack</samp> does not.)</p>
<p>Threading in Accelerate is controlled by ‘Grand Central Dispatch’<a href="#FOOT93" id="DOCF93" class="footnote"><sup>93</sup></a> and is said not to need user control. Test <samp class="file">nls.R</samp> in package <strong>stats</strong> has often failed with the Accelerate BLAS on Intel macOS. All versions of Accelerate show differences from the reference BLAS (and most others) in the use of <code class="code">NA</code> <em>vs</em> <code class="code">NaN</code> and a substantial number of R packages fail their checks.</p>
</section>
<section id="openblas" class="level3 subsubsection" data-number="C.3.7">
<h3 class="subsubsection anchored" data-number="C.3.7" data-anchor-id="openblas"><span class="header-section-number">C.3.7</span> OpenBLAS</h3>
<p>R has been built on <samp class="samp">arm64</samp>’ using OpenBLAS 0.3.29 (sources from <a href="https://github.com/OpenMathLib/OpenBLAS/releases" class="uref">https://github.com/OpenMathLib/OpenBLAS/releases</a>) by symlinking <samp class="file">/opt/OpenBLAS/lib/libopenblas.dylib</samp> to <samp class="file">lib/libRblas.dylib</samp> (see <a href="Essential-and-useful-other-programs-under-a-Unix-alike.html#shared-blas" class="ref">Shared BLAS</a>).</p>
<p>On macOS, a default build of OpenBLAS uses <code class="code">pthreads</code> (as macOS does not have OpenMP) with the number of threads controlled by environment variable <code class="env">OPENBLAS_NUM_THREADS</code>. On an M1 Pro this defaulted to 10 threads (there are 8 ‘performance’ cores and 2 ‘efficiency cores’) and we saw a 9x speedup over the reference BLAS on a large SVD (which was slightly faster than Accelerate).</p>
</section>
<section id="tcltk-headers-and-libraries" class="level3 subsection" data-number="C.3.8">
<h3 class="subsection anchored" data-number="C.3.8" data-anchor-id="tcltk-headers-and-libraries"><span class="header-section-number">C.3.8</span> Tcl/Tk headers and libraries</h3>
<p>If you plan to use the <code class="code">tcltk</code> package for R, you will need to install a distribution of Tcl/Tk. There are two alternatives. If you use <span class="small">R.APP</span> you will want to use X11-based Tcl/Tk (as used on other Unix-alikes), which is installed under <samp class="file">$LOCAL/lib</samp> as part of the CRAN binary for R.<a href="#FOOT94" id="DOCF94" class="footnote"><sup>94</sup></a> This may need <code class="command">configure</code> options</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="sc">--</span>with<span class="sc">-</span>tcltk<span class="ot">=</span><span class="er">$</span>LOCAL<span class="sc">/</span>lib</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>or</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="sc">--</span>with<span class="sc">-</span>tcl<span class="sc">-</span>config<span class="ot">=</span><span class="er">$</span>LOCAL<span class="sc">/</span>lib<span class="sc">/</span>tclConfig.sh</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="sc">--</span>with<span class="sc">-</span>tk<span class="sc">-</span>config<span class="ot">=</span><span class="er">$</span>LOCAL<span class="sc">/</span>lib<span class="sc">/</span>tkConfig.sh</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Note that this requires a matching XQuartz installation.</p>
<p>There is also a native (‘Aqua’) version of Tcl/Tk which produces widgets in the native macOS style: this will not work with <span class="small">R.APP</span> because of conflicts over the macOS menu, but for those only using command-line R this provides a much more intuitive interface to Tk for experienced Mac users. Earlier versions of macOS came with an Aqua Tcl/Tk distribution but these were often not at all recent versions of Tcl/Tk. It is better to install Tcl/Tk 8.6.x from the sources<a href="#FOOT95" id="DOCF95" class="footnote"><sup>95</sup></a> or a binary distribution from <a href="https://www.activestate.com/platform/supported-languages/tcl/" class="uref">https://www.activestate.com/platform/supported-languages/tcl/</a>. For the latter, configure R with</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="sc">--</span>with<span class="sc">-</span>tcl<span class="sc">-</span>config<span class="ot">=</span><span class="er">/</span>Library<span class="sc">/</span>Frameworks<span class="sc">/</span>Tcl.framework<span class="sc">/</span>tclConfig.sh </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="sc">--</span>with<span class="sc">-</span>tk<span class="sc">-</span>config<span class="ot">=</span><span class="er">/</span>Library<span class="sc">/</span>Frameworks<span class="sc">/</span>Tk.framework<span class="sc">/</span>tkConfig.sh</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If you need to find out which distribution of Tk is in use at run time, use</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tcltk)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tclvalue</span>(<span class="fu">.Tcl</span>(<span class="st">"tk windowingsystem"</span>))  <span class="co"># "x11" or "aqua"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Note that some Tcl/Tk extensions only support the X11 interface: this includes <code class="code">Tktable</code> and the CRAN package <a href="https://CRAN.R-project.org/package=tkrplot" class="url"><strong>tkrplot</strong></a>.</p>
</section>
<section id="java" class="level3 subsection" data-number="C.3.9">
<h3 class="subsection anchored" data-number="C.3.9" data-anchor-id="java"><span class="header-section-number">C.3.9</span> Java</h3>
<p>macOS does not comes with an installed Java runtime (JRE) and a macOS upgrade may remove one if already installed: it is intended to be installed at first use. Check if a JRE is installed by running <code class="command">java -version</code> in a <code class="command">Terminal</code> window: if Java is not installed this may prompt you to install it from Oracle<a href="#FOOT96" id="DOCF96" class="footnote"><sup>96</sup></a> (but see the next paragraph). We recommend you install a version with long-term support, e.g.&nbsp;17 or 21<a href="#FOOT97" id="DOCF97" class="footnote"><sup>97</sup></a> but not 18–20, 22–24 with a 6-month lifetime.</p>
<p>The currently simplest way to install Java is from <a href="https://adoptium.net" class="uref">Adoptium</a><a href="#FOOT98" id="DOCF98" class="footnote"><sup>98</sup></a>: this installs into an Apple-standard location and so works with <code class="command">/usr/bin/java</code>. Other builds of OpenJDK are available from <a href="https://www.azul.com/downloads/zulu-community/?os=macos&amp;architecture=arm-64-bit&amp;package=jdk" class="uref">https://www.azul.com/downloads/zulu-community/?os=macos&amp;architecture=arm-64-bit&amp;package=jdk</a> and from OpenJDK at <a href="https://jdk.java.net/" class="uref">https://jdk.java.net/</a>, for which <code class="env">JAVA_HOME</code> may need to be set both when configuring R and at runtime. Note that Java distribution sites may use unusual designations for macOS CPUs such as <code class="code">AArch64</code>, <code class="code">x64</code> or <code class="code">x86 64-bit</code>.</p>
<p>Binary distributions of R are built against a specific version (e.g. 11.0.18 or 17.0.1) of Java so</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> R CMD javareconf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>will likely be needed to be run before using Java-using packages.</p>
<p>To see what compatible versions of Java are currently installed, run the appropriate one of</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="sc">/</span>usr<span class="sc">/</span>libexec<span class="sc">/</span>java_home <span class="sc">-</span>V <span class="sc">-</span>a arm64</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="sc">/</span>usr<span class="sc">/</span>libexec<span class="sc">/</span>java_home <span class="sc">-</span>V <span class="sc">-</span>a x86_64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If needed, set the environment variable <code class="env">JAVA_HOME</code> to choose between these, both when R is built from the sources and when <code class="command">R CMD javareconf</code> is run.</p>
<p>Configuring and building R both looks for a JRE and for support for compiling JNI programs (used to install packages <a href="https://CRAN.R-project.org/package=rJava" class="url"><strong>rJava</strong></a> and <a href="https://CRAN.R-project.org/package=JavaGD" class="url"><strong>JavaGD</strong></a>); the latter requires a JDK (Java SDK). Most distributions of Java 11 or later are of a full JDK.</p>
<p>The build process tries to fathom out what JRE/JDK to use, but it may need some help, e.g.&nbsp;by setting environment variable <code class="env">JAVA_HOME</code>. To select a build from <a href="https://adoptium.net" class="uref">Adoptium</a> set e.g.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>JAVA_HOME<span class="ot">=</span><span class="er">/</span>Library<span class="sc">/</span>Java<span class="sc">/</span>JavaVirtualMachines<span class="sc">/</span>temurin<span class="fl">-21.</span>jdk<span class="sc">/</span>Contents<span class="sc">/</span>Home</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>in <samp class="file">config.site</samp>. For Java 21 from <a href="https://jdk.java.net/" class="uref">https://jdk.java.net/</a> (which might no longer be available), use</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>JAVA_HOME<span class="ot">=</span><span class="er">/</span>path<span class="sc">/</span>to<span class="sc">/</span>jdk<span class="fl">-21.</span>jdk<span class="sc">/</span>Contents<span class="sc">/</span>Home</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Note that it is necessary to set the environment variable <code class="env">NOAWT</code> to <code class="code">1</code> to install many of the Java-using packages.</p>
</section>
<section id="frameworks" class="level3 subsection" data-number="C.3.10">
<h3 class="subsection anchored" data-number="C.3.10" data-anchor-id="frameworks"><span class="header-section-number">C.3.10</span> Frameworks</h3>
<p>The CRAN build of R is installed as a framework, which is selected by the option</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>.<span class="sc">/</span>configure <span class="sc">--</span>enable<span class="sc">-</span>R<span class="sc">-</span>framework</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>(This is intended to be used with an Apple toolchain: others may not support frameworks correctly but those from LLVM have done so.)</p>
<p>It is only needed if you want to build R for use with the <span class="small">R.APP</span> console, and implies <samp class="option">--enable-R-shlib</samp> to build R as a dynamic library. This option configures R to be built and installed as a framework called <samp class="file">R.framework</samp>. The default installation path for <samp class="file">R.framework</samp> is <samp class="file">/Library/Frameworks</samp> but this can be changed at configure time by specifying the flag <samp class="option">--enable-R-framework[=</samp><var class="var">DIR</var><samp class="option">]</samp> (or <samp class="option">--prefix</samp>) or at install time <em>via</em></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>make prefix<span class="ot">=</span><span class="er">/</span>where<span class="sc">/</span>you<span class="sc">/</span>want<span class="sc">/</span>R.framework<span class="sc">/</span>to<span class="sc">/</span>go install</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Note that installation as a framework is non-standard (especially to a non-standard location) and Unix utilities may not support it (e.g.&nbsp;the <code class="command">pkg-config</code> file <samp class="file">libR.pc</samp> will be put somewhere unknown to <code class="command">pkg-config</code>).</p>
</section>
<section id="building-r.app" class="level3 subsection" data-number="C.3.11">
<h3 class="subsection anchored" data-number="C.3.11" data-anchor-id="building-r.app"><span class="header-section-number">C.3.11</span> Building R.app</h3>
<p>Building the <span class="small">R.APP</span> GUI console is a separate project, using Xcode. Before compiling <span class="small">R.APP</span> make sure the current version of R is installed in <samp class="file">/Library/Frameworks/R.framework</samp> and is working at the command-line (this can be a binary install).</p>
<p>The current sources can be checked out by</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>svn co https<span class="sc">:</span><span class="er">//</span>svn.r<span class="sc">-</span>project.org<span class="sc">/</span>R<span class="sc">-</span>packages<span class="sc">/</span>trunk<span class="sc">/</span>Mac<span class="sc">-</span>GUI</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and built by loading the <code class="code">R.xcodeproj</code> project (select the <code class="code">R</code> target and a suitable configuration), or from the command-line by e.g.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>xcodebuild <span class="sc">-</span>target R <span class="sc">-</span>configuration Release</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>See also the <samp class="file">INSTALL</samp> file in the checkout or directly at <a href="https://svn.r-project.org/R-packages/trunk/Mac-GUI/INSTALL" class="uref">https://svn.r-project.org/R-packages/trunk/Mac-GUI/INSTALL</a>.</p>
<p><span class="small">R.APP</span> does not need to be installed in any specific way. Building <span class="small">R.APP</span> results in the <span class="small">R.APP</span> bundle which appears as one R icon. This application bundle can be run from anywhere and it is customary to place it in the <samp class="file">/Applications</samp> folder.</p>
</section>
<section id="building-binary-packages" class="level3 subsection" data-number="C.3.12">
<h3 class="subsection anchored" data-number="C.3.12" data-anchor-id="building-binary-packages"><span class="header-section-number">C.3.12</span> Building binary packages</h3>
<p>CRAN macOS binary packages are distributed as tarballs with suffix <samp class="file">.tgz</samp> to distinguish them from source tarballs. One can <code class="command">tar</code> an existing installed package, or use <code class="command">R CMD INSTALL --build</code>.</p>
<p>However, there are some important details.</p>
<ul>
<li><p>Current CRAN macOS distributions are targeted at Big Sur so it is wise to ensure that the compilers generate code that will run on Big Sur or later. With the recommended compilers we can use</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode makefile code-with-copy"><code class="sourceCode makefile"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="dt">CC</span><span class="ch">=</span><span class="st">"clang -mmacos-version-min=11.0"</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="dt">CXX</span><span class="ch">=</span><span class="st">"clang++ -mmacos-version-min=11.0"</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="dt">FC</span><span class="ch">=</span><span class="st">"/opt//gfortran/bin/gfortran -mmacosx-version-min=11.0"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>or set the environment variable</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>export MACOSX_DEPLOYMENT_TARGET<span class="ot">=</span><span class="fl">11.0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Using the flag <samp class="option">-Werror=partial-availability</samp> can help trigger compilation errors on functionality not in Big Sur.</p></li>
<li><p>Check that any compiled code is not dynamically linked to libraries only on your machine, for example by using <code class="command">otool -L</code> or <code class="command">objdump -macho -dylibs-used</code>. This can include C++ and Fortran run-time libraries under <samp class="file">/opt/R/x86_64/lib</samp> or <samp class="file">/opt/R/arm64/lib</samp>: one can use <code class="command">install_name_tool</code> to point these at system versions or those shipped with R, for example</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>install_name_tool <span class="sc">-</span>change <span class="sc">/</span>usr<span class="sc">/</span>local<span class="sc">/</span>llvm<span class="sc">/</span>lib<span class="sc">/</span>libc<span class="sc">++</span>.<span class="fl">1.</span>dylib \</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="sc">/</span>usr<span class="sc">/</span>lib<span class="sc">/</span>libc<span class="sc">++</span>.<span class="fl">1.</span>dylib \</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>pkg.so</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>install_name_tool <span class="sc">-</span>change</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="sc">/</span>opt<span class="sc">/</span>gfortran<span class="sc">/</span>lib<span class="sc">/</span>gcc<span class="sc">/</span>aarch64<span class="sc">-</span>apple<span class="sc">-</span>darwin20<span class="fl">.0</span><span class="sc">/</span><span class="dv">14</span>.<span class="fl">2.0</span><span class="sc">/</span>libgfortran.<span class="fl">5.</span>dylib \</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="sc">/</span>Library<span class="sc">/</span>Frameworks<span class="sc">/</span>R.framework<span class="sc">/</span>Resources<span class="sc">/</span>lib<span class="sc">/</span>libgfortran.<span class="fl">5.</span>dylib \</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>pkg.so</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>install_name_tool <span class="sc">-</span>change</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="sc">/</span>opt<span class="sc">/</span>gfortran<span class="sc">/</span>lib<span class="sc">/</span>gcc<span class="sc">/</span>aarch64<span class="sc">-</span>apple<span class="sc">-</span>darwin20<span class="fl">.0</span><span class="sc">/</span><span class="dv">14</span>.<span class="fl">2.0</span><span class="sc">/</span>libquadmath.<span class="fl">0.</span>dylib \</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="sc">/</span>Library<span class="sc">/</span>Frameworks<span class="sc">/</span>R.framework<span class="sc">/</span>Resources<span class="sc">/</span>lib<span class="sc">/</span>libquadmath.<span class="fl">0.</span>dylib \</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>pkg.so</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>(where the details depend on the compilers and CRAN macOS R release).</p></li>
<li><p>For C++ code there is the possibility that calls will be generated to entry points not in the system <samp class="file">/usr/lib/libc++.1.dylib</samp>. The previous step allows this to be tested against the system library on the build OS, but not against earlier ones. It may be possible to circumvent that by static linking to <samp class="file">libc++.a</samp> and <samp class="file">libc++abi.a</samp> by something like</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>SHLIB_CXXLD <span class="op">=</span> <span class="op">/</span>usr<span class="op">/</span>local<span class="op">/</span>llvm<span class="op">/</span>bin<span class="op">/</span>clang</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>PKG_LIBS <span class="op">=</span> <span class="op">/</span>usr<span class="op">/</span>local<span class="op">/</span>llvm<span class="op">/</span>lib<span class="op">/</span>libc<span class="op">++.</span>a <span class="op">/</span>usr<span class="op">/</span>local<span class="op">/</span>llvm<span class="op">/</span>lib<span class="op">/</span>libc<span class="op">++</span>abi<span class="op">.</span>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>in <samp class="file">src/Makevars</samp>. It would also be possible to static link the Fortran runtime libraries <samp class="file">libgfortran.a</samp> and <samp class="file">libquadmath.a</samp> should the Fortran compiler have later versions (but <code class="command">gfortran</code> 8–14 all have version <code class="code">5</code>).</p></li>
</ul>
<p>The CRAN binary packages are built with the Apple compiler on the oldest supported version of macOS, which avoids the first two and any issues with C++ libraries.</p>
</section>
<section id="building-for-intel-on-arm64" class="level3 subsection" data-number="C.3.13">
<h3 class="subsection anchored" data-number="C.3.13" data-anchor-id="building-for-intel-on-arm64"><span class="header-section-number">C.3.13</span> Building for Intel on <samp class="samp">arm64</samp>’</h3>
<p>Should one want to build R for Intel on an <samp class="samp">arm64</samp>’ Big Sur Mac, add the target for the compilers:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode makefile code-with-copy"><code class="sourceCode makefile"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="dt">CC</span><span class="ch">=</span><span class="st">"clang -arch x86_64</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="dt">OBJC</span><span class="ch">=$C</span><span class="st">C</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="dt">CXX</span><span class="ch">=</span><span class="st">"clang++ -arch x86_64"</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="dt">FC</span><span class="ch">=</span><span class="st">"/opt//gfortran/bin/gfortran -arch x86_64 -mtune=native -mmacosx-version-min=11"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and install the Fortran compiler and external software described above for Intel builds (and have <samp class="file">/opt/R/x86_64/bin</samp> before <samp class="file">/opt/R/arm64/bin</samp> in your path).</p>
<p>To set the correct architecture (which will be auto-detected as <code class="code">aarch64</code>), use something like</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="sc">/</span>path<span class="sc">/</span>to<span class="sc">/</span>configure <span class="sc">--</span>build<span class="ot">=</span>x86_64<span class="sc">-</span>apple<span class="sc">-</span>darwin20</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="installer" class="level3 subsection" data-number="C.3.14">
<h3 class="subsection anchored" data-number="C.3.14" data-anchor-id="installer"><span class="header-section-number">C.3.14</span> Installer</h3>
<p>The scripts for the CRAN packaging of R can be found under <a href="https://svn.r-project.org/R-dev-web/trunk/QA/Simon/R4/" class="uref">https://svn.r-project.org/R-dev-web/trunk/QA/Simon/R4/</a>: start with the <samp class="file">README</samp> file in that directory.</p>
</section>
</section>
<section id="freebsd" class="level2 section" data-number="C.4">
<h2 class="section anchored" data-number="C.4" data-anchor-id="freebsd"><span class="header-section-number">C.4</span> FreeBSD</h2>
<p>There have been few recent reports on FreeBSD: there is a ‘port’ at <a href="https://svnweb.freebsd.org/ports/head/math/R" class="uref">https://svnweb.freebsd.org/ports/head/math/R</a>, currently last updated for R 4.0.4. Recent versions of FreeBSD use Clang and the <code class="code">libc++</code> C++ headers and runtime, but the ‘port’ has been configured to use GCC.</p>
<p>Use of ICU for collation and the <code class="command">configure</code> option <samp class="option">--with-internal-tzcode</samp> are desirable workarounds.</p>
</section>
<section id="openbsd" class="level2 section" data-number="C.5">
<h2 class="section anchored" data-number="C.5" data-anchor-id="openbsd"><span class="header-section-number">C.5</span> OpenBSD</h2>
<p>Ingo Feinerer installed R version 3.2.2 on OpenBSD 5.8 arch <samp class="samp">amd64</samp>’ (their name for <samp class="samp">x86_64</samp>’). Details of the build (and patches applied) are at <a href="https://cvsweb.openbsd.org/cgi-bin/cvsweb/ports/math/R/" class="uref">https://cvsweb.openbsd.org/cgi-bin/cvsweb/ports/math/R/</a>, currently updated for R 4.2.3.</p>
</section>
<section id="cygwin" class="level2 section" data-number="C.6">
<h2 class="section anchored" data-number="C.6" data-anchor-id="cygwin"><span class="header-section-number">C.6</span> Cygwin</h2>
<p>The 32-bit version never worked well enough to pass R’s <code class="command">make check</code>, and residual support from earlier experiments was removed in R 3.3.0.</p>
<p>The 64-bit version was never supported.</p>
</section>
<section id="new-platforms" class="level2 section" data-number="C.7">
<h2 class="section anchored" data-number="C.7" data-anchor-id="new-platforms"><span class="header-section-number">C.7</span> New platforms</h2>
<p>There are a number of sources of problems when installing R on a new hardware/OS platform. These include</p>
<p><strong>Floating Point Arithmetic</strong>: R requires arithmetic compliant with IEC&nbsp;60559, also known as IEEE&nbsp;754. This mandates the use of plus and minus infinity and <code class="code">NaN</code> (not a number) as well as specific details of rounding. Although almost all current FPUs can support this, selecting such support can be a pain. The problem is that there is no agreement on how to set the signalling behaviour; Sun/Sparc, SGI/IRIX and <samp class="samp">ix86</samp>’ Linux require no special action, FreeBSD requires a call to (the macro) <code class="code">fpsetmask(0)</code> and OSF1 required that computation be done with a <samp class="option">-ieee_with_inexact</samp> flag etc. With Intel compilers on 32-bit and 64-bit Intel machines, one has to explicitly disable flush-to-zero and denormals-are-zero modes. Some ARM processors including A12Z and M1 (Apple Silicon) by default use runfast mode, which includes flush-to-zero and default-nan and hence has to be disabled. With default-nan mode, the NaN payload used for representation of numeric NA values is lost even on simple operations with finite values. On a new platform you must find out the magic recipe and add some code to make it work. This can often be done via the file <samp class="file">config.site</samp> which resides in the top level directory.</p>
<p>Beware of using high levels of optimization, at least initially. On many compilers these reduce the degree of compliance to the IEEE model. For example, using <samp class="option">-fast</samp> on the Oracle compilers has caused R’s <code class="code">NaN</code> to be set incorrectly, and <code class="command">gcc</code>’s <samp class="option">-ffast-math</samp> and <code class="command">clang</code>’s <samp class="option">-Ofast</samp> have given incorrect results.</p>
<p><strong>Shared Objects</strong>: There seems to be very little agreement across platforms on what needs to be done to build shared objects. there are many different combinations of flags for the compilers and loaders. GNU libtool cannot be used (yet), as it currently does not fully support Fortran: one would need a shell wrapper for this). The technique we use is to first interrogate the X window system about what it does (using <code class="command">xmkmf</code>), and then override this in situations where we know better (for tools from the GNU Compiler Collection and/or platforms we know about). This typically works, but you may have to manually override the results. Scanning the manual entries for <code class="command">cc</code> and <code class="command">ld</code> usually reveals the correct incantation. Once you know the recipe you can modify the file <samp class="file">config.site</samp> (following the instructions therein) so that the build will use these options.</p>
<p>It seems that <code class="command">gcc</code>&nbsp;3.4.x and later on <samp class="samp">ix86</samp>’ Linux defeat attempts by the LAPACK code to avoid computations entirely in extended-precision registers, so file <samp class="file">src/modules/lapack/dlamc.f</samp> may need to be compiled without optimization or with additional flags. Set the configure variable <code class="env">SAFE_FFLAGS</code> to the flags to be used for this file.</p>
<p>If you do manage to get R running on a new platform please let us know about it so we can modify the configuration procedures to include that platform.</p>
<p>If you are having trouble getting R to work on your platform please feel free to use the <samp class="samp">R-devel</samp>’ mailing list to ask questions. We have had a fair amount of practice at porting R to new platforms <span class="small">...</span></p>
<p>One thing you might want to add for a new platform is the mapping of C/C++/Fortran calls to entry point names used for <code class="command">R CMD check</code>. See <a href="https://svn.r-project.org/R-dev-web/trunk/sotools.txt" class="uref">https://svn.r-project.org/R-dev-web/trunk/sotools.txt</a> for how to do so.</p>

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Configuration-on-a-Unix-alike.html" class="pagination-link" aria-label="Configuration on a Unix-alike">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Configuration on a Unix-alike</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>A re-styled version of the original R manuals at <a href="https://cran.r-project.org/manuals.html" class="uri">https://cran.r-project.org/manuals.html</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Built using <a href="https://quarto.org">Quarto</a></p>
</div>
  </div>
</footer>




</body></html>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>R Manuals :: R Installation and Administration - 2&nbsp; Installing R under Unix-alikes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Installing-R-under-Windows.html" rel="next">
<link href="./Obtaining-R.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">R Manuals :: R Installation and Administration</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./../index.html">Home</a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-manuals" role="button" data-bs-toggle="dropdown" aria-expanded="false">Manuals</a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-manuals">    
        <li>
    <a class="dropdown-item" href="./../r-intro/index.html">
 <span class="dropdown-text">An Introduction to R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./../r-data/index.html">
 <span class="dropdown-text">R Data Import/Export</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./index.html">
 <span class="dropdown-text">R Installation and Administration</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./../r-exts/index.html">
 <span class="dropdown-text">Writing R Extensions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./../r-lang/index.html">
 <span class="dropdown-text">R Language Definition</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./../r-ints/index.html">
 <span class="dropdown-text">R Internals</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./../about.html">About</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Installing R under Unix-alikes</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">R Installation and Administration</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Obtaining-R.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Obtaining R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Installing-R-under-Unix-alikes.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Installing R under Unix-alikes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Installing-R-under-Windows.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Installing R under Windows</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Installing-R-under-macOS.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Installing R under macOS</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Running-R.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Running R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Add-on-packages.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Add-on packages</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Internationalization.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Internationalization and Localization</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Choosing-between-32--and-64-bit-builds.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Choosing between 32- and 64-bit builds</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./The-standalone-Rmath-library.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">The standalone Rmath library</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Essential-and-useful-other-programs-under-a-Unix-alike.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Essential and useful other programs under a Unix-alike</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Configuration-on-a-Unix-alike.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Configuration on a Unix-alike</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Platform-notes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Platform notes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Function-and-variable-index.html" class="sidebar-item-text sidebar-link">Function and variable index</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Concept-index.html" class="sidebar-item-text sidebar-link">Concept index</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Environment-variable-index.html" class="sidebar-item-text sidebar-link">Environment variable index</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#simple-compilation" id="toc-simple-compilation" class="nav-link active" data-scroll-target="#simple-compilation"> <span class="header-section-number">2.1</span> Simple compilation</a></li>
  <li><a href="#help-options" id="toc-help-options" class="nav-link" data-scroll-target="#help-options"> <span class="header-section-number">2.2</span> Help options</a></li>
  <li><a href="#making-the-manuals" id="toc-making-the-manuals" class="nav-link" data-scroll-target="#making-the-manuals"> <span class="header-section-number">2.3</span> Making the manuals</a></li>
  <li><a href="#installation" id="toc-installation" class="nav-link" data-scroll-target="#installation"> <span class="header-section-number">2.4</span> Installation</a></li>
  <li><a href="#uninstallation" id="toc-uninstallation" class="nav-link" data-scroll-target="#uninstallation"> <span class="header-section-number">2.5</span> Uninstallation</a></li>
  <li><a href="#sub-architectures" id="toc-sub-architectures" class="nav-link" data-scroll-target="#sub-architectures"> <span class="header-section-number">2.6</span> Sub-architectures</a>
  <ul class="collapse">
  <li><a href="#multilib" id="toc-multilib" class="nav-link" data-scroll-target="#multilib"> <span class="header-section-number">2.6.1</span> Multilib</a></li>
  </ul></li>
  <li><a href="#other-options" id="toc-other-options" class="nav-link" data-scroll-target="#other-options"> <span class="header-section-number">2.7</span> Other Options</a>
  <ul class="collapse">
  <li><a href="#debugging-symbols" id="toc-debugging-symbols" class="nav-link" data-scroll-target="#debugging-symbols"> <span class="header-section-number">2.7.1</span> Debugging Symbols</a></li>
  <li><a href="#openmp-support" id="toc-openmp-support" class="nav-link" data-scroll-target="#openmp-support"> <span class="header-section-number">2.7.2</span> OpenMP Support</a></li>
  <li><a href="#c-support" id="toc-c-support" class="nav-link" data-scroll-target="#c-support"> <span class="header-section-number">2.7.3</span> C++ Support</a></li>
  <li><a href="#link-time-optimization" id="toc-link-time-optimization" class="nav-link" data-scroll-target="#link-time-optimization"> <span class="header-section-number">2.7.4</span> Link-Time Optimization</a></li>
  <li><a href="#lto-with-gcc" id="toc-lto-with-gcc" class="nav-link" data-scroll-target="#lto-with-gcc"> <span class="header-section-number">2.7.5</span> LTO with GCC</a></li>
  <li><a href="#lto-with-llvm" id="toc-lto-with-llvm" class="nav-link" data-scroll-target="#lto-with-llvm"> <span class="header-section-number">2.7.6</span> LTO with LLVM</a></li>
  <li><a href="#lto-for-package-checking" id="toc-lto-for-package-checking" class="nav-link" data-scroll-target="#lto-for-package-checking"> <span class="header-section-number">2.7.7</span> LTO for package checking</a></li>
  </ul></li>
  <li><a href="#testing-an-installation" id="toc-testing-an-installation" class="nav-link" data-scroll-target="#testing-an-installation"> <span class="header-section-number">2.8</span> Testing an Installation</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="installing-r-under-unix-alikes" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Installing R under Unix-alikes</span></span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<div class="page-columns page-full"><p>R will configure and build under most common Unix and Unix-alike platforms including <var>cpu</var><code>-*-linux-gnu</code> for the <code>alpha</code>, <code>arm64</code>, <code>hppa</code>, <code>ix86</code>, <code>m68k</code>, <code>mips</code>, <code>mipsel</code>#, <code>ppc64</code>, <code>s390x</code>, <code>sparc64</code>, and <code>x86_64</code> CPUs, <code>x86_64-apple-darwin</code> and <code>aarch64-apple-darwin</code><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> as well as perhaps (it is tested less frequently on these platforms) <code>i386-sun-solaris</code>, <code>i386-*-freebsd</code>, <code>x86_64-*-freebsd</code>, <code>i386-*-netbsd</code>, <code>x86_64-*-openbsd</code> and <code>powerpc-ibm-aix6*</code></p><div class="no-row-height column-margin column-container"><li id="fn1" role="doc-endnote"><p><sup>1</sup>&nbsp;aka ‘Apple Silicon’, known to some as <code>arm64-apple-darwin</code>.</p></li></div></div>
<p>In addition, binary distributions are available for some common Linux distributions (see the FAQ for current details) and for macOS. These are installed in platform-specific ways, so for the rest of this chapter we consider only building from the sources.</p>
<p>Cross-building is not possible: installing R builds a minimal version of R and then runs many R scripts to complete the build.</p>
<section id="simple-compilation" class="level2 section page-columns page-full" data-number="2.1">
<h2 class="section anchored" data-number="2.1" data-anchor-id="simple-compilation"><span class="header-section-number">2.1</span> Simple compilation</h2>
<div class="page-columns page-full"><p>First review the essential and useful tools and libraries in <a href="Essential-and-useful-other-programs-under-a-Unix-alike.html#essential-and-useful-other-programs-under-a-unix-alike">Essential and useful other programs under a Unix-alike</a>, and install those you want or need. Ensure that either the environment variable <code>TMPDIR</code> is either unset (and <code>/tmp</code> exists and can be written in and scripts can be executed from) or points to the absolute path to a valid temporary directory (one from which execution of scripts is allowed) which does not contain spaces.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p><div class="no-row-height column-margin column-container"><li id="fn2" role="doc-endnote"><p><sup>2</sup>&nbsp;Most aspects will work with paths containing spaces, but external software used by R may not.</p></li></div></div>
<p>Choose a directory to install the R tree (R is not just a binary, but has additional data sets, help files, font metrics etc). Let us call this place <var>R_HOME</var>. Untar the source code. This should create directories <code>src</code>, <code>doc</code>, and several more under a top-level directory: change to that top-level directory (At this point North American readers should consult <a href="Configuration-on-a-Unix-alike.html#setting-paper-size">Setting paper size</a>.) Issue the following commands:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>.<span class="sc">/</span>configure</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>make</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="page-columns page-full"><p>(See <a href="Configuration-on-a-Unix-alike.html#using-make">Using make</a> if your make is not called <code>make</code>.) Users of Debian-based 64-bit systems<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> may need</p><div class="no-row-height column-margin column-container"><li id="fn3" role="doc-endnote"><p><sup>3</sup>&nbsp;which use <code>lib</code> rather than <code>lib64</code> for their primary 64-bit library directories: attempts are made to detect such systems.</p></li></div></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>.<span class="sc">/</span>configure LIBnn<span class="ot">=</span>lib</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>make</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Then check the built system works correctly by</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>make check</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Failures are not necessarily problems as they might be caused by missing functionality, but you should look carefully at any reported discrepancies. (Some non-fatal errors are expected in locales that do not support Latin-1, in particular in true <code>C</code> locales and non-UTF-8 non-Western-European locales.) A failure in <code>tests/ok-errors.R</code> may indicate inadequate resource limits (see <a href="Running-R.html">Running R</a>).</p>
<p>More comprehensive testing can be done by</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>make check<span class="sc">-</span>devel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>or</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>make check<span class="sc">-</span>all</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>see file <code>tests/README</code> and <a href="#testing-a-unix-alike-installation">Testing a Unix-alike Installation</a> for the possibilities of doing this in parallel. Note that these checks are only run completely if the recommended packages are installed. If you have a local CRAN mirror, these checks can be speeded up by either setting environment variable <code>R_CRAN_WEB</code> to its URL, or having a file <code>.R/repositories</code> specifying it (see <code>?setRepositories</code>).</p>
<p>If the <code>configure</code> and <code>make</code> commands execute successfully, a shell-script front-end called <code>R</code> will be created and copied to <var>R_HOME</var><code>/bin</code>. You can link or copy this script to a place where users can invoke it, for example to <code>/usr/local/bin/R</code>. You could also copy the man page <code>R.1</code> to a place where your <code>man</code> reader finds it, such as <code>/usr/local/man/man1</code>. If you want to install the complete R tree to, e.g., <code>/usr/local/lib/R</code>, see <a href="#installation">Installation</a>. Note: you do not <em>need</em> to install R: you can run it from where it was built.</p>
<p>You do not necessarily have to build R in the top-level source directory (say, <var>TOP_SRCDIR</var>). To build in <var>BUILDDIR</var>, run</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>cd BUILDDIR</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>TOP_SRCDIR<span class="sc">/</span>configure</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>make</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and so on, as described further below. This has the advantage of always keeping your source tree clean and is particularly recommended when you work with a version of R from Subversion. (You may need GNU <code>make</code> to allow this, and you will need no spaces in the path to the build directory. It is unlikely to work if the source directory has previously been used for a build.)</p>
<p>There are many settings which can be customized when building R and most are described in the file <code>config.site</code> in the top-level source directory. This can be edited, but for an installation using <var>BUILDDIR</var> it is better to put the changed settings in a newly-created file <code>config.site</code> in the build directory.</p>
<p>Now <code>rehash</code> if necessary, type <kbd>R</kbd>, and read the R manuals and the R FAQ (files <code>FAQ</code> or <code>doc/manual/R-FAQ.html</code>, or <a href="https://CRAN.R-project.org/doc/FAQ/R-FAQ.html" class="uri">https://CRAN.R-project.org/doc/FAQ/R-FAQ.html</a> which always has the version for the latest release of R).</p>
<p>Note: if you already have R installed, check that where you installed R replaces or comes earlier in your path than the previous installation. Some systems are set up to have <code>/usr/bin</code> (the standard place for a system installation) ahead of <code>/usr/local/bin</code> (the default place for installation of R) in their default path, and some do not have <code>/usr/local/bin</code> on the default path.</p>
</section>
<section id="help-options" class="level2 section" data-number="2.2">
<h2 class="section anchored" data-number="2.2" data-anchor-id="help-options"><span class="header-section-number">2.2</span> Help options</h2>
<p>R by default provides help pages as plain text displayed in a pager, with the options (see the help for <code>help</code>) of displaying help as HTML or PDF.</p>
<p>By default HTML help pages are created when needed rather than being built at install time.</p>
<p>If you need to disable the server and want HTML help, there is the option to build HTML pages when packages are installed (including those installed with R). This is enabled by the <code>configure</code> option <code>--enable-prebuilt-html</code>. Whether <code>R CMD INSTALL</code> (and hence <code>install.packages</code>) pre-builds HTML pages is determined by looking at the R installation and is reported by <code>R CMD INSTALL --help</code>: it can be overridden by specifying one of the <code>INSTALL</code> options <code>--html</code> or <code>--no-html</code>.</p>
<p>The server is disabled by setting the environment variable <code>R_DISABLE_HTTPD</code> to a non-empty value, either before R is started or within the R session before HTML help (including <code>help.start</code>) is used. It is also possible that system security measures will prevent the server from being started, for example if the loopback interface has been disabled. See <code>?tools::startDynamicHelp</code> for more details.</p>
</section>
<section id="making-the-manuals" class="level2 section page-columns page-full" data-number="2.3">
<h2 class="section anchored" data-number="2.3" data-anchor-id="making-the-manuals"><span class="header-section-number">2.3</span> Making the manuals</h2>
<p>There is a set of manuals that can be built from the sources,</p>
<dl>
<dt><code>fullrefman</code></dt>
<dd>
<p>Printed versions of all the help pages for base and recommended packages (around 3750 pages).</p>
</dd>
<dt><code>refman</code></dt>
<dd>
<p>Printed versions of the help pages for selected base packages (around 2200 pages)</p>
</dd>
<dt><code>R-FAQ</code></dt>
<dd>
<p>R FAQ</p>
</dd>
<dt><code>R-intro</code></dt>
<dd>
<p>“An Introduction to R”.</p>
</dd>
<dt><code>R-data</code></dt>
<dd>
<p>“R Data Import/Export”.</p>
</dd>
<dt><code>R-admin</code></dt>
<dd>
<p>“R Installation and Administration”, this manual.</p>
</dd>
<dt><code>R-exts</code></dt>
<dd>
<p>“Writing R Extensions”.</p>
</dd>
<dt><code>R-lang</code></dt>
<dd>
<p>“The R Language Definition”.</p>
</dd>
</dl>
<p>To make these (with <code>fullrefman</code> rather than <code>refman</code>), use</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>make pdf      to create PDF versions</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>make info     to create info <span class="fu">files</span> (not ‘refman’ nor ‘fullrefman’).</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You will not be able to build any of these unless you have <code>texi2any</code> version 5.1 or later installed, and for PDF you must have <code>texi2dvi</code> and <code>texinfo.tex</code> installed (which are part of the GNU <strong>texinfo</strong> distribution but are, especially <code>texinfo.tex</code>, often made part of the TeX package in re-distributions). The path to <code>texi2any</code> can be set by macro <code>TEXI2ANY</code> in <code>config.site</code>. NB: <code>texi2any</code> requires <code>perl</code>.</p>
<p>The PDF versions can be viewed using any recent PDF viewer: they have hyperlinks that can be followed. The info files are suitable for reading online with Emacs or the standalone GNU <code>info</code> program. The PDF versions will be created using the paper size selected at configuration (default ISO a4): this can be overridden by setting <code>R_PAPERSIZE</code> on the <code>make</code> command line, or setting <code>R_PAPERSIZE</code> in the environment and using <code>make -e</code>. (If re-making the manuals for a different paper size, you should first delete the file <code>doc/manual/version.texi</code>. The usual value for North America would be <code>letter</code>.)</p>
<p>There are some issues with making the PDF reference manual, <code>fullrefman.pdf</code> or <code>refman.pdf</code>. The help files contain both non-ASCII characters (e.g.&nbsp;in <code>text.Rd</code>) and upright quotes, neither of which are contained in the standard LaTeX Computer Modern fonts. We have provided the following alternatives:</p>
<dl class="page-columns page-full">
<dt><code>times</code></dt>
<dd class="page-columns page-full">
<div class="page-columns page-full"><p>(The default.) Using standard PostScript fonts, Times Roman, Helvetica and Courier. This works well both for on-screen viewing and for printing. One disadvantage is that the Usage and Examples sections may come out rather wide: this can be overcome by using <em>in addition</em> either of the options <code>inconsolata</code> (on a Unix-alike only if found by <code>configure</code>) or <code>beramono</code>, which replace the Courier monospaced font by Inconsolata or Bera Sans mono respectively. (You will need the LaTeX package <strong>inconsolata</strong><a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> or <strong>bera</strong> installed.)</p><div class="no-row-height column-margin column-container"><li id="fn4" role="doc-endnote"><p><sup>4</sup>&nbsp;Instructions on how to install the latest version are at <a href="https://www.ctan.org/tex-archive/fonts/inconsolata/" class="uri">https://www.ctan.org/tex-archive/fonts/inconsolata/</a>.</p></li></div></div>
<p>Note that in most LaTeX installations this will not actually use the standard fonts for PDF, but rather embed the URW clones NimbusRom, NimbusSans and (for Courier, if used) NimbusMon.</p>
<p>This needs LaTeX packages <strong>times</strong>, <strong>helvetic</strong> and (if used) <strong>courier</strong> installed.</p>
</dd>
<dt><code>lm</code></dt>
<dd>
<p>Using the <em>Latin Modern</em> fonts. These are not often installed as part of a TeX distribution, but can obtained from <a href="https://www.ctan.org/tex-archive/fonts/ps-type1/lm/" class="uri">https://www.ctan.org/tex-archive/fonts/ps-type1/lm/</a> and mirrors. This uses fonts rather similar to Computer Modern, but is not so good on-screen as <code>times</code>.</p>
</dd>
</dl>
<div class="page-columns page-full"><p>The default can be overridden by setting the environment variable <code>R_RD4PDF</code>. (On Unix-alikes, this will be picked up at install time and stored in <code>etc/Renviron</code>, but can still be overridden when the manuals are built, using <code>make -e</code>.) The usual<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> default value for <code>R_RD4PDF</code> is <code>times,inconsolata,hyper</code>: omit <code>inconsolata</code> if you do not have LaTeX package <strong>inconsolata</strong> installed. As from R 4.2.0, <code>hyper</code> is always enabled (with a fallback if LaTeX package <strong>hyperref</strong> is not installed).</p><div class="no-row-height column-margin column-container"><li id="fn5" role="doc-endnote"><p><sup>5</sup>&nbsp;on a Unix-alike, <code>inconsolata</code> is omitted if not found by <code>configure</code>.</p></li></div></div>
<p>Further options, e.g for <strong>hyperref</strong>, can be included in a file <code>Rd.cfg</code> somewhere on your LaTeX search path. For example, if you prefer to hyperlink the text and not the page number in the table of contents use</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>\ifthenelse{\boolean{Rd<span class="sc">@</span>use<span class="sc">@</span>hyper}}{\hypersetup{linktoc<span class="ot">=</span>section}}{}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>or</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>\ifthenelse{\boolean{Rd<span class="sc">@</span>use<span class="sc">@</span>hyper}}{\hypersetup{linktoc<span class="ot">=</span>all}}{}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>to hyperlink both text and page number.</p>
<p>Any generated PDF manuals can be compacted by</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>make compact<span class="sc">-</span>pdf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>provided <code>qpdf</code> and <code>gs</code> are available (see <code>?tools::compactPDF</code> for how to specify them if not on the path).</p>
<p>Ebook versions of most of the manuals in one or both of <code>.epub</code> and <code>.mobi</code> formats can be made by running in <code>doc/manual</code> one of</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>make ebooks</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>make epub</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>make mobi</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This requires <code>ebook-convert</code> from <a href="https://calibre-ebook.com/download"><code>Calibre</code></a>, or from most Linux distributions. If necessary the path to <code>ebook-convert</code> can be set as make macro <code>EBOOK</code> by editing <code>doc/manual/Makefile</code> (which contains a commented value suitable for macOS) or using <code>make -e</code>.</p>
</section>
<section id="installation" class="level2 section page-columns page-full" data-number="2.4">
<h2 class="section anchored" data-number="2.4" data-anchor-id="installation"><span class="header-section-number">2.4</span> Installation</h2>
<p>To ensure that the installed tree is usable by the right group of users, set <code>umask</code> appropriately (perhaps to <code>022</code>) before unpacking the sources and throughout the build process.</p>
<p>After</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>.<span class="sc">/</span>configure</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>make</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>make check</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>(or, when building outside the source, <var>TOP_SRCDIR</var><code>/configure</code>, etc) have been completed successfully, you can install the complete R tree to your system by typing</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>make install</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>A parallel make can be used (but run <code>make</code> before <code>make install</code>). Those using GNU <code>make</code> 4.0 or later may want to use <var>make -j ``n</var><code>-O</code> to avoid interleaving of output.</p>
<p>This will install to the following directories:</p>
<dl>
<dt><var>prefix</var><code>/bin</code> or <var>bindir</var></dt>
<dd>
<p>the front-end shell script and other scripts and executables</p>
</dd>
<dt><var>prefix</var><code>/man/man1</code> or <var>mandir</var><code>/man1</code></dt>
<dd>
<p>the man page</p>
</dd>
<dt><var>prefix</var><var>/``LIBnn</var><code>/R</code> or <var>libdir</var><code>/R</code></dt>
<dd>
<p>all the rest (libraries, on-line help system, …). Here <var>LIBnn</var> is usually <code>lib</code>, but may be <code>lib64</code> on some 64-bit Linux systems. This is known as the R home directory.</p>
</dd>
</dl>
<p>where <var>prefix</var> is determined during configuration (typically <code>/usr/local</code>) and can be set by running <code>configure</code> with the option <code>--prefix</code>, as in</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>.<span class="sc">/</span>configure <span class="sc">--</span>prefix<span class="ot">=</span><span class="er">/</span>where<span class="sc">/</span>you<span class="sc">/</span>want<span class="sc">/</span>R<span class="sc">/</span>to<span class="sc">/</span>go</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>where the value should be an absolute path. This causes <code>make install</code> to install the R script to <code>/where/you/want/R/to/go/bin</code>, and so on. The prefix of the installation directories can be seen in the status message that is displayed at the end of <code>configure</code>. The installation may need to be done by the owner of <var>prefix</var>, often a root account.</p>
<p>There is the option of using <code>make install-strip</code> (see <a href="#debugging-symbols">Debugging Symbols</a>).</p>
<p>You can install into another directory tree by using</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>make prefix<span class="ot">=</span><span class="er">/</span>path<span class="sc">/</span>to<span class="sc">/</span>here install</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>at least with GNU <code>make</code> (but not some other Unix makes).</p>
<p>More precise control is available at configure time via options: see <code>configure --help</code> for details. (However, most of the ‘Fine tuning of the installation directories’ options are not used by R.)</p>
<p>Configure options <code>--bindir</code> and <code>--mandir</code> are supported and govern where a copy of the <code>R</code> script and the <code>man</code> page are installed.</p>
<p>The configure option <code>--libdir</code> controls where the main R files are installed: the default is <var>eprefix</var><var>/``LIBnn</var>’, where <var>eprefix</var> is the prefix used for installing architecture-dependent files, defaults to <var>prefix</var>, and can be set via the configure option <code>--exec-prefix</code>.</p>
<p>Each of <code>bindir</code>, <code>mandir</code> and <code>libdir</code> can also be specified on the <code>make install</code> command line (at least for GNU <code>make</code>).</p>
<p>The <code>configure</code> or <code>make</code> variables <code>rdocdir</code> and <code>rsharedir</code> can be used to install the system-independent <code>doc</code> and <code>share</code> directories to somewhere other than <code>libdir</code>. The C header files can be installed to the value of <code>rincludedir</code>: note that as the headers are not installed into a subdirectory you probably want something like <code>rincludedir=/usr/local/include/R-4.3.0 Under development</code>.</p>
<p>If you want the R home to be something other than <var>libdir</var><code>/R</code>, use <code>rhome</code>: for example</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>make install rhome<span class="ot">=</span><span class="er">/</span>usr<span class="sc">/</span>local<span class="sc">/</span>lib64<span class="sc">/</span>R<span class="dv">-4</span>.<span class="fl">3.0</span> Under development</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>will use a version-specific R home on a non-Debian Linux 64-bit system.</p>
<p>If you have made R as a shared/static library you can install it in your system’s library directory by</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>make prefix<span class="ot">=</span><span class="er">/</span>path<span class="sc">/</span>to<span class="sc">/</span>here install<span class="sc">-</span>libR</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="page-columns page-full"><p>where <code>prefix</code> is optional, and <code>libdir</code> will give more precise control.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> However, you should not install to a directory mentioned in <code>LDPATHS</code> (e.g.&nbsp;<code>/usr/local/lib64</code>) if you intend to work with multiple versions of R, since that directory may be given precedence over the <code>lib</code> directory of other R installations.</p><div class="no-row-height column-margin column-container"><li id="fn6" role="doc-endnote"><p><sup>6</sup>&nbsp;This will be needed if more than one sub-architecture is to be installed.</p></li></div></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>make install<span class="sc">-</span>strip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>will install stripped executables, and on platforms where this is supported, stripped libraries in directories <code>lib</code> and <code>modules</code> and in the standard packages.</p>
<p>Note that installing R into a directory whose path contains spaces is not supported, and some aspects (such as installing source packages) will not work.</p>
<p>To install info and PDF versions of the manuals, use one or both of</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>make install<span class="sc">-</span>info</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>make install<span class="sc">-</span>pdf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Once again, it is optional to specify <code>prefix</code>, <code>libdir</code> or <code>rhome</code> (the PDF manuals are installed under the R home directory).</p>
<p>More precise control is possible. For info, the setting used is that of <code>infodir</code> (default <var>prefix</var><code>/info</code>, set by configure option <code>--infodir</code>). The PDF files are installed into the R <code>doc</code> tree, set by the <code>make</code> variable <code>rdocdir</code>.</p>
<p>A staged installation is possible, that it is installing R into a temporary directory in order to move the installed tree to its final destination. In this case <code>prefix</code> (and so on) should reflect the final destination, and <code>DESTDIR</code> should be used: see <a href="https://www.gnu.org/prep/standards/html_node/DESTDIR.html" class="uri">https://www.gnu.org/prep/standards/html_node/DESTDIR.html</a>.</p>
<p>You can optionally install the run-time tests that are part of <code>make check-all</code> by</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>make install<span class="sc">-</span>tests</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>which populates a <code>tests</code> directory in the installation.</p>
</section>
<section id="uninstallation" class="level2 section" data-number="2.5">
<h2 class="section anchored" data-number="2.5" data-anchor-id="uninstallation"><span class="header-section-number">2.5</span> Uninstallation</h2>
<p>You can uninstall R by</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>make uninstall</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>optionally specifying <code>prefix</code> etc in the same way as specified for installation.</p>
<p>This will also uninstall any installed manuals. There are specific targets to uninstall info and PDF manuals in file <code>doc/manual/Makefile</code>.</p>
<p>Target <code>uninstall-tests</code> will uninstall any installed tests, as well as removing the directory <code>tests</code> containing the test results.</p>
<p>An installed shared/static <code>libR</code> can be uninstalled by</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>make prefix<span class="ot">=</span><span class="er">/</span>path<span class="sc">/</span>to<span class="sc">/</span>here uninstall<span class="sc">-</span>libR</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="sub-architectures" class="level2 section page-columns page-full" data-number="2.6">
<h2 class="section anchored" data-number="2.6" data-anchor-id="sub-architectures"><span class="header-section-number">2.6</span> Sub-architectures</h2>
<p>Some platforms can support closely related builds of R which can share all but the executables and dynamic objects. Examples include builds under Linux for different CPUs or 32- and 64-bit builds.</p>
<p>R supports the idea of architecture-specific builds, specified by adding <var>r_arch=``name</var>’ to the <code>configure</code> line. Here <var>name</var> can be anything non-empty, and is used to name subdirectories of <code>lib</code>, <code>etc</code>, <code>include</code> and the package <code>libs</code> subdirectories. Example names from other software are the use of <code>sparcv9</code> on Sparc Solaris and <code>32</code> by <code>gcc</code> on <code>x86_64</code> Linux.</p>
<p>If you have two or more such builds you can install them over each other (and for 32/64-bit builds on one architecture, one build can be done without <code>r_arch</code>). The space savings can be considerable: on <code>x86_64</code> Linux a basic install (without debugging symbols) took 74Mb, and adding a 32-bit build added 6Mb. If you have installed multiple builds you can select which build to run by</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>R <span class="sc">--</span>arch<span class="ot">=</span>name</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and just running <code>R</code> will run the last build that was installed.</p>
<p><code>R CMD INSTALL</code> will detect if more than one build is installed and try to install packages with the appropriate library objects for each. This will not be done if the package has an executable <code>configure</code> script or a <code>src/Makefile</code> file. In such cases you can install for extra builds by</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>R <span class="sc">--</span>arch<span class="ot">=</span>name CMD INSTALL <span class="sc">--</span>libs<span class="sc">-</span>only pkg1 pkg2 …</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If you want to mix sub-architectures compiled on different platforms (for example <code>x86_64</code> Linux and <code>i686</code> Linux), it is wise to use explicit names for each, and you may also need to set <code>libdir</code> to ensure that they install into the same place.</p>
<p>When sub-architectures are used the version of <code>Rscript</code> in e.g. <code>/usr/bin</code> will be the last installed, but architecture-specific versions will be available in e.g. <var>/usr/lib64/R/bin/exec${``R_ARCH</var><code>}</code>. Normally all installed architectures will run on the platform so the architecture of <code>Rscript</code> itself does not matter. The executable <code>Rscript</code> will run the <code>R</code> script, and at that time the setting of the <code>R_ARCH</code> environment variable determines the architecture which is run.</p>
<p>When running post-install tests with sub-architectures, use</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>R <span class="sc">--</span>arch<span class="ot">=</span>name CMD make check[<span class="sc">-</span>devel<span class="sc">|</span>all]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>to select a sub-architecture to check.</p>
<div class="page-columns page-full"><p>Sub-architectures are also used on Windows, but by selecting executables within the appropriate <code>bin</code> directory, <var>R_HOME</var><code>/bin/x64</code>. For backwards compatibility there are executables <var>R_HOME</var><code>/bin/R.exe</code> and <var>R_HOME</var><code>/bin/Rscript.exe</code>: these will run an executable from one of the subdirectories, which one being taken first from the <code>R_ARCH</code> environment variable, then from the <code>--arch</code> command-line option<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> and finally from the installation default (which is 32-bit for a combined 32/64 bit R installation). R 4.2.0 follows the scheme, but supports and includes only 64-bit builds.</p><div class="no-row-height column-margin column-container"><li id="fn7" role="doc-endnote"><p><sup>7</sup>&nbsp;with possible values <code>i386</code>, <code>x64</code>, <code>32</code> and <code>64</code>.</p></li></div></div>
<section id="multilib" class="level3 subsection page-columns page-full" data-number="2.6.1">
<h3 class="subsection anchored" data-number="2.6.1" data-anchor-id="multilib"><span class="header-section-number">2.6.1</span> Multilib</h3>
<div class="page-columns page-full"><p>For some Linux distributions<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a>, there is an alternative mechanism for mixing 32-bit and 64-bit libraries known as <em>multilib</em>. If the Linux distribution supports multilib, then parallel builds of R may be installed in the sub-directories <code>lib</code> (32-bit) and <code>lib64</code> (64-bit). The build to be run may then be selected using the <code>setarch</code> command. For example, a 32-bit build may be run by</p><div class="no-row-height column-margin column-container"><li id="fn8" role="doc-endnote"><p><sup>8</sup>&nbsp;mainly on RedHat and Fedora, whose layout is described here.</p></li></div></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>setarch i686 R</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The <code>setarch</code> command is only operational if both 32-bit and 64-bit builds are installed. If there is only one installation of R, then this will always be run regardless of the architecture specified by the <code>setarch</code> command.</p>
<p>There can be problems with installing packages on the non-native architecture. It is a good idea to run e.g.&nbsp;<code>setarch i686 R</code> for sessions in which packages are to be installed, even if that is the only version of R installed (since this tells the package installation code the architecture needed).</p>
<p>There is a potential problem with packages using Java, as the post-install for a <code>i686</code> RPM on <code>x86_64</code> Linux reconfigures Java and will find the <code>x86_64</code> Java. If you know where a 32-bit Java is installed you may be able to run (as root)</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">JAVA_HOME</span><span class="op">=&lt;</span>path to jre directory of 32-bit Java<span class="op">&gt;</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="ex">setarch</span> i686 R CMD javareconf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>to get a suitable setting.</p>
<p>When this mechanism is used, the version of <code>Rscript</code> in e.g. <code>/usr/bin</code> will be the last installed, but an architecture-specific version will be available in e.g. <code>/usr/lib64/R/bin</code>. Normally all installed architectures will run on the platform so the architecture of <code>Rscript</code> does not matter.</p>
</section>
</section>
<section id="other-options" class="level2 section page-columns page-full" data-number="2.7">
<h2 class="section anchored" data-number="2.7" data-anchor-id="other-options"><span class="header-section-number">2.7</span> Other Options</h2>
<p>There are many other installation options, most of which are listed by <code>configure --help</code>. Almost all of those not listed elsewhere in this manual are either standard <code>autoconf</code> options not relevant to R or intended for specialist uses by the R developers.</p>
<p>One that may be useful when working on R itself is the option <code>--disable-byte-compiled-packages</code>, which ensures that the base and recommended packages are not byte-compiled. (Alternatively the (make or environment) variable <code>R_NO_BASE_COMPILE</code> can be set to a non-empty value for the duration of the build.)</p>
<div class="page-columns page-full"><p>Option <code>--with-internal-tzcode</code> makes use of R’s own code and copy of the IANA database for managing timezones. This will be preferred where there are issues with the system implementation, usually involving times after 2037 or before 1916. An alternative time-zone directory<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a> can be used, pointed to by environment variable <code>TZDIR</code>: this should contain files such as <code>Europe/London</code>. On all tested OSes the system timezone was deduced correctly, but if necessary it can be set as the value of environment variable <code>TZ</code>.</p><div class="no-row-height column-margin column-container"><li id="fn9" role="doc-endnote"><p><sup>9</sup>&nbsp;How to prepare such a directory is described in file <code>src/extra/tzone/Notes</code> in the R sources.</p></li></div></div>
<div class="page-columns page-full"><p>Options <code>--with-internal-iswxxxxx</code>, <code>--with-internal-towlower</code> and <code>--with-internal-wcwidth</code> were introduced in R 4.1.0. These control the replacement of the system wide-character classification (such as <code>iswprint</code>), case-changing (<code>wctrans</code>) and width (<code>wcwidth</code> and <code>wcswidth</code>) functions by ones contained in the R sources. Replacement of the classification functions has been done for many years on macOS and AIX (and Windows): option <code>--with-internal-iswxxxxx</code> allows this to be suppressed on those platforms or used on others. Replacing the case-changing functions was new in R 4.1.0 and the default on macOS (and on Windows since R 4.2.0). Replacement of the width functions has also been done for many years and remains the default. These options will only matter to those working with non-ASCII character data, especially in languages written in a non-Western script<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a> (which includes ‘symbols’ such as emoji). Note that one of those <code>iswxxxxx</code> is <code>iswprint</code> which is used to decide whether to output a character as a glyph or as a <code>\U{xxxxxx}</code> escape—for example, try <code>"\U1f600"</code>, an emoji. The width functions are of most importance in East Asian locale: their values differ between such locales. (Replacing the system functions provides a degree of plaform-independence (including to OS updates) but replaces it with a dependence on the R version.)</p><div class="no-row-height column-margin column-container"><li id="fn10" role="doc-endnote"><p><sup>10</sup>&nbsp;But on Windows problems have been seen with case-changing functions on accented Latin-1 characters.</p></li></div></div>
<section id="debugging-symbols" class="level3 subsection" data-number="2.7.1">
<h3 class="subsection anchored" data-number="2.7.1" data-anchor-id="debugging-symbols"><span class="header-section-number">2.7.1</span> Debugging Symbols</h3>
<p>By default, <code>configure</code> adds a flag (usually <code>-g</code>) to the compilation flags for C, Fortran and CXX sources. This will slow down compilation and increase object sizes of both R and packages, so it may be a good idea to change those flags (set <code>CFLAGS</code> etc in <code>config.site</code> before configuring, or edit files <code>Makeconf</code> and <code>etc/Makeconf</code> between running <code>configure</code> and <code>make</code>).</p>
<p>Having debugging symbols available is useful both when running R under a debugger (e.g., <code>R -d gdb</code>) and when using sanitizers and <code>valgrind</code>, all things intended for experts.</p>
<p>Debugging symbols (and some others) can be ‘stripped’ on installation by using</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>make install<span class="sc">-</span>strip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>How well this is supported depends on the platform: it works best on those using GNU <code>binutils</code>. On <code>x86_64</code> Linux a typical reduction in overall size was from 92MB to 66MB. On macOS debugging symbols are not by default included in <code>.dylib</code> and <code>.so</code> files, so there is negligible difference.</p>
</section>
<section id="openmp-support" class="level3 subsection page-columns page-full" data-number="2.7.2">
<h3 class="subsection anchored" data-number="2.7.2" data-anchor-id="openmp-support"><span class="header-section-number">2.7.2</span> OpenMP Support</h3>
<div class="page-columns page-full"><p>By default <code>configure</code> searches for suitable flags<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a> for OpenMP support for the C, C++ (default standard) and Fortran compilers.</p><div class="no-row-height column-margin column-container"><li id="fn11" role="doc-endnote"><p><sup>11</sup>&nbsp;for example, <code>-fopenmp</code>, <code>-xopenmp</code> or <code>-qopenmp</code>. This includes for <code>clang</code> and the Intel and Oracle compilers.</p></li></div></div>
<p>Only the C result is currently used for R itself, and only if <code>MAIN_LD</code>/<code>DYLIB_LD</code> were not specified. This can be overridden by specifying</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>R_OPENMP_CFLAGS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Use for packages has similar restrictions (involving <code>SHLIB_LD</code> and similar: note that as Fortran code is by default linked by the C (or C++) compiler, both need to support OpenMP) and can be overridden by specifying some of</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode makefile code-with-copy"><code class="sourceCode makefile"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>SHLIB_OPENMP_CFLAGS</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>SHLIB_OPENMP_CXXFLAGS</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>SHLIB_OPENMP_FFLAGS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="page-columns page-full"><p>Setting these to an empty value will disable OpenMP for that compiler (and configuring with <code>--disable-openmp</code> will disable all detection<a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a> of OpenMP). The <code>configure</code> detection test is to compile and link a standalone OpenMP program, which is not the same as compiling a shared object and loading it into the C program of R’s executable. Note that overridden values are not tested.</p><div class="no-row-height column-margin column-container"><li id="fn12" role="doc-endnote"><p><sup>12</sup>&nbsp;This does not necessarily disable <em>use</em> of OpenMP – the <code>configure</code> code allows for platforms where OpenMP is used without a flag. For the <code>flang</code> compiler in late 2017, the Fortran runtime always used OpenMP.</p></li></div></div>
</section>
<section id="c-support" class="level3 subsection page-columns page-full" data-number="2.7.3">
<h3 class="subsection anchored" data-number="2.7.3" data-anchor-id="c-support"><span class="header-section-number">2.7.3</span> C++ Support</h3>
<p>C++ is not used by R itself, but support is provided for installing packages with C++ code via <code>make</code> macros defined in file <code>etc/Makeconf</code> (and with explanations in file <code>config.site</code>):</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode makefile code-with-copy"><code class="sourceCode makefile"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>CXX</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>CXXFLAGS</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>CXXPICFLAGS</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>CXXSTD</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>CXX11</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>CXX11STD</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>CXX11FLAGS</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>CXX11PICFLAGS</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>CXX14</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>CXX14STD</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>CXX14FLAGS</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>CXX14PICFLAGS</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>CXX17</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>CXX17STD</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>CXX17FLAGS</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>CXX17PICFLAGS</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>CXX20</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>CXX20STD</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>CXX20FLAGS</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>CXX20PICFLAGS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="page-columns page-full"><p>The macros <code>CXX</code> etc are those used by default for C++ code. <code>configure</code> will attempt to set the rest suitably, choosing for <code>CXXSTD</code> and <code>CXX11STD</code> a suitable flag such as <code>-std=c++11</code> for C++11 support (which is required if C++ is to be supported at all). Similarly, <code>configure</code> will if possible choose for <code>CXX14STD</code> a flag<a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a> such as <code>-std=c++14</code> for C++14 support, <code>-std=c++17</code> or <code>-std=c++1z</code> for support for C++17 and <code>-std=c++20</code> or <code>-std=c++2a</code> for support for C++20. The inferred values can be overridden in file <code>config.site</code> or on the <code>configure</code> command line: user-supplied values will be tested by compiling some C++11/14/17/20 code.</p><div class="no-row-height column-margin column-container"><li id="fn13" role="doc-endnote"><p><sup>13</sup>&nbsp;This was a valid option for <code>g++</code> 5 and later and 2016 versions of the Intel and Solaris compilers. For earlier versions of <code>g++</code> one could try <code>-std=c++1y</code>.</p></li></div></div>
<p>It may be that there is no suitable flag for C++14/17/20 support with the default compiler, in which case a different compiler could be selected for <code>CXX14</code> or <code>CXX17</code> or <code>CXX20</code> with its corresponding flags.</p>
<p>The <code>-std</code> flag is supported by the GCC, <code>clang++</code> and Intel compilers. Currently accepted values are (plus some synonyms)</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>g<span class="sc">++</span><span class="er">:</span>     c<span class="sc">++</span><span class="dv">11</span> gnu<span class="sc">+</span><span class="dv">11</span> c<span class="sc">++</span><span class="dv">14</span> gnu<span class="sc">++</span><span class="dv">14</span> c<span class="sc">++</span><span class="dv">17</span> gnu<span class="sc">++</span><span class="dv">17</span> c<span class="sc">++</span>2a gnu<span class="sc">++</span>2a (from <span class="dv">8</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>         c<span class="sc">++</span><span class="dv">20</span> gnu<span class="sc">++</span><span class="dv">20</span> (from <span class="dv">10</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>Intel<span class="sc">:</span>   c<span class="sc">++</span><span class="dv">11</span> c<span class="sc">++</span><span class="dv">14</span> (from <span class="fl">16.0</span>) c<span class="sc">++</span><span class="dv">17</span> (from <span class="fl">17.0</span>) c<span class="sc">++</span><span class="dv">20</span> (from <span class="fl">19.0</span>?)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>(Those for <code>clang++</code> are documented at <a href="https://clang.llvm.org/cxx_status.html" class="uri">https://clang.llvm.org/cxx_status.html</a>, and follow <code>g++</code>: <code>-std=c++20</code> is supported from Clang 10.)</p>
<p>‘Standards’ for <code>g++</code> starting with <code>gnu</code> enable ‘GNU extensions’: what those are is hard to track down.</p>
<p>For the use of C++11 and later in R packages see the ‘Writing R Extensions’ manual. Prior to R 3.6.0 the default C++ standard was that of the compiler used: currently it is C++14 (if available): this can be overridden by setting <code>CXXSTD</code> when R is configured.</p>
<p><a href="https://en.cppreference.com/w/cpp/compiler_support" class="uri">https://en.cppreference.com/w/cpp/compiler_support</a> indicates which versions of common compilers support (parts of) which C++ standards.</p>
</section>
<section id="link-time-optimization" class="level3 subsection page-columns page-full" data-number="2.7.4">
<h3 class="subsection anchored" data-number="2.7.4" data-anchor-id="link-time-optimization"><span class="header-section-number">2.7.4</span> Link-Time Optimization</h3>
<div class="page-columns page-full"><p>There is support for using link-time optimization (LTO) if the toolchain supports it: configure with flag <code>--enable-lto</code>. When LTO is enabled it is used for compiled code in add-on packages unless the flag <code>--enable-lto=R</code> is used<a href="#fn14" class="footnote-ref" id="fnref14" role="doc-noteref"><sup>14</sup></a>.</p><div class="no-row-height column-margin column-container"><li id="fn14" role="doc-endnote"><p><sup>14</sup>&nbsp;Then recommended packages installed as part of the R installation do use LTO, but not packages installed later.</p></li></div></div>
<div class="page-columns page-full"><p>The main benefit seen to date from LTO has been detecting long-standing bugs in the ways packages pass arguments to compiled code and between compilation units. Benchmarking in 2020 with <code>gcc</code>/<code>gfortran</code>&nbsp;10 showed gains of a few percent in increased performance and reduction in installed size for builds without debug symbols, but large size reductions for some packages<a href="#fn15" class="footnote-ref" id="fnref15" role="doc-noteref"><sup>15</sup></a> with debug symbols. (Performance and size gains are said to be most often seen in complex C++ builds.)</p><div class="no-row-height column-margin column-container"><li id="fn15" role="doc-endnote"><p><sup>15</sup>&nbsp;A complete CRAN installation reduced from 50 to 35GB.</p></li></div></div>
<div class="page-columns page-full"><p>Whether toolchains support LTO is often unclear: all of the C compiler, the Fortran compiler<a href="#fn16" class="footnote-ref" id="fnref16" role="doc-noteref"><sup>16</sup></a> and linker have to support it, and support it by the same mechanism (so mixing compiler families may not work and a non-default linker may be needed). It has been supported by the GCC and LLVM projects for some years with diverging implementations.</p><div class="no-row-height column-margin column-container"><li id="fn16" role="doc-endnote"><p><sup>16</sup>&nbsp;although there is the possibility to exclude Fortran but that misses some of the benefits.</p></li></div></div>
<p>LTO support was added in 2011 for GCC&nbsp;4.5 on Linux but was little used before 2019: compiler support has steadily improved over those years and <code>--enable-lto=R</code> is nowadays used for some routine CRAN checking.</p>
<p>Unfortunately <code>--enable-lto</code> may be accepted but silently do nothing useful if some of the toolchain does not support LTO: this is less common than it once was.</p>
<p>Various macros can be set in file <code>config.site</code> to customize how LTO is used. If the Fortran compiler is not of the same family as the C/C++ compilers, set macro <code>LTO_FC</code> (probably to empty). Macro <code>LTO_LD</code> can be used to select an alternative linker should that be needed.</p>
</section>
<section id="lto-with-gcc" class="level3 subsubsection page-columns page-full" data-number="2.7.5">
<h3 class="subsubsection anchored" data-number="2.7.5" data-anchor-id="lto-with-gcc"><span class="header-section-number">2.7.5</span> LTO with GCC</h3>
<p>This has been tested on Linux with <code>gcc</code>/<code>gfortran</code>&nbsp;8 and later: that needed setting (e.g.&nbsp;in <code>config.site</code>)</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>AR<span class="ot">=</span>gcc<span class="sc">-</span>ar</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>RANLIB<span class="ot">=</span>gcc<span class="sc">-</span>ranlib</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For non-system compilers or if those wrappers have not been installed one may need something like</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>AR<span class="ot">=</span><span class="st">"ar --plugin=/path/to/liblto_plugin.so"</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>RANLIB<span class="ot">=</span><span class="st">"ranlib --plugin=/path/to/liblto_plugin.so"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="page-columns page-full"><p>amd <code>NM</code> may be needed to be set analogously. (If using an LTO-enabled build to check packages, set environment variable <code>UserNM</code><a href="#fn17" class="footnote-ref" id="fnref17" role="doc-noteref"><sup>17</sup></a> to <code>gcc-nm</code>.)</p><div class="no-row-height column-margin column-container"><li id="fn17" role="doc-endnote"><p><sup>17</sup>&nbsp;not <code>NM</code> as we found <code>make</code> overriding that.</p></li></div></div>
<p>With GCC 5 and later it is possible to parallelize parts of the LTO linking process: set the make macro <code>LTO</code> to something like <code>LTO=-flto=8</code> (to use 8 threads), for example in file <code>config.site</code>.</p>
<p>Under some circumstances and for a few packages, the PIC flags have needed overriding on Linux with GCC 9 and later: e.g use in <code>config.site</code>:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode makefile code-with-copy"><code class="sourceCode makefile"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="dt">CPICFLAGS</span><span class="ch">=</span><span class="st">-fPIC</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="dt">CXXPICFLAGS</span><span class="ch">=</span><span class="st">-fPIC</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="dt">CXX11PICFLAGS</span><span class="ch">=</span><span class="st">-fPIC</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="dt">CXX14PICFLAGS</span><span class="ch">=</span><span class="st">-fPIC</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="dt">CXX17PICFLAGS</span><span class="ch">=</span><span class="st">-fPIC</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="dt">CXX20PICFLAGS</span><span class="ch">=</span><span class="st">-fPIC</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="dt">FPICFLAGS</span><span class="ch">=</span><span class="st">-fPIC</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>We suggest only using these if the problem is encountered (it was not seen on CRAN with GCC 10 at the time of writing).</p>
<p>Note that R may need to be re-compiled after even a minor update to the compiler (e.g.&nbsp;from 10.1 to 10.2) but this may not be clear from confused compiler messages.</p>
</section>
<section id="lto-with-llvm" class="level3 subsubsection" data-number="2.7.6">
<h3 class="subsubsection anchored" data-number="2.7.6" data-anchor-id="lto-with-llvm"><span class="header-section-number">2.7.6</span> LTO with LLVM</h3>
<p>LLVM supports another type of LTO called ‘Thin LTO’ as well as a similar implementation to GCC, sometimes called ‘Full LTO’. (See <a href="https://clang.llvm.org/docs/ThinLTO.html" class="uri">https://clang.llvm.org/docs/ThinLTO.html</a>.) Currently the only LLVM compiler relevant to R is <code>clang</code> for which this can be selected by setting macro <code>LTO=-flto=thin</code>. LLVM has</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>AR<span class="ot">=</span>llvm<span class="sc">-</span>ar</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>RANLIB<span class="ot">=</span>llvm<span class="sc">-</span>ranlib</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>(but macOS does not, and these are not needed there). Where the linker supports a parallel backend for Thin LTO this can be specified <em>via</em> the macro <code>LTO_LD</code>: see the URL above for per-linker settings and further linking optimizations.)</p>
<p>For example, on macOS one might use</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>LTO<span class="ot">=</span><span class="sc">-</span>flto<span class="ot">=</span>thin</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>LTO_FC<span class="ot">=</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>LTO_LD<span class="ot">=</span><span class="sc">-</span>Wl,<span class="sc">-</span>mllvm,<span class="sc">-</span>threads<span class="ot">=</span><span class="dv">4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>to use Thin LTO with 4 threads for C/C++ code, but skip LTO for Fortran code compiled with <code>gfortran</code>.</p>
<p>It is said to be particularly beneficial to use <code>-O3</code> for <code>clang</code> in conjunction with LTO.</p>
</section>
<section id="lto-for-package-checking" class="level3 subsubsection page-columns page-full" data-number="2.7.7">
<h3 class="subsubsection anchored" data-number="2.7.7" data-anchor-id="lto-for-package-checking"><span class="header-section-number">2.7.7</span> LTO for package checking</h3>
<p>LTO effectively compiles all the source code in a package as a single compilation unit and so allows the compiler (with sufficient diagnostic flags such as <code>-Wall</code>) to check consistency between what are normally separate compilation units.</p>
<div class="page-columns page-full"><p>With <code>gcc</code>/<code>gfortran</code> 9.x and later<a href="#fn18" class="footnote-ref" id="fnref18" role="doc-noteref"><sup>18</sup></a> LTO will flag inconsistencies in calls to Fortran subroutines/functions, both between Fortran source files and between Fortran and C/C++. <code>gfortran</code> 8.4, 9.2 and later can help understanding these by extracting C prototypes from Fortran source files with option <code>-fc-prototypes-external</code>, e.g.&nbsp;that (at the time of writing) Fortran <code>LOGICAL</code> corresponds to <code>int_least32_t *</code> in C.</p><div class="no-row-height column-margin column-container"><li id="fn18" role="doc-endnote"><p><sup>18</sup>&nbsp;probably also 8.4 and later.</p></li></div></div>
<p>On some systems it is possible to build the BLAS, LINPACK and LAPACK support as static libraries containing intermediate-level code that LTO will compile for all objects linked against these libraries, by configuring R with <code>--enable-lto=check</code>. This checks the consistency of calls to BLAS/LINPACK/LAPACK in any packages installed using the build. <strong>NB:</strong> as its name suggests, this option is intended only for checking installation of R and packages: it includes these library routines (those called directly and all they depend on) in each package. This is unlikely to work in conjunction with non-default options for BLAS and LAPACK, and ‘linking’ against these libraries may be very slow.</p>
</section>
</section>
<section id="testing-an-installation" class="level2 section" data-number="2.8">
<h2 class="section anchored" data-number="2.8" data-anchor-id="testing-an-installation"><span class="header-section-number">2.8</span> Testing an Installation</h2>
<p>Full post-installation testing is possible only if the test files have been installed with</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>make install<span class="sc">-</span>tests</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>which populates a <code>tests</code> directory in the installation.</p>
<p>If this has been done, two testing routes are available. The first is to move to the home directory of the R installation (as given by <code>R RHOME</code> or from R as <code>R.home()</code>) and run</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> tests</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co">## followed by one of</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="ex">../bin/R</span> CMD make check</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="ex">../bin/R</span> CMD make check-devel</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="ex">../bin/R</span> CMD make check-all</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and other useful targets are <code>test-BasePackages</code> and <code>test-Recommended</code> to run tests of the standard and recommended packages (if installed) respectively.</p>
<p>This re-runs all the tests relevant to the installed R (including for example the code in the package vignettes), but not for example the ones checking the example code in the manuals nor making the standalone Rmath library. This can occasionally be useful when the operating environment has been changed, for example by OS updates or by substituting the BLAS (see <a href="Essential-and-useful-other-programs-under-a-Unix-alike.html#shared-blas">Shared BLAS</a>).</p>
<p>Parallel checking of packages may be possible: set the environment variable <code>TEST_MC_CORES</code> to the maximum number of processes to be run in parallel. This affects both checking the package examples (part of <code>make check</code>) and package sources (part of <code>make check-devel</code> and <code>make check-recommended</code>). It does require a <code>make</code> command which supports the <var>make -j ``n</var> option: most do.</p>
<p>Alternatively, the installed R can be run, preferably with <code>--vanilla</code>. Then</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>pdf("tests.pdf") ## optional, but prevents flashing graphics windows</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>Sys.setenv(LC_COLLATE = "C", LC_TIME = "C", LANGUAGE = "en")</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>tools::testInstalledBasic("both")</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>tools::testInstalledPackages(scope = "base")</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>tools::testInstalledPackages(scope = "recommended")</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>runs the basic tests and then all the tests on the standard and recommended packages. These tests can be run from anywhere: the basic tests write their results in the <code>tests</code> folder of the R home directory and run fewer tests than the first approach: in particular they do not test things which need Internet access—that can be tested by</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>tools<span class="op">::</span>testInstalledBasic<span class="op">(</span><span class="st">"internet"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>It is possible to test the installed packages (but not their package-specific tests) by <code>testInstalledPackages</code> even if <code>make install-tests</code> was not run. The outputs are written under the current directory unless a different one is specified by <code>outDir</code>.</p>
<p>Note that the results may depend on the language set for times and messages: for maximal similarity to reference results you may want to try setting (before starting the R session)</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>LANGUAGE<span class="ot">=</span>en</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and use a UTF-8 or Latin-1 locale.</p>


</section>


</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Obtaining-R.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Obtaining R</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Installing-R-under-Windows.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Installing R under Windows</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">A re-styled version of the original R manuals at <a href="https://cran.r-project.org/manuals.html" class="uri">https://cran.r-project.org/manuals.html</a></div>   
    <div class="nav-footer-right">Built using <a href="https://quarto.org">Quarto</a></div>
  </div>
</footer>



</body></html>
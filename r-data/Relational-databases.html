<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4&nbsp; Relational databases – R Manuals :: R Data Import/Export ¶</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Binary-files.html" rel="next">
<link href="./Importing-from-other-statistical-systems.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-a3a19fe14a07cca10d92c437965ca696.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">R Manuals :: R Data Import/Export ¶</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-manuals" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Manuals</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-manuals">    
        <li>
    <a class="dropdown-item" href="./../r-intro/index.html">
 <span class="dropdown-text">An Introduction to R ¶</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./../r-data/index.html">
 <span class="dropdown-text">R Data Import/Export ¶</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./../r-admin/index.html">
 <span class="dropdown-text">R Installation and Administration ¶</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./../r-exts/index.html">
 <span class="dropdown-text">Writing R Extensions ¶</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./../r-lang/index.html">
 <span class="dropdown-text">R Language Definition ¶</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./../r-ints/index.html">
 <span class="dropdown-text">R Internals ¶</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Relational-databases.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Relational databases</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Top (R Data Import/Export)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Acknowledgements.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Acknowledgements</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Spreadsheet-like-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Spreadsheet-like data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Importing-from-other-statistical-systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Importing from other statistical systems</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Relational-databases.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Relational databases</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Binary-files.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Binary files</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Image-files.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Image files</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Connections.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Connections</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Network-interfaces.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Network interfaces</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Reading-Excel-spreadsheets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Reading Excel spreadsheets</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./References.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Function-and-variable-index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Function and variable index</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Concept-index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Concept index</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#why-use-a-database" id="toc-why-use-a-database" class="nav-link active" data-scroll-target="#why-use-a-database"><span class="header-section-number">4.1</span> Why use a database?</a></li>
  <li><a href="#overview-of-rdbmss" id="toc-overview-of-rdbmss" class="nav-link" data-scroll-target="#overview-of-rdbmss"><span class="header-section-number">4.2</span> Overview of RDBMSs</a>
  <ul class="collapse">
  <li><a href="#sql-queries" id="toc-sql-queries" class="nav-link" data-scroll-target="#sql-queries"><span class="header-section-number">4.2.1</span> SQL queries</a></li>
  <li><a href="#data-types" id="toc-data-types" class="nav-link" data-scroll-target="#data-types"><span class="header-section-number">4.2.2</span> Data types</a></li>
  </ul></li>
  <li><a href="#r-interface-packages" id="toc-r-interface-packages" class="nav-link" data-scroll-target="#r-interface-packages"><span class="header-section-number">4.3</span> R interface packages</a>
  <ul class="collapse">
  <li><a href="#packages-using-dbi" id="toc-packages-using-dbi" class="nav-link" data-scroll-target="#packages-using-dbi"><span class="header-section-number">4.3.1</span> Packages using DBI</a></li>
  <li><a href="#package-rodbc" id="toc-package-rodbc" class="nav-link" data-scroll-target="#package-rodbc"><span class="header-section-number">4.3.2</span> Package <strong>RODBC</strong></a></li>
  <li><a href="#footnotes" id="toc-footnotes" class="nav-link" data-scroll-target="#footnotes"><span class="header-section-number">4.3.3</span> Footnotes</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Relational databases</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Next: <a href="Binary-files.html#binary-files" accesskey="n" rel="next">Binary files</a>, Previous: <a href="Importing-from-other-statistical-systems.html#importing-from-other-statistical-systems" accesskey="p" rel="prev">Importing from other statistical systems</a>, Up: <a href="index.html" accesskey="u" rel="up">R Data Import/Export</a> &nbsp; [<a href="index.html#sec_contents" rel="contents" title="Table of contents">Contents</a>][<a href="Function-and-variable-index.html" rel="index" title="Index">Index</a>]</p>
<p><span id="index-Relational-databases" class="index-entry-id"></span> <span id="index-DBMS" class="index-entry-id"></span></p>
<section id="why-use-a-database" class="level2 section" data-number="4.1">
<h2 class="section anchored" data-number="4.1" data-anchor-id="why-use-a-database"><span class="header-section-number">4.1</span> Why use a database?</h2>
<p>There are limitations on the types of data that R handles well. Since all data being manipulated by R are resident in memory, and several copies of the data can be created during execution of a function, R is not well suited to extremely large data sets. Data objects that are more than a (few) hundred megabytes in size can cause R to run out of memory, particularly on a 32-bit operating system.</p>
<p>R does not easily support concurrent access to data. That is, if more than one user is accessing, and perhaps updating, the same data, the changes made by one user will not be visible to the others.</p>
<p>R does support persistence of data, in that you can save a data object or an entire worksheet from one session and restore it at the subsequent session, but the format of the stored data is specific to R and not easily manipulated by other systems.</p>
<p>Database management systems (DBMSs) and, in particular, relational DBMSs (RDBMSs) <em>are</em> designed to do all of these things well. Their strengths are</p>
<ol type="1">
<li>To provide fast access to selected parts of large databases.</li>
<li>Powerful ways to summarize and cross-tabulate columns in databases.</li>
<li>Store data in more organized ways than the rectangular grid model of spreadsheets and R data frames.</li>
<li>Concurrent access from multiple clients running on multiple hosts while enforcing security constraints on access to the data.</li>
<li>Ability to act as a server to a wide range of clients.</li>
</ol>
<p>The sort of statistical applications for which DBMS might be used are to extract a 10% sample of the data, to cross-tabulate data to produce a multi-dimensional contingency table, and to extract data group by group from a database for separate analysis.</p>
<p>Increasingly OSes are themselves making use of DBMSs for these reasons, so it is nowadays likely that one will be already installed on your (non-Windows) OS. <a href="https://en.wikipedia.org/wiki/Akonadi" class="uref">Akonadi</a> is used by KDE4 to store personal information. Several macOS applications, including Mail and Address Book, use SQLite.</p>
</section>
<section id="overview-of-rdbmss" class="level2 section" data-number="4.2">
<h2 class="section anchored" data-number="4.2" data-anchor-id="overview-of-rdbmss"><span class="header-section-number">4.2</span> Overview of RDBMSs</h2>
<p>Traditionally there had been large (and expensive) commercial RDBMSs (<a href="https://www.ibm.com/products/informix" class="uref">Informix</a>; <a href="https://www.oracle.com" class="uref">Oracle</a>; Sybase; <a href="https://www.ibm.com/products/db2" class="uref">IBM’s DB2</a>; <a href="https://www.microsoft.com/sql-server/" class="uref">Microsoft SQL Server</a> on Windows) and academic and small-system databases (such as MySQL<a href="#FOOT4" id="DOCF4" class="footnote"><sup>4</sup></a>, PostgreSQL, Microsoft Access, …), the former marked out by much greater emphasis on data security features. The line is blurring, with MySQL and PostgreSQL having more and more high-end features, and free ‘express’ versions being made available for the commercial DBMSs.</p>
<p><span id="index-ODBC" class="index-entry-id"></span> <span id="index-Open-Database-Connectivity" class="index-entry-id"></span></p>
<p>There are other commonly used data sources, including spreadsheets, non-relational databases and even text files (possibly compressed). Open Database Connectivity (ODBC) is a standard to use all of these data sources. It originated on Windows (see <a href="https://learn.microsoft.com/en-us/sql/odbc/microsoft-open-database-connectivity-odbc" class="uref">https://learn.microsoft.com/en-us/sql/odbc/microsoft-open-database-connectivity-odbc</a>) but is also implemented on Linux/Unix/macOS.</p>
<p>All of the packages described later in this chapter provide clients to client/server databases. The database can reside on the same machine or (more often) remotely. There is an ISO standard (in fact several: SQL92 is ISO/IEC&nbsp;9075, also known as ANSI X3.135-1992, and SQL99 is coming into use) for an interface language called SQL (Structured Query Language, sometimes pronounced ‘sequel’: see Bowman <em>et al.</em> 1996 and Kline and Kline 2001) which these DBMSs support to varying degrees.</p>
<section id="sql-queries" class="level3 subsection" data-number="4.2.1">
<h3 class="subsection anchored" data-number="4.2.1" data-anchor-id="sql-queries"><span class="header-section-number">4.2.1</span> SQL queries</h3>
<p>The more comprehensive R interfaces generate SQL behind the scenes for common operations, but direct use of SQL is needed for complex operations in all. Conventionally SQL is written in upper case, but many users will find it more convenient to use lower case in the R interface functions.</p>
<p>A relational DBMS stores data as a database of <em>tables</em> (or <em>relations</em>) which are rather similar to R data frames, in that they are made up of <em>columns</em> or <em>fields</em> of one type (numeric, character, date, currency, …) and <em>rows</em> or <em>records</em> containing the observations for one entity.</p>
<p>SQL ‘queries’ are quite general operations on a relational database. The classical query is a SELECT statement of the type</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>SELECT State, Murder FROM USArrests WHERE Rape <span class="sc">&gt;</span> <span class="dv">30</span> ORDER BY Murder</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>SELECT t.sch, c.meanses, t.sex, t.achieve</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  FROM student as t, school as c WHERE t.sch <span class="ot">=</span> c.id</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>SELECT sex, <span class="fu">COUNT</span>(<span class="sc">*</span>) FROM student GROUP BY sex</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>SELECT sch, <span class="fu">AVG</span>(sestat) FROM student GROUP BY sch LIMIT <span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The first of these selects two columns from the R data frame <code class="code">USArrests</code> that has been copied across to a database table, subsets on a third column and asks the results be sorted. The second performs a database <em>join</em> on two tables <code class="code">student</code> and <code class="code">school</code> and returns four columns. The third and fourth queries do some cross-tabulation and return counts or averages. (The five aggregation functions are COUNT(*) and SUM, MAX, MIN and AVG, each applied to a single column.)</p>
<p>SELECT queries use FROM to select the table, WHERE to specify a condition for inclusion (or more than one condition separated by AND or OR), and ORDER BY to sort the result. Unlike data frames, rows in RDBMS tables are best thought of as unordered, and without an ORDER BY statement the ordering is indeterminate. You can sort (in lexicographical order) on more than one column by separating them by commas. Placing DESC after an ORDER BY puts the sort in descending order.</p>
<p>SELECT DISTINCT queries will only return one copy of each distinct row in the selected table.</p>
<p>The GROUP BY clause selects subgroups of the rows according to the criterion. If more than one column is specified (separated by commas) then multi-way cross-classifications can be summarized by one of the five aggregation functions. A HAVING clause allows the select to include or exclude groups depending on the aggregated value.</p>
<p>If the SELECT statement contains an ORDER BY statement that produces a unique ordering, a LIMIT clause can be added to select (by number) a contiguous block of output rows. This can be useful to retrieve rows a block at a time. (It may not be reliable unless the ordering is unique, as the LIMIT clause can be used to optimize the query.)</p>
<p>There are queries to create a table (CREATE TABLE, but usually one copies a data frame to the database in these interfaces), INSERT or DELETE or UPDATE data. A table is destroyed by a DROP TABLE ‘query’.</p>
<p>Kline and Kline (2001) discuss the details of the implementation of SQL in Microsoft SQL Server 2000, Oracle, MySQL and PostgreSQL.</p>
</section>
<section id="data-types" class="level3 subsection" data-number="4.2.2">
<h3 class="subsection anchored" data-number="4.2.2" data-anchor-id="data-types"><span class="header-section-number">4.2.2</span> Data types</h3>
<p>Data can be stored in a database in various data types. The range of data types is DBMS-specific, but the SQL standard defines many types, including the following that are widely implemented (often not by the SQL name).</p>
<dl>
<dt><code class="code">float(</code><var class="var">p</var><code class="code">)</code></dt>
<dd>
<p>Real number, with optional precision. Often called <code class="code">real</code> or <code class="code">double</code> or <code class="code">double precision</code>.</p>
</dd>
<dt><code class="code">integer</code></dt>
<dd>
<p>32-bit integer. Often called <code class="code">int</code>.</p>
</dd>
<dt><code class="code">smallint</code></dt>
<dd>
<p>16-bit integer</p>
</dd>
<dt><code class="code">character(</code><var class="var">n</var><code class="code">)</code></dt>
<dd>
<p>fixed-length character string. Often called <code class="code">char</code>.</p>
</dd>
<dt><code class="code">character varying(</code><var class="var">n</var><code class="code">)</code></dt>
<dd>
<p>variable-length character string. Often called <code class="code">varchar</code>. Almost always has a limit of 255 chars.</p>
</dd>
<dt><code class="code">boolean</code></dt>
<dd>
<p>true or false. Sometimes called <code class="code">bool</code> or <code class="code">bit</code>.</p>
</dd>
<dt><code class="code">date</code></dt>
<dd>
<p>calendar date</p>
</dd>
<dt><code class="code">time</code></dt>
<dd>
<p>time of day</p>
</dd>
<dt><code class="code">timestamp</code></dt>
<dd>
<p>date and time</p>
</dd>
</dl>
<p>There are variants on <code class="code">time</code> and <code class="code">timestamp</code>, <code class="code">with timezone</code>. Other types widely implemented are <code class="code">text</code> and <code class="code">blob</code>, for large blocks of text and binary data, respectively.</p>
<p>The more comprehensive of the R interface packages hide the type conversion issues from the user.</p>
</section>
</section>
<section id="r-interface-packages" class="level2 section" data-number="4.3">
<h2 class="section anchored" data-number="4.3" data-anchor-id="r-interface-packages"><span class="header-section-number">4.3</span> R interface packages</h2>
<p>There are several packages available on CRAN to help R communicate with DBMSs. They provide different levels of abstraction. Some provide means to copy whole data frames to and from databases. All have functions to select data within the database via SQL queries, and to retrieve the result as a whole as a data frame or in pieces (usually as groups of rows).</p>
<p>All except <a href="https://CRAN.R-project.org/package=RODBC" class="url"><strong>RODBC</strong></a> are tied to one DBMS, but there has been a proposal for a unified ‘front-end’ package <a href="https://CRAN.R-project.org/package=DBI" class="url"><strong>DBI</strong></a> (<a href="https://developer.r-project.org/db/" class="uref">https://developer.r-project.org/db/</a>) in conjunction with a ‘back-end’, the most developed of which is <a href="https://CRAN.R-project.org/package=RMySQL" class="url"><strong>RMySQL</strong></a>. Also on CRAN are the back-ends <a href="https://CRAN.R-project.org/package=ROracle" class="url"><strong>ROracle</strong></a>, <a href="https://CRAN.R-project.org/package=RPostgreSQL" class="url"><strong>RPostgreSQL</strong></a> and <a href="https://CRAN.R-project.org/package=RSQLite" class="url"><strong>RSQLite</strong></a> (which works with the bundled DBMS <code class="code">SQLite</code>, <a href="https://www.sqlite.org/index.html" class="uref">https://www.sqlite.org/index.html</a>) and <a href="https://CRAN.R-project.org/package=RJDBC" class="url"><strong>RJDBC</strong></a> (which uses Java and can connect to any DBMS that has a JDBC driver).</p>
<p><strong>PL/R</strong> (<a href="https://github.com/postgres-plr/plr" class="uref">https://github.com/postgres-plr/plr</a>) is a project to embed R into PostgreSQL.</p>
<p>Package <a href="https://CRAN.R-project.org/package=RMongo" class="url"><strong>RMongo</strong></a> provides an R interface to a Java client for ‘MongoDB’ (<a href="https://en.wikipedia.org/wiki/MongoDB" class="uref">https://en.wikipedia.org/wiki/MongoDB</a>) databases, which are queried using JavaScript rather than SQL. Package <a href="https://CRAN.R-project.org/package=mongolite" class="url"><strong>mongolite</strong></a> is another client using <strong>mongodb</strong>’s C driver.</p>
<section id="packages-using-dbi" class="level3 subsection" data-number="4.3.1">
<h3 class="subsection anchored" data-number="4.3.1" data-anchor-id="packages-using-dbi"><span class="header-section-number">4.3.1</span> Packages using DBI</h3>
<p>Package <a href="https://CRAN.R-project.org/package=RMySQL" class="url"><strong>RMySQL</strong></a> on CRAN provides an interface to the MySQL database system (see <a href="https://www.mysql.com" class="uref">https://www.mysql.com</a> and Dubois, 2000) or its fork MariaDB (see <a href="https://mariadb.org/" class="uref">https://mariadb.org/</a>). The description here applies to versions <code class="code">0.5-0</code> and later: earlier versions had a substantially different interface. The current version requires the <a href="https://CRAN.R-project.org/package=DBI" class="url"><strong>DBI</strong></a> package, and this description will apply with minor changes to all the other back-ends to <a href="https://CRAN.R-project.org/package=DBI" class="url"><strong>DBI</strong></a>.</p>
<p>MySQL exists on Unix/Linux/macOS and Windows: there is a ‘Community Edition’ released under GPL but commercial licenses are also available. MySQL was originally a ‘light and lean’ database. (It preserves the case of names where the operating file system is case-sensitive, so not on Windows.)</p>
<p>The call <code class="code">dbDriver("MySQL")</code> returns a database connection manager object, and then a call to <code class="code">dbConnect</code> opens a database connection which can subsequently be closed by a call to the generic function <code class="code">dbDisconnect</code>. Use <code class="code">dbDriver("Oracle")</code>, <code class="code">dbDriver("PostgreSQL")</code> or <code class="code">dbDriver("SQLite")</code> with those DBMSs and packages <a href="https://CRAN.R-project.org/package=ROracle" class="url"><strong>ROracle</strong></a>, <a href="https://CRAN.R-project.org/package=RPostgreSQL" class="url"><strong>RPostgreSQL</strong></a> or <a href="https://CRAN.R-project.org/package=RSQLite" class="url"><strong>RSQLite</strong></a> respectively.</p>
<p><span id="index-dbSendQuery" class="index-entry-id"></span> <span id="index-dbClearResult" class="index-entry-id"></span> <span id="index-dbGetQuery" class="index-entry-id"></span></p>
<p>SQL queries can be sent by either <code class="code">dbSendQuery</code> or <code class="code">dbGetQuery</code>. <code class="code">dbGetquery</code> sends the query and retrieves the results as a data frame. <code class="code">dbSendQuery</code> sends the query and returns an object of class inheriting from <code class="code">"DBIResult"</code> which can be used to retrieve the results, and subsequently used in a call to <code class="code">dbClearResult</code> to remove the result.</p>
<p>Function <code class="code">fetch</code> is used to retrieve some or all of the rows in the query result, as a list. The function <code class="code">dbHasCompleted</code> indicates if all the rows have been fetched, and <code class="code">dbGetRowCount</code> returns the number of rows in the result.</p>
<p><span id="index-dbReadTable" class="index-entry-id"></span> <span id="index-dbWriteTable" class="index-entry-id"></span> <span id="index-dbExistsTable" class="index-entry-id"></span></p>
<p>These are convenient interfaces to read/write/test/delete tables in the database. <code class="code">dbReadTable</code> and <code class="code">dbWriteTable</code> copy to and from an R data frame, mapping the row names of the data frame to the field <code class="code">row_names</code> in the <code class="code">MySQL</code> table.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> library<span class="op">(</span>RMySQL<span class="op">)</span> # will load DBI as well</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#</span><span class="er"># open a connection to a MySQL database</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> con <span class="op">&lt;-</span> dbConnect<span class="op">(</span>dbDriver<span class="op">(</span><span class="st">"MySQL"</span><span class="op">),</span> dbname <span class="op">=</span> <span class="st">"test"</span><span class="op">)</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#</span><span class="er"># list the tables in the database</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> dbListTables<span class="op">(</span>con<span class="op">)</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#</span><span class="er"># load a data frame into the database, deleting any existing copy</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> data<span class="op">(</span>USArrests<span class="op">)</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> dbWriteTable<span class="op">(</span>con<span class="op">,</span> <span class="st">"arrests"</span><span class="op">,</span> USArrests<span class="op">,</span> overwrite <span class="op">=</span> TRUE<span class="op">)</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>TRUE</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> dbListTables<span class="op">(</span>con<span class="op">)</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="st">"arrests"</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="pp">#</span><span class="er"># get the whole table</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> dbReadTable<span class="op">(</span>con<span class="op">,</span> <span class="st">"arrests"</span><span class="op">)</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>               Murder Assault UrbanPop Rape</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>Alabama          <span class="fl">13.2</span>     <span class="dv">236</span>       <span class="dv">58</span> <span class="fl">21.2</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>Alaska           <span class="fl">10.0</span>     <span class="dv">263</span>       <span class="dv">48</span> <span class="fl">44.5</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>Arizona           <span class="fl">8.1</span>     <span class="dv">294</span>       <span class="dv">80</span> <span class="fl">31.0</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>Arkansas          <span class="fl">8.8</span>     <span class="dv">190</span>       <span class="dv">50</span> <span class="fl">19.5</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="op">...</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="pp">#</span><span class="er"># Select from the loaded table</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> dbGetQuery<span class="op">(</span>con<span class="op">,</span> paste<span class="op">(</span><span class="st">"select row_names, Murder from arrests"</span><span class="op">,</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"where Rape &gt; 30 order by Murder"</span><span class="op">))</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>   row_names Murder</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>   Colorado    <span class="fl">7.9</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>    Arizona    <span class="fl">8.1</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> California    <span class="fl">9.0</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>     Alaska   <span class="fl">10.0</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> New Mexico   <span class="fl">11.4</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>   Michigan   <span class="fl">12.1</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>     Nevada   <span class="fl">12.2</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>    Florida   <span class="fl">15.4</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> dbRemoveTable<span class="op">(</span>con<span class="op">,</span> <span class="st">"arrests"</span><span class="op">)</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> dbDisconnect<span class="op">(</span>con<span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="package-rodbc" class="level3 subsection" data-number="4.3.2">
<h3 class="subsection anchored" data-number="4.3.2" data-anchor-id="package-rodbc"><span class="header-section-number">4.3.2</span> Package <strong>RODBC</strong></h3>
<p><span id="index-ODBC-1" class="index-entry-id"></span> <span id="index-Open-Database-Connectivity-1" class="index-entry-id"></span></p>
<p>Package <a href="https://CRAN.R-project.org/package=RODBC" class="url"><strong>RODBC</strong></a> on CRAN provides an interface to database sources supporting an ODBC interface. This is very widely available, and allows the same R code to access different database systems. <a href="https://CRAN.R-project.org/package=RODBC" class="url"><strong>RODBC</strong></a> runs on Unix/Linux, Windows and macOS, and almost all database systems provide support for ODBC. We have tested Microsoft SQL Server, Access, MySQL, PostgreSQL, Oracle and IBM DB2 on Windows and MySQL, MariaDB, Oracle, PostgreSQL and SQLite on Linux.</p>
<p>ODBC is a client-server system, and we have happily connected to a DBMS running on a Unix server from a Windows client, and <em>vice versa</em>.</p>
<p>On Windows ODBC support is part of the OS. On Unix/Linux you will need an ODBC Driver Manager such as unixODBC (<a href="https://www.unixodbc.org/" class="uref">https://www.unixodbc.org/</a>) or iODBC (<a href="https://www.iodbc.org/" class="uref">https://www.iodbc.org/</a>: this is pre-installed in macOS) and an installed driver for your database system.</p>
<p>Windows provides drivers not just for DBMSs but also for Excel (<samp class="file">.xls</samp>) spreadsheets, dBase (<samp class="file">.dbf</samp>) files and even text files. (The named applications do <em>not</em> need to be installed. Which file formats are supported depends on the versions of the drivers.) There are versions for Excel and Access 2007/2010 (go to <a href="https://www.microsoft.com/en-us/download" class="uref">https://www.microsoft.com/en-us/download</a>, and search for ‘Office ODBC’, which will lead to <samp class="file">AccessDatabaseEngine.exe</samp>), the ‘2007 Office System Driver’ (the latter has a version for 64-bit Windows, and that will also read earlier versions).</p>
<p>On macOS the Actual Technologies (<a href="https://www.actualtech.com/product_access.php" class="url">https://www.actualtech.com/product_access.php</a>) drivers provide ODBC interfaces to Access databases and to Excel spreadsheets (not including Excel 2007/2010).</p>
<p><span id="index-odbcConnect" class="index-entry-id"></span> <span id="index-odbcDriverConnect" class="index-entry-id"></span> <span id="index-odbcGetInfo" class="index-entry-id"></span></p>
<p>Many simultaneous connections are possible. A connection is opened by a call to <code class="code">odbcConnect</code> or <code class="code">odbcDriverConnect</code> (which on the Windows GUI allows a database to be selected via dialog boxes) which returns a handle used for subsequent access to the database. Printing a connection will provide some details of the ODBC connection, and calling <code class="code">odbcGetInfo</code> will give details on the client and server.</p>
<p>A connection is closed by a call to <code class="code">close</code> or <code class="code">odbcClose</code>, and also (with a warning) when not R object refers to it and at the end of an R session.</p>
<p>Details of the tables on a connection can be found using <code class="code">sqlTables</code>.</p>
<p>Function <code class="code">sqlSave</code> copies an R data frame to a table in the database, and <code class="code">sqlFetch</code> copies a table in the database to an R data frame.</p>
<p><span id="index-odbcQuery" class="index-entry-id"></span> <span id="index-sqlGetResults" class="index-entry-id"></span> <span id="index-sqlFetchMore" class="index-entry-id"></span></p>
<p>An SQL query can be sent to the database by a call to <code class="code">sqlQuery</code>. This returns the result in an R data frame. (<code class="code">sqlCopy</code> sends a query to the database and saves the result as a table in the database.) A finer level of control is attained by first calling <code class="code">odbcQuery</code> and then <code class="code">sqlGetResults</code> to fetch the results. The latter can be used within a loop to retrieve a limited number of rows at a time, as can function <code class="code">sqlFetchMore</code>.</p>
<p>Here is an example using PostgreSQL, for which the ODBC driver maps column and data frame names to lower case. We use a database <code class="code">testdb</code> we created earlier, and had the DSN (data source name) set up in <samp class="file">~/.odbc.ini</samp> under <code class="code">unixODBC</code>. Exactly the same code worked using MyODBC to access a MySQL database under Linux or Windows (where MySQL also maps names to lowercase). Under Windows, DSNs are set up in the ODBC applet in the Control Panel (‘Data Sources (ODBC)’ in the ‘Administrative Tools’ section).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> library<span class="op">(</span>RODBC<span class="op">)</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#</span><span class="er"># tell it to map names to l/case</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> channel <span class="op">&lt;-</span> odbcConnect<span class="op">(</span><span class="st">"testdb"</span><span class="op">,</span> uid<span class="op">=</span><span class="st">"ripley"</span><span class="op">,</span> <span class="cf">case</span><span class="op">=</span><span class="st">"tolower"</span><span class="op">)</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#</span><span class="er"># load a data frame into the database</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> data<span class="op">(</span>USArrests<span class="op">)</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> sqlSave<span class="op">(</span>channel<span class="op">,</span> USArrests<span class="op">,</span> rownames <span class="op">=</span> <span class="st">"state"</span><span class="op">,</span> addPK <span class="op">=</span> TRUE<span class="op">)</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> rm<span class="op">(</span>USArrests<span class="op">)</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="pp">#</span><span class="er"># list the tables in the database</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> sqlTables<span class="op">(</span>channel<span class="op">)</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  TABLE_QUALIFIER TABLE_OWNER TABLE_NAME TABLE_TYPE REMARKS</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>                              usarrests      TABLE        </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="pp">#</span><span class="er"># list it</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> sqlFetch<span class="op">(</span>channel<span class="op">,</span> <span class="st">"USArrests"</span><span class="op">,</span> rownames <span class="op">=</span> <span class="st">"state"</span><span class="op">)</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>               murder assault urbanpop rape</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>Alabama          <span class="fl">13.2</span>     <span class="dv">236</span>       <span class="dv">58</span> <span class="fl">21.2</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>Alaska           <span class="fl">10.0</span>     <span class="dv">263</span>       <span class="dv">48</span> <span class="fl">44.5</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="pp">#</span><span class="er"># an SQL query, originally on one line</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> sqlQuery<span class="op">(</span>channel<span class="op">,</span> <span class="st">"select state, murder from USArrests</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>           where rape <span class="op">&gt;</span> <span class="dv">30</span> order by murder<span class="st">")</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>       state murder</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> Colorado      <span class="fl">7.9</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> Arizona       <span class="fl">8.1</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> California    <span class="fl">9.0</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> Alaska       <span class="fl">10.0</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> New Mexico   <span class="fl">11.4</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> Michigan     <span class="fl">12.1</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span> Nevada       <span class="fl">12.2</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span> Florida      <span class="fl">15.4</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="pp">#</span><span class="er"># remove the table</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> sqlDrop<span class="op">(</span>channel<span class="op">,</span> <span class="st">"USArrests"</span><span class="op">)</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="pp">#</span><span class="er"># close the connection</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> odbcClose<span class="op">(</span>channel<span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>As a simple example of using ODBC under Windows with a Excel spreadsheet, we can read from a spreadsheet by</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> library<span class="op">(</span>RODBC<span class="op">)</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> channel <span class="op">&lt;-</span> odbcConnectExcel<span class="op">(</span><span class="st">"bdr.xls"</span><span class="op">)</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#</span><span class="er"># list the spreadsheets</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> sqlTables<span class="op">(</span>channel<span class="op">)</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  TABLE_CAT TABLE_SCHEM        TABLE_NAME   TABLE_TYPE REMARKS</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> C<span class="op">:</span>\\bdr            NA           Sheet1$ SYSTEM TABLE      NA</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> C<span class="op">:</span>\\bdr            NA           Sheet2$ SYSTEM TABLE      NA</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> C<span class="op">:</span>\\bdr            NA           Sheet3$ SYSTEM TABLE      NA</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> C<span class="op">:</span>\\bdr            NA Sheet1$Print_Area        TABLE      NA</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="pp">#</span><span class="er"># retrieve the contents of sheet 1, by either of</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> sh1 <span class="op">&lt;-</span> sqlFetch<span class="op">(</span>channel<span class="op">,</span> <span class="st">"Sheet1"</span><span class="op">)</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> sh1 <span class="op">&lt;-</span> sqlQuery<span class="op">(</span>channel<span class="op">,</span> <span class="st">"select * from [Sheet1$]"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Notice that the specification of the table is different from the name returned by <code class="code">sqlTables</code>: <code class="code">sqlFetch</code> is able to map the differences.</p>
</section>

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Importing-from-other-statistical-systems.html" class="pagination-link" aria-label="Importing from other statistical systems">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Importing from other statistical systems</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Binary-files.html" class="pagination-link" aria-label="Binary files">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Binary files</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>A re-styled version of the original R manuals at <a href="https://cran.r-project.org/manuals.html" class="uri">https://cran.r-project.org/manuals.html</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Built using <a href="https://quarto.org">Quarto</a></p>
</div>
  </div>
</footer>




</body></html>
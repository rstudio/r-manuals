<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>12&nbsp; Graphical procedures – R Manuals :: An Introduction to R ¶</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Packages.html" rel="next">
<link href="./Statistical-models-in-R.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-550cd6ffca0d0790fc8e00be81a4e47f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">R Manuals :: An Introduction to R ¶</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-manuals" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Manuals</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-manuals">    
        <li>
    <a class="dropdown-item" href="./../r-intro/index.html">
 <span class="dropdown-text">An Introduction to R ¶</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./../r-data/index.html">
 <span class="dropdown-text">R Data Import/Export ¶</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./../r-admin/index.html">
 <span class="dropdown-text">R Installation and Administration ¶</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./../r-exts/index.html">
 <span class="dropdown-text">Writing R Extensions ¶</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./../r-lang/index.html">
 <span class="dropdown-text">R Language Definition ¶</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./../r-ints/index.html">
 <span class="dropdown-text">R Internals ¶</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Graphics.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Graphical procedures</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Top (An Introduction to R)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Introduction-and-preliminaries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction and preliminaries</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Simple-manipulations-numbers-and-vectors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Simple manipulations; numbers and vectors</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Objects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Objects, their modes and attributes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Factors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Ordered and unordered factors</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Arrays-and-matrices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Arrays and matrices</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lists-and-data-frames.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Lists and data frames</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Reading-data-from-files.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Reading data from files</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Probability-distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Probability distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Loops-and-conditional-execution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Grouping, loops and conditional execution</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Writing-your-own-functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Writing your own functions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Statistical-models-in-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Statistical models in R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Graphics.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Graphical procedures</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Packages</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./OS-facilities.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">OS facilities</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./References.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Function-and-variable-index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Function and variable index</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Concept-index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Concept index</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A-sample-session.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">A sample session</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Invoking-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Invoking R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./The-command-line-editor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">The command-line editor</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#high-level-plotting-commands" id="toc-high-level-plotting-commands" class="nav-link active" data-scroll-target="#high-level-plotting-commands"><span class="header-section-number">12.1</span> High-level plotting commands</a>
  <ul class="collapse">
  <li><a href="#the-plot-function" id="toc-the-plot-function" class="nav-link" data-scroll-target="#the-plot-function"><span class="header-section-number">12.1.1</span> The <code class="code">plot()</code> function</a></li>
  <li><a href="#displaying-multivariate-data" id="toc-displaying-multivariate-data" class="nav-link" data-scroll-target="#displaying-multivariate-data"><span class="header-section-number">12.1.2</span> Displaying multivariate data</a></li>
  <li><a href="#display-graphics" id="toc-display-graphics" class="nav-link" data-scroll-target="#display-graphics"><span class="header-section-number">12.1.3</span> Display graphics</a></li>
  <li><a href="#arguments-to-high-level-plotting-functions" id="toc-arguments-to-high-level-plotting-functions" class="nav-link" data-scroll-target="#arguments-to-high-level-plotting-functions"><span class="header-section-number">12.1.4</span> Arguments to high-level plotting functions</a></li>
  </ul></li>
  <li><a href="#low-level-plotting-commands" id="toc-low-level-plotting-commands" class="nav-link" data-scroll-target="#low-level-plotting-commands"><span class="header-section-number">12.2</span> Low-level plotting commands</a>
  <ul class="collapse">
  <li><a href="#mathematical-annotation" id="toc-mathematical-annotation" class="nav-link" data-scroll-target="#mathematical-annotation"><span class="header-section-number">12.2.1</span> Mathematical annotation</a></li>
  <li><a href="#hershey-vector-fonts" id="toc-hershey-vector-fonts" class="nav-link" data-scroll-target="#hershey-vector-fonts"><span class="header-section-number">12.2.2</span> Hershey vector fonts</a></li>
  </ul></li>
  <li><a href="#interacting-with-graphics" id="toc-interacting-with-graphics" class="nav-link" data-scroll-target="#interacting-with-graphics"><span class="header-section-number">12.3</span> Interacting with graphics</a></li>
  <li><a href="#using-graphics-parameters" id="toc-using-graphics-parameters" class="nav-link" data-scroll-target="#using-graphics-parameters"><span class="header-section-number">12.4</span> Using graphics parameters</a>
  <ul class="collapse">
  <li><a href="#permanent-changes-the-par-function" id="toc-permanent-changes-the-par-function" class="nav-link" data-scroll-target="#permanent-changes-the-par-function"><span class="header-section-number">12.4.1</span> Permanent changes: The <code class="code">par()</code> function</a></li>
  <li><a href="#temporary-changes-arguments-to-graphics-functions" id="toc-temporary-changes-arguments-to-graphics-functions" class="nav-link" data-scroll-target="#temporary-changes-arguments-to-graphics-functions"><span class="header-section-number">12.4.2</span> Temporary changes: Arguments to graphics functions</a></li>
  </ul></li>
  <li><a href="#graphics-parameters-list" id="toc-graphics-parameters-list" class="nav-link" data-scroll-target="#graphics-parameters-list"><span class="header-section-number">12.5</span> Graphics parameters list</a>
  <ul class="collapse">
  <li><a href="#graphical-elements" id="toc-graphical-elements" class="nav-link" data-scroll-target="#graphical-elements"><span class="header-section-number">12.5.1</span> Graphical elements</a></li>
  <li><a href="#axes-and-tick-marks" id="toc-axes-and-tick-marks" class="nav-link" data-scroll-target="#axes-and-tick-marks"><span class="header-section-number">12.5.2</span> Axes and tick marks</a></li>
  <li><a href="#figure-margins" id="toc-figure-margins" class="nav-link" data-scroll-target="#figure-margins"><span class="header-section-number">12.5.3</span> Figure margins</a></li>
  <li><a href="#multiple-figure-environment" id="toc-multiple-figure-environment" class="nav-link" data-scroll-target="#multiple-figure-environment"><span class="header-section-number">12.5.4</span> Multiple figure environment</a></li>
  </ul></li>
  <li><a href="#device-drivers" id="toc-device-drivers" class="nav-link" data-scroll-target="#device-drivers"><span class="header-section-number">12.6</span> Device drivers</a>
  <ul class="collapse">
  <li><a href="#postscript-diagrams-for-typeset-documents" id="toc-postscript-diagrams-for-typeset-documents" class="nav-link" data-scroll-target="#postscript-diagrams-for-typeset-documents"><span class="header-section-number">12.6.1</span> PostScript diagrams for typeset documents</a></li>
  <li><a href="#multiple-graphics-devices" id="toc-multiple-graphics-devices" class="nav-link" data-scroll-target="#multiple-graphics-devices"><span class="header-section-number">12.6.2</span> Multiple graphics devices</a></li>
  </ul></li>
  <li><a href="#dynamic-graphics" id="toc-dynamic-graphics" class="nav-link" data-scroll-target="#dynamic-graphics"><span class="header-section-number">12.7</span> Dynamic graphics</a>
  <ul class="collapse">
  <li><a href="#footnotes" id="toc-footnotes" class="nav-link" data-scroll-target="#footnotes"><span class="header-section-number">12.7.1</span> Footnotes</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Graphical procedures</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Next: <a href="Packages.html#packages" accesskey="n" rel="next">Packages</a>, Previous: <a href="Statistical-models-in-R.html#statistical-models-in-r" accesskey="p" rel="prev">Statistical models in R</a>, Up: <a href="index.html" accesskey="u" rel="up">An Introduction to R</a> &nbsp; [<a href="index.html#sec_contents" rel="contents" title="Table of contents">Contents</a>][<a href="Function-and-variable-index.html" rel="index" title="Index">Index</a>]</p>
<p>Graphical facilities are an important and extremely versatile component of the R environment. It is possible to use the facilities to display a wide variety of statistical graphs and also to build entirely new types of graph.</p>
<p>The graphics facilities can be used in both interactive and batch modes, but in most cases, interactive use is more productive. Interactive use is also easy because at startup time R initiates a graphics <em>device driver</em> which opens a special <em>graphics window</em> for the display of interactive graphics. Although this is done automatically, it may useful to know that the command used is <code class="code">X11()</code> under UNIX, <code class="code">windows()</code> under Windows and <code class="code">quartz()</code> under macOS. A new device can always be opened by <code class="code">dev.new()</code>.</p>
<p>Once the device driver is running, R plotting commands can be used to produce a variety of graphical displays and to create entirely new kinds of display.</p>
<p>Plotting commands are divided into three basic groups:</p>
<ul>
<li><strong>High-level</strong> plotting functions create a new plot on the graphics device, possibly with axes, labels, titles and so on.</li>
<li><strong>Low-level</strong> plotting functions add more information to an existing plot, such as extra points, lines and labels.</li>
<li><strong>Interactive</strong> graphics functions allow you interactively add information to, or extract information from, an existing plot, using a pointing device such as a mouse.</li>
</ul>
<p>In addition, R maintains a list of <em>graphical parameters</em> which can be manipulated to customize your plots.</p>
<p>This manual only describes what are known as ‘base’ graphics. A separate graphics sub-system in package <strong>grid</strong> coexists with base – it is more powerful but harder to use. There is a recommended package <a href="https://CRAN.R-project.org/package=lattice" class="url"><strong>lattice</strong></a> which builds on <strong>grid</strong> and provides ways to produce multi-panel plots akin to those in the <em>Trellis</em> system in S.</p>
<section id="high-level-plotting-commands" class="level2 section" data-number="12.1">
<h2 class="section anchored" data-number="12.1" data-anchor-id="high-level-plotting-commands"><span class="header-section-number">12.1</span> High-level plotting commands</h2>
<p>High-level plotting functions are designed to generate a complete plot of the data passed as arguments to the function. Where appropriate, axes, labels and titles are automatically generated (unless you request otherwise.) High-level plotting commands always start a new plot, erasing the current plot if necessary.</p>
<section id="the-plot-function" class="level3 subsection" data-number="12.1.1">
<h3 class="subsection anchored" data-number="12.1.1" data-anchor-id="the-plot-function"><span class="header-section-number">12.1.1</span> The <code class="code">plot()</code> function</h3>
<p>One of the most frequently used plotting functions in R is the <code class="code">plot()</code> function. This is a <em>generic</em> function: the type of plot produced is dependent on the type or <em>class</em> of the first argument.</p>
<p><code class="code">plot(</code><var class="var">x</var><code class="code">,</code><var class="var">y</var><code class="code">)</code><br>
<code class="code">plot(</code><var class="var">xy</var><code class="code">)</code></p>
<p>: If <var class="var">x</var> and <var class="var">y</var> are vectors, <code class="code">plot(</code><var class="var">x</var><code class="code">,</code><var class="var">y</var><code class="code">)</code> produces a scatterplot of <var class="var">y</var> against <var class="var">x</var>. The same effect can be produced by supplying one argument (second form) as either a list containing two elements <var class="var">x</var> and <var class="var">y</var> or a two-column matrix.</p>
<dl>
<dt><code class="code">plot(</code><var class="var">x</var><code class="code">)</code></dt>
<dd>
<p>If <var class="var">x</var> is a time series, this produces a time-series plot. If <var class="var">x</var> is a numeric vector, it produces a plot of the values in the vector against their index in the vector. If <var class="var">x</var> is a complex vector, it produces a plot of imaginary versus real parts of the vector elements.</p>
</dd>
</dl>
<p><code class="code">plot(</code><var class="var">f</var><code class="code">)</code><br>
<code class="code">plot(</code><var class="var">f</var><code class="code">,</code><var class="var">y</var><code class="code">)</code></p>
<p>: <var class="var">f</var> is a factor object, <var class="var">y</var> is a numeric vector. The first form generates a bar plot of <var class="var">f</var>; the second form produces boxplots of <var class="var">y</var> for each level of <var class="var">f</var>.</p>
<p><code class="code">plot(</code><var class="var">df</var><code class="code">)</code><br>
<code class="code">plot(~</code><var class="var">expr</var><code class="code">)</code><br>
<code class="code">plot(</code><var class="var">y</var><code class="code">~</code><var class="var">expr</var><code class="code">)</code></p>
<p>: <var class="var">df</var> is a data frame, <var class="var">y</var> is any object, <var class="var">expr</var> is a list of object names separated by <code class="code">+</code>’ (e.g., <code class="code">a + b + c</code>). The first two forms produce distributional plots of the variables in a data frame (first form) or of a number of named objects (second form). The third form plots <var class="var">y</var> against every object named in <var class="var">expr</var>.</p>
</section>
<section id="displaying-multivariate-data" class="level3 subsection" data-number="12.1.2">
<h3 class="subsection anchored" data-number="12.1.2" data-anchor-id="displaying-multivariate-data"><span class="header-section-number">12.1.2</span> Displaying multivariate data</h3>
<p>R provides two very useful functions for representing multivariate data. If <code class="code">X</code> is a numeric matrix or data frame, the command</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">pairs</span>(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>produces a pairwise scatterplot matrix of the variables defined by the columns of <code class="code">X</code>, that is, every column of <code class="code">X</code> is plotted against every other column of <code class="code">X</code> and the resulting <em>n(n-1)</em> plots are arranged in a matrix with plot scales constant over the rows and columns of the matrix.</p>
<p>When three or four variables are involved a <em>coplot</em> may be more enlightening. If <code class="code">a</code> and <code class="code">b</code> are numeric vectors and <code class="code">c</code> is a numeric vector or factor object (all of the same length), then the command</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">coplot</span>(a <span class="sc">~</span> b <span class="sc">|</span> c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>produces a number of scatterplots of <code class="code">a</code> against <code class="code">b</code> for given values of <code class="code">c</code>. If <code class="code">c</code> is a factor, this simply means that <code class="code">a</code> is plotted against <code class="code">b</code> for every level of <code class="code">c</code>. When <code class="code">c</code> is numeric, it is divided into a number of <em>conditioning intervals</em> and for each interval <code class="code">a</code> is plotted against <code class="code">b</code> for values of <code class="code">c</code> within the interval. The number and position of intervals can be controlled with <code class="code">given.values=</code> argument to <code class="code">coplot()</code>—the function <code class="code">co.intervals()</code> is useful for selecting intervals. You can also use two <em>given</em> variables with a command like</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">coplot</span>(a <span class="sc">~</span> b <span class="sc">|</span> c <span class="sc">+</span> d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>which produces scatterplots of <code class="code">a</code> against <code class="code">b</code> for every joint conditioning interval of <code class="code">c</code> and <code class="code">d</code>.</p>
<p>The <code class="code">coplot()</code> and <code class="code">pairs()</code> function both take an argument <code class="code">panel=</code> which can be used to customize the type of plot which appears in each panel. The default is <code class="code">points()</code> to produce a scatterplot but by supplying some other low-level graphics function of two vectors <code class="code">x</code> and <code class="code">y</code> as the value of <code class="code">panel=</code> you can produce any type of plot you wish. An example panel function useful for coplots is <code class="code">panel.smooth()</code>.</p>
</section>
<section id="display-graphics" class="level3 subsection" data-number="12.1.3">
<h3 class="subsection anchored" data-number="12.1.3" data-anchor-id="display-graphics"><span class="header-section-number">12.1.3</span> Display graphics</h3>
<p>Other high-level graphics functions produce different types of plots. Some examples are:</p>
<p><span id="index-qqline-1" class="index-entry-id"></span> <span id="index-qqplot" class="index-entry-id"></span> <span id="index-qqnorm-1"></span><code class="code">qqnorm(x)</code><br>
<code class="code">qqline(x)</code><br>
<code class="code">qqplot(x, y)</code></p>
<p>: Distribution-comparison plots. The first form plots the numeric vector <code class="code">x</code> against the expected Normal order scores (a normal scores plot) and the second adds a straight line to such a plot by drawing a line through the distribution and data quartiles. The third form plots the quantiles of <code class="code">x</code> against those of <code class="code">y</code> to compare their respective distributions.</p>
<p><span id="index-hist-1"></span><code class="code">hist(x)</code><br>
<code class="code">hist(x, nclass=</code><var class="var">n</var><code class="code">)</code><br>
<code class="code">hist(x, breaks=</code><var class="var">b</var><code class="code">, ...)</code></p>
<p>: Produces a histogram of the numeric vector <code class="code">x</code>. A sensible number of classes is usually chosen, but a recommendation can be given with the <code class="code">nclass=</code> argument. Alternatively, the breakpoints can be specified exactly with the <code class="code">breaks=</code> argument. If the <code class="code">probability=TRUE</code> argument is given, the bars represent relative frequencies divided by bin width instead of counts.</p>
<p>: Constructs a dot chart of the data in <code class="code">x</code>. In a dot chart the <em>y</em>-axis gives a labelling of the data in <code class="code">x</code> and the <em>x</em>-axis gives its value. For example it allows easy visual selection of all data entries with values lying in specified ranges.</p>
<p><span id="index-contour" class="index-entry-id"></span> <span id="index-persp" class="index-entry-id"></span> <span id="index-image"></span><code class="code">image(x, y, z, ...)</code><br>
<code class="code">contour(x, y, z, ...)</code><br>
<code class="code">persp(x, y, z, ...)</code></p>
<p>: Plots of three variables. The <code class="code">image</code> plot draws a grid of rectangles using different colours to represent the value of <code class="code">z</code>, the <code class="code">contour</code> plot draws contour lines to represent the value of <code class="code">z</code>, and the <code class="code">persp</code> plot draws a 3D surface.</p>
</section>
<section id="arguments-to-high-level-plotting-functions" class="level3 subsection" data-number="12.1.4">
<h3 class="subsection anchored" data-number="12.1.4" data-anchor-id="arguments-to-high-level-plotting-functions"><span class="header-section-number">12.1.4</span> Arguments to high-level plotting functions</h3>
<p>There are a number of arguments which may be passed to high-level graphics functions, as follows:</p>
<dl>
<dt><code class="code">add=TRUE</code></dt>
<dd>
<p>Forces the function to act as a low-level graphics function, superimposing the plot on the current plot (some functions only).</p>
</dd>
<dt><code class="code">axes=FALSE</code></dt>
<dd>
<p>Suppresses generation of axes—useful for adding your own custom axes with the <code class="code">axis()</code> function. The default, <code class="code">axes=TRUE</code>, means include axes.</p>
</dd>
</dl>
<p><code class="code">log="x"</code><br>
<code class="code">log="y"</code><br>
<code class="code">log="xy"</code></p>
<p>: Causes the <em>x</em>, <em>y</em> or both axes to be logarithmic. This will work for many, but not all, types of plot.</p>
<dl>
<dt><code class="code">type=</code></dt>
<dd>
<p>The <code class="code">type=</code> argument controls the type of plot produced, as follows:</p>
<dl>
<dt><code class="code">type="p"</code></dt>
<dd>
<p>Plot individual points (the default)</p>
</dd>
<dt><code class="code">type="l"</code></dt>
<dd>
<p>Plot lines</p>
</dd>
<dt><code class="code">type="b"</code></dt>
<dd>
<p>Plot points connected by lines (<em>both</em>)</p>
</dd>
<dt><code class="code">type="o"</code></dt>
<dd>
<p>Plot points overlaid by lines</p>
</dd>
<dt><code class="code">type="h"</code></dt>
<dd>
<p>Plot vertical lines from points to the zero axis (<em>high-density</em>)</p>
</dd>
</dl>
<p><code class="code">type="s"</code><br>
<code class="code">type="S"</code></p>
<p>: Step-function plots. In the first form, the top of the vertical defines the point; in the second, the bottom.</p>
<dl>
<dt><code class="code">type="n"</code></dt>
<dd>
<p>No plotting at all. However axes are still drawn (by default) and the coordinate system is set up according to the data. Ideal for creating plots with subsequent low-level graphics functions.</p>
</dd>
</dl>
</dd>
</dl>
<p><code class="code">xlab=</code><var class="var">string</var><br>
<code class="code">ylab=</code><var class="var">string</var></p>
<p>: Axis labels for the <em>x</em> and <em>y</em> axes. Use these arguments to change the default labels, usually the names of the objects used in the call to the high-level plotting function.</p>
<dl>
<dt><code class="code">main=</code><var class="var">string</var></dt>
<dd>
<p>Figure title, placed at the top of the plot in a large font.</p>
</dd>
<dt><code class="code">sub=</code><var class="var">string</var></dt>
<dd>
<p>Sub-title, placed just below the <em>x</em>-axis in a smaller font.</p>
</dd>
</dl>
</section>
</section>
<section id="low-level-plotting-commands" class="level2 section" data-number="12.2">
<h2 class="section anchored" data-number="12.2" data-anchor-id="low-level-plotting-commands"><span class="header-section-number">12.2</span> Low-level plotting commands</h2>
<p>Sometimes the high-level plotting functions don’t produce exactly the kind of plot you desire. In this case, low-level plotting commands can be used to add extra information (such as points, lines or text) to the current plot.</p>
<p>Some of the more useful low-level plotting functions are:</p>
<p><span id="index-lines" class="index-entry-id"></span> <span id="index-points"></span><code class="code">points(x, y)</code><br>
<code class="code">lines(x, y)</code></p>
<p>: Adds points or connected lines to the current plot. <code class="code">plot()</code>’s <code class="code">type=</code> argument can also be passed to these functions (and defaults to <code class="code">"p"</code> for <code class="code">points()</code> and <code class="code">"l"</code> for <code class="code">lines()</code>.)</p>
<p>: Add text to a plot at points given by <code class="code">x, y</code>. Normally <code class="code">labels</code> is an integer or character vector in which case <code class="code">labels[i]</code> is plotted at point <code class="code">(x[i], y[i])</code>. The default is <code class="code">1:length(x)</code>.</p>
<pre><code>**Note**: This function is often used in the sequence


``` R
&gt; plot(x, y, type="n"); text(x, y, names)
```

The graphics parameter `type="n"`{.code} suppresses the points but
sets up the axes, and the `text()`{.code} function supplies special
characters, as specified by the character vector `names`{.code} for
the points.</code></pre>
<p><span id="index-abline"></span><code class="code">abline(a, b)</code><br>
<code class="code">abline(h=</code><var class="var">y</var><code class="code">)</code><br>
<code class="code">abline(v=</code><var class="var">x</var><code class="code">)</code><br>
<code class="code">abline(</code><var class="var">lm.obj</var><code class="code">)</code></p>
<p>: Adds a line of slope <code class="code">b</code> and intercept <code class="code">a</code> to the current plot. <code class="code">h=</code><var class="var">y</var> may be used to specify <em>y</em>-coordinates for the heights of horizontal lines to go across a plot, and <code class="code">v=</code><var class="var">x</var> similarly for the <em>x</em>-coordinates for vertical lines. Also <var class="var">lm.obj</var> may be list with a <code class="code">coefficients</code> component of length 2 (such as the result of model-fitting functions,) which are taken as an intercept and slope, in that order.</p>
<p>: Draws a polygon defined by the ordered vertices in (<code class="code">x</code>, <code class="code">y</code>) and (optionally) shade it in with hatch lines, or fill it if the graphics device allows the filling of figures.</p>
<p>: Adds a legend to the current plot at the specified position. Plotting characters, line styles, colors etc., are identified with the labels in the character vector <code class="code">legend</code>. At least one other argument <var class="var">v</var> (a vector the same length as <code class="code">legend</code>) with the corresponding values of the plotting unit must also be given, as follows:</p>
<pre><code>`legend( , fill=`{.code}`v`{.variable .var}`)`{.code}

:   Colors for filled boxes

`legend( , col=`{.code}`v`{.variable .var}`)`{.code}

:   Colors in which points or lines will be drawn

`legend( , lty=`{.code}`v`{.variable .var}`)`{.code}

:   Line styles

`legend( , lwd=`{.code}`v`{.variable .var}`)`{.code}

:   Line widths

`legend( , pch=`{.code}`v`{.variable .var}`)`{.code}

:   Plotting characters (character vector)</code></pre>
<p>: Adds a title <code class="code">main</code> to the top of the current plot in a large font and (optionally) a sub-title <code class="code">sub</code> at the bottom in a smaller font.</p>
<p>: Adds an axis to the current plot on the side given by the first argument (1 to 4, counting clockwise from the bottom.) Other arguments control the positioning of the axis within or beside the plot, and tick positions and labels. Useful for adding custom axes after calling <code class="code">plot()</code> with the <code class="code">axes=FALSE</code> argument.</p>
<p>Low-level plotting functions usually require some positioning information (e.g., <em>x</em> and <em>y</em> coordinates) to determine where to place the new plot elements. Coordinates are given in terms of <em>user coordinates</em> which are defined by the previous high-level graphics command and are chosen based on the supplied data.</p>
<p>Where <code class="code">x</code> and <code class="code">y</code> arguments are required, it is also sufficient to supply a single argument being a list with elements named <code class="code">x</code> and <code class="code">y</code>. Similarly a matrix with two columns is also valid input. In this way functions such as <code class="code">locator()</code> (see below) may be used to specify positions on a plot interactively.</p>
<section id="mathematical-annotation" class="level3 subsection" data-number="12.2.1">
<h3 class="subsection anchored" data-number="12.2.1" data-anchor-id="mathematical-annotation"><span class="header-section-number">12.2.1</span> Mathematical annotation</h3>
<p>In some cases, it is useful to add mathematical symbols and formulae to a plot. This can be achieved in R by specifying an <em>expression</em> rather than a character string in any one of <code class="code">text</code>, <code class="code">mtext</code>, <code class="code">axis</code>, or <code class="code">title</code>. For example, the following code draws the formula for the Binomial probability function:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">text</span>(x, y, <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">bgroup</span>(<span class="st">"("</span>, <span class="fu">atop</span>(n, x), <span class="st">")"</span>), p<span class="sc">^</span>x, q<span class="sc">^</span>{n<span class="sc">-</span>x})))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>More information, including a full listing of the features available can obtained from within R using the commands:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">help</span>(plotmath)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">example</span>(plotmath)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">demo</span>(plotmath)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="hershey-vector-fonts" class="level3 subsection" data-number="12.2.2">
<h3 class="subsection anchored" data-number="12.2.2" data-anchor-id="hershey-vector-fonts"><span class="header-section-number">12.2.2</span> Hershey vector fonts</h3>
<p>It is possible to specify Hershey vector fonts for rendering text when using the <code class="code">text</code> and <code class="code">contour</code> functions. There are three reasons for using the Hershey fonts:</p>
<ul>
<li>Hershey fonts can produce better output, especially on a computer screen, for rotated and/or small text.</li>
<li>Hershey fonts provide certain symbols that may not be available in the standard fonts. In particular, there are zodiac signs, cartographic symbols and astronomical symbols.</li>
<li>Hershey fonts provide Cyrillic and Japanese (Kana and Kanji) characters.</li>
</ul>
<p>More information, including tables of Hershey characters can be obtained from within R using the commands:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">help</span>(Hershey)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">demo</span>(Hershey)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">help</span>(Japanese)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">demo</span>(Japanese)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="interacting-with-graphics" class="level2 section" data-number="12.3">
<h2 class="section anchored" data-number="12.3" data-anchor-id="interacting-with-graphics"><span class="header-section-number">12.3</span> Interacting with graphics</h2>
<p>R also provides functions which allow users to extract or add information to a plot using a mouse. The simplest of these is the <code class="code">locator()</code> function:</p>
<p>: Waits for the user to select locations on the current plot using the left mouse button. This continues until <code class="code">n</code> (default 512) points have been selected, or another mouse button is pressed. The <code class="code">type</code> argument allows for plotting at the selected points and has the same effect as for high-level graphics commands; the default is no plotting. <code class="code">locator()</code> returns the locations of the points selected as a list with two components <code class="code">x</code> and <code class="code">y</code>.</p>
<p><code class="code">locator()</code> is usually called with no arguments. It is particularly useful for interactively selecting positions for graphic elements such as legends or labels when it is difficult to calculate in advance where the graphic should be placed. For example, to place some informative text near an outlying point, the command</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">text</span>(<span class="fu">locator</span>(<span class="dv">1</span>), <span class="st">"Outlier"</span>, <span class="at">adj=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>may be useful. (<code class="code">locator()</code> will be ignored if the current device, such as <code class="code">postscript</code> does not support interactive pointing.)</p>
<p>: Allow the user to highlight any of the points defined by <code class="code">x</code> and <code class="code">y</code> (using the left mouse button) by plotting the corresponding component of <code class="code">labels</code> nearby (or the index number of the point if <code class="code">labels</code> is absent). Returns the indices of the selected points when another button is pressed.</p>
<p>Sometimes we want to identify particular <em>points</em> on a plot, rather than their positions. For example, we may wish the user to select some observation of interest from a graphical display and then manipulate that observation in some way. Given a number of <em>(x, y)</em> coordinates in two numeric vectors <code class="code">x</code> and <code class="code">y</code>, we could use the <code class="code">identify()</code> function as follows:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(x, y)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">identify</span>(x, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The <code class="code">identify()</code> functions performs no plotting itself, but simply allows the user to move the mouse pointer and click the left mouse button near a point. If there is a point near the mouse pointer it will be marked with its index number (that is, its position in the <code class="code">x</code>/<code class="code">y</code> vectors) plotted nearby. Alternatively, you could use some informative string (such as a case name) as a highlight by using the <code class="code">labels</code> argument to <code class="code">identify()</code>, or disable marking altogether with the <code class="code">plot = FALSE</code> argument. When the process is terminated (see above), <code class="code">identify()</code> returns the indices of the selected points; you can use these indices to extract the selected points from the original vectors <code class="code">x</code> and <code class="code">y</code>.</p>
</section>
<section id="using-graphics-parameters" class="level2 section" data-number="12.4">
<h2 class="section anchored" data-number="12.4" data-anchor-id="using-graphics-parameters"><span class="header-section-number">12.4</span> Using graphics parameters</h2>
<p>When creating graphics, particularly for presentation or publication purposes, R’s defaults do not always produce exactly that which is required. You can, however, customize almost every aspect of the display using <em>graphics parameters</em>. R maintains a list of a large number of graphics parameters which control things such as line style, colors, figure arrangement and text justification among many others. Every graphics parameter has a name (such as <code class="code">col</code>’, which controls colors,) and a value (a color number, for example.)</p>
<p>A separate list of graphics parameters is maintained for each active device, and each device has a default set of parameters when initialized. Graphics parameters can be set in two ways: either permanently, affecting all graphics functions which access the current device; or temporarily, affecting only a single graphics function call.</p>
<section id="permanent-changes-the-par-function" class="level3 subsection" data-number="12.4.1">
<h3 class="subsection anchored" data-number="12.4.1" data-anchor-id="permanent-changes-the-par-function"><span class="header-section-number">12.4.1</span> Permanent changes: The <code class="code">par()</code> function</h3>
<p><span id="index-par" class="index-entry-id"></span> <span id="index-Graphics-parameters" class="index-entry-id"></span></p>
<p>The <code class="code">par()</code> function is used to access and modify the list of graphics parameters for the current graphics device.</p>
<dl>
<dt><code class="code">par()</code></dt>
<dd>
<p>Without arguments, returns a list of all graphics parameters and their values for the current device.</p>
</dd>
<dt><code class="code">par(c("col", "lty"))</code></dt>
<dd>
<p>With a character vector argument, returns only the named graphics parameters (again, as a list.)</p>
</dd>
<dt><code class="code">par(col=4, lty=2)</code></dt>
<dd>
<p>With named arguments (or a single list argument), sets the values of the named graphics parameters, and returns the original values of the parameters as a list.</p>
</dd>
</dl>
<p>Setting graphics parameters with the <code class="code">par()</code> function changes the value of the parameters <em>permanently</em>, in the sense that all future calls to graphics functions (on the current device) will be affected by the new value. You can think of setting graphics parameters in this way as setting “default” values for the parameters, which will be used by all graphics functions unless an alternative value is given.</p>
<p>Note that calls to <code class="code">par()</code> <em>always</em> affect the global values of graphics parameters, even when <code class="code">par()</code> is called from within a function. This is often undesirable behavior—usually we want to set some graphics parameters, do some plotting, and then restore the original values so as not to affect the user’s R session. You can restore the initial values by saving the result of <code class="code">par()</code> when making changes, and restoring the initial values when plotting is complete.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> oldpar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">col=</span><span class="dv">4</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  ... plotting commands ...</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">par</span>(oldpar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>To save and restore <em>all</em> settable<a href="#FOOT24" id="DOCF24" class="footnote"><sup>24</sup></a> graphical parameters use</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> oldpar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">no.readonly=</span><span class="cn">TRUE</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  ... plotting commands ...</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">par</span>(oldpar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="temporary-changes-arguments-to-graphics-functions" class="level3 subsection" data-number="12.4.2">
<h3 class="subsection anchored" data-number="12.4.2" data-anchor-id="temporary-changes-arguments-to-graphics-functions"><span class="header-section-number">12.4.2</span> Temporary changes: Arguments to graphics functions</h3>
<p>Graphics parameters may also be passed to (almost) any graphics function as named arguments. This has the same effect as passing the arguments to the <code class="code">par()</code> function, except that the changes only last for the duration of the function call. For example:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(x, y, <span class="at">pch=</span><span class="st">"+"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>produces a scatterplot using a plus sign as the plotting character, without changing the default plotting character for future plots.</p>
<p>Unfortunately, this is not implemented entirely consistently and it is sometimes necessary to set and reset graphics parameters using <code class="code">par()</code>.</p>
</section>
</section>
<section id="graphics-parameters-list" class="level2 section" data-number="12.5">
<h2 class="section anchored" data-number="12.5" data-anchor-id="graphics-parameters-list"><span class="header-section-number">12.5</span> Graphics parameters list</h2>
<p>The following sections detail many of the commonly-used graphical parameters. The R help documentation for the <code class="code">par()</code> function provides a more concise summary; this is provided as a somewhat more detailed alternative.</p>
<p>Graphics parameters will be presented in the following form:</p>
<dl>
<dt><var class="var">name</var><code class="code">=</code><var class="var">value</var></dt>
<dd>
<p>A description of the parameter’s effect. <var class="var">name</var> is the name of the parameter, that is, the argument name to use in calls to <code class="code">par()</code> or a graphics function. <var class="var">value</var> is a typical value you might use when setting the parameter.</p>
</dd>
</dl>
<p>Note that <code class="code">axes</code> is <strong>not</strong> a graphics parameter but an argument to a few <code class="code">plot</code> methods: see <code class="code">xaxt</code> and <code class="code">yaxt</code>.</p>
<section id="graphical-elements" class="level3 subsection" data-number="12.5.1">
<h3 class="subsection anchored" data-number="12.5.1" data-anchor-id="graphical-elements"><span class="header-section-number">12.5.1</span> Graphical elements</h3>
<p>R plots are made up of points, lines, text and polygons (filled regions.) Graphical parameters exist which control how these <em>graphical elements</em> are drawn, as follows:</p>
<dl>
<dt><code class="code">pch="+"</code></dt>
<dd>
<p>Character to be used for plotting points. The default varies with graphics drivers, but it is usually a circle. Plotted points tend to appear slightly above or below the appropriate position unless you use <code class="code">"."</code> as the plotting character, which produces centered points.</p>
</dd>
<dt><code class="code">pch=4</code></dt>
<dd>
<p>When <code class="code">pch</code> is given as an integer between 0 and 25 inclusive, a specialized plotting symbol is produced. To see what the symbols are, use the command</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">legend</span>(<span class="fu">locator</span>(<span class="dv">1</span>), <span class="fu">as.character</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">25</span>), <span class="at">pch =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Those from 21 to 25 may appear to duplicate earlier symbols, but can be coloured in different ways: see the help on <code class="code">points</code> and its examples.</p>
<p>In addition, <code class="code">pch</code> can be a character or a number in the range <code class="code">32:255</code> representing a character in the current font.</p>
</dd>
<dt><code class="code">lty=2</code></dt>
<dd>
<p>Line types. Alternative line styles are not supported on all graphics devices (and vary on those that do) but line type 1 is always a solid line, line type 0 is always invisible, and line types 2 and onwards are dotted or dashed lines, or some combination of both.</p>
</dd>
<dt><code class="code">lwd=2</code></dt>
<dd>
<p>Line widths. Desired width of lines, in multiples of the “standard” line width. Affects axis lines as well as lines drawn with <code class="code">lines()</code>, etc. Not all devices support this, and some have restrictions on the widths that can be used.</p>
</dd>
<dt><code class="code">col=2</code></dt>
<dd>
<p>Colors to be used for points, lines, text, filled regions and images. A number from the current palette (see <code class="code">?palette</code>) or a named colour.</p>
</dd>
</dl>
<p><code class="code">col.axis</code><br>
<code class="code">col.lab</code><br>
<code class="code">col.main</code><br>
<code class="code">col.sub</code></p>
<p>: The color to be used for axis annotation, <em>x</em> and <em>y</em> labels, main and sub-titles, respectively.</p>
<dl>
<dt><code class="code">font=2</code></dt>
<dd>
<p>An integer which specifies which font to use for text. If possible, device drivers arrange so that <code class="code">1</code> corresponds to plain text, <code class="code">2</code> to bold face, <code class="code">3</code> to italic, <code class="code">4</code> to bold italic and <code class="code">5</code> to a symbol font (which include Greek letters).</p>
</dd>
</dl>
<p><code class="code">font.axis</code><br>
<code class="code">font.lab</code><br>
<code class="code">font.main</code><br>
<code class="code">font.sub</code></p>
<p>: The font to be used for axis annotation, <em>x</em> and <em>y</em> labels, main and sub-titles, respectively.</p>
<dl>
<dt><code class="code">adj=-0.1</code></dt>
<dd>
<p>Justification of text relative to the plotting position. <code class="code">0</code> means left justify, <code class="code">1</code> means right justify and <code class="code">0.5</code> means to center horizontally about the plotting position. The actual value is the proportion of text that appears to the left of the plotting position, so a value of <code class="code">-0.1</code> leaves a gap of 10% of the text width between the text and the plotting position.</p>
</dd>
<dt><code class="code">cex=1.5</code></dt>
<dd>
<p>Character expansion. The value is the desired size of text characters (including plotting characters) relative to the default text size.</p>
</dd>
</dl>
<p><code class="code">cex.axis</code><br>
<code class="code">cex.lab</code><br>
<code class="code">cex.main</code><br>
<code class="code">cex.sub</code></p>
<p>: The character expansion to be used for axis annotation, <em>x</em> and <em>y</em> labels, main and sub-titles, respectively.</p>
</section>
<section id="axes-and-tick-marks" class="level3 subsection" data-number="12.5.2">
<h3 class="subsection anchored" data-number="12.5.2" data-anchor-id="axes-and-tick-marks"><span class="header-section-number">12.5.2</span> Axes and tick marks</h3>
<p>Many of R’s high-level plots have axes, and you can construct axes yourself with the low-level <code class="code">axis()</code> graphics function. Axes have three main components: the <em>axis line</em> (line style controlled by the <code class="code">lty</code> graphics parameter), the <em>tick marks</em> (which mark off unit divisions along the axis line) and the <em>tick labels</em> (which mark the units.) These components can be customized with the following graphics parameters.</p>
<dl>
<dt><code class="code">lab=c(5, 7, 12)</code></dt>
<dd>
<p>The first two numbers are the desired number of tick intervals on the <em>x</em> and <em>y</em> axes respectively. The third number is the desired length of axis labels, in characters (including the decimal point.) Choosing a too-small value for this parameter may result in all tick labels being rounded to the same number!</p>
</dd>
<dt><code class="code">las=1</code></dt>
<dd>
<p>Orientation of axis labels. <code class="code">0</code> means always parallel to axis, <code class="code">1</code> means always horizontal, and <code class="code">2</code> means always perpendicular to the axis.</p>
</dd>
<dt><code class="code">mgp=c(3, 1, 0)</code></dt>
<dd>
<p>Positions of axis components. The first component is the distance from the axis label to the axis position, in text lines. The second component is the distance to the tick labels, and the final component is the distance from the axis position to the axis line (usually zero). Positive numbers measure outside the plot region, negative numbers inside.</p>
</dd>
<dt><code class="code">tck=0.01</code></dt>
<dd>
<p>Length of tick marks, as a fraction of the size of the plotting region. When <code class="code">tck</code> is small (less than 0.5) the tick marks on the <em>x</em> and <em>y</em> axes are forced to be the same size. A value of 1 gives grid lines. Negative values give tick marks outside the plotting region. Use <code class="code">tck=0.01</code> and <code class="code">mgp=c(1,-1.5,0)</code> for internal tick marks.</p>
</dd>
</dl>
<p><code class="code">xaxs="r"</code><br>
<code class="code">yaxs="i"</code></p>
<p>: Axis styles for the <em>x</em> and <em>y</em> axes, respectively. With styles <code class="code">"i"</code> (internal) and <code class="code">"r"</code> (the default) tick marks always fall within the range of the data, however style <code class="code">"r"</code> leaves a small amount of space at the edges.</p>
</section>
<section id="figure-margins" class="level3 subsection" data-number="12.5.3">
<h3 class="subsection anchored" data-number="12.5.3" data-anchor-id="figure-margins"><span class="header-section-number">12.5.3</span> Figure margins</h3>
<p>A single plot in R is known as a <code class="code">figure</code> and comprises a <em>plot region</em> surrounded by margins (possibly containing axis labels, titles, etc.) and (usually) bounded by the axes themselves.</p>
<p>A typical figure is</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/fig11.png" class="image img-fluid figure-img"></p>
<figcaption>images/fig11</figcaption>
</figure>
</div>
<p>Graphics parameters controlling figure layout include:</p>
<dl>
<dt><code class="code">mai=c(1, 0.5, 0.5, 0)</code></dt>
<dd>
<p>Widths of the bottom, left, top and right margins, respectively, measured in inches.</p>
</dd>
<dt><code class="code">mar=c(4, 2, 2, 1)</code></dt>
<dd>
<p>Similar to <code class="code">mai</code>, except the measurement unit is text lines.</p>
</dd>
</dl>
<p><code class="code">mar</code> and <code class="code">mai</code> are equivalent in the sense that setting one changes the value of the other. The default values chosen for this parameter are often too large; the right-hand margin is rarely needed, and neither is the top margin if no title is being used. The bottom and left margins must be large enough to accommodate the axis and tick labels. Furthermore, the default is chosen without regard to the size of the device surface: for example, using the <code class="code">postscript()</code> driver with the <code class="code">height=4</code> argument will result in a plot which is about 50% margin unless <code class="code">mar</code> or <code class="code">mai</code> are set explicitly. When multiple figures are in use (see below) the margins are reduced, however this may not be enough when many figures share the same page.</p>
</section>
<section id="multiple-figure-environment" class="level3 subsection" data-number="12.5.4">
<h3 class="subsection anchored" data-number="12.5.4" data-anchor-id="multiple-figure-environment"><span class="header-section-number">12.5.4</span> Multiple figure environment</h3>
<p>R allows you to create an <em>n</em> by <em>m</em> array of figures on a single page. Each figure has its own margins, and the array of figures is optionally surrounded by an <em>outer margin</em>, as shown in the following figure.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/fig12.png" class="image img-fluid figure-img"></p>
<figcaption>images/fig12</figcaption>
</figure>
</div>
<p>The graphical parameters relating to multiple figures are as follows:</p>
<p><code class="code">mfcol=c(3, 2)</code><br>
<code class="code">mfrow=c(2, 4)</code></p>
<p>: Set the size of a multiple figure array. The first value is the number of rows; the second is the number of columns. The only difference between these two parameters is that setting <code class="code">mfcol</code> causes figures to be filled by column; <code class="code">mfrow</code> fills by rows.</p>
<pre><code>The layout in the Figure could have been created by setting
`mfrow=c(3,2)`{.code}; the figure shows the page after four plots
have been drawn.

Setting either of these can reduce the base size of symbols and text
(controlled by `par("cex")`{.code} and the pointsize of the device).
In a layout with exactly two rows and columns the base size is
reduced by a factor of 0.83: if there are three or more of either
rows or columns, the reduction factor is 0.66.</code></pre>
<dl>
<dt><code class="code">mfg=c(2, 2, 3, 2)</code></dt>
<dd>
<p>Position of the current figure in a multiple figure environment. The first two numbers are the row and column of the current figure; the last two are the number of rows and columns in the multiple figure array. Set this parameter to jump between figures in the array. You can even use different values for the last two numbers than the <em>true</em> values for unequally-sized figures on the same page.</p>
</dd>
<dt><code class="code">fig=c(4, 9, 1, 4)/10</code></dt>
<dd>
<p>Position of the current figure on the page. Values are the positions of the left, right, bottom and top edges respectively, as a percentage of the page measured from the bottom left corner. The example value would be for a figure in the bottom right of the page. Set this parameter for arbitrary positioning of figures within a page. If you want to add a figure to a current page, use <code class="code">new=TRUE</code> as well (unlike S).</p>
</dd>
</dl>
<p><code class="code">oma=c(2, 0, 3, 0)</code><br>
<code class="code">omi=c(0, 0, 0.8, 0)</code></p>
<p>: Size of outer margins. Like <code class="code">mar</code> and <code class="code">mai</code>, the first measures in text lines and the second in inches, starting with the bottom margin and working clockwise.</p>
<p>Outer margins are particularly useful for page-wise titles, etc. Text can be added to the outer margins with the <code class="code">mtext()</code> function with argument <code class="code">outer=TRUE</code>. There are no outer margins by default, however, so you must create them explicitly using <code class="code">oma</code> or <code class="code">omi</code>.</p>
<p>More complicated arrangements of multiple figures can be produced by the <code class="code">split.screen()</code> and <code class="code">layout()</code> functions, as well as by the <strong>grid</strong> and <a href="https://CRAN.R-project.org/package=lattice" class="url"><strong>lattice</strong></a> packages.</p>
</section>
</section>
<section id="device-drivers" class="level2 section" data-number="12.6">
<h2 class="section anchored" data-number="12.6" data-anchor-id="device-drivers"><span class="header-section-number">12.6</span> Device drivers</h2>
<p>R can generate graphics (of varying levels of quality) on almost any type of display or printing device. Before this can begin, however, R needs to be informed what type of device it is dealing with. This is done by starting a <em>device driver</em>. The purpose of a device driver is to convert graphical instructions from R (“draw a line,” for example) into a form that the particular device can understand.</p>
<p>Device drivers are started by calling a device driver function. There is one such function for every device driver: type <code class="code">help(Devices)</code> for a list of them all. For example, issuing the command</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">postscript</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>causes all future graphics output to be sent to the printer in PostScript format. Some commonly-used device drivers are:</p>
<p>: For use with the X11 window system on Unix-alikes</p>
<p>: For use on Windows</p>
<p>: For use on macOS</p>
<p>: For printing on PostScript printers, or creating PostScript graphics files.</p>
<p>: Produces a PDF file, which can also be included into PDF files.</p>
<p>: Produces a bitmap PNG file. (Not always available: see its help page.)</p>
<p>: Produces a bitmap JPEG file, best used for <code class="code">image</code> plots. (Not always available: see its help page.)</p>
<p>When you have finished with a device, be sure to terminate the device driver by issuing the command</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This ensures that the device finishes cleanly; for example in the case of hardcopy devices this ensures that every page is completed and has been sent to the printer. (This will happen automatically at the normal end of a session.)</p>
<section id="postscript-diagrams-for-typeset-documents" class="level3 subsection" data-number="12.6.1">
<h3 class="subsection anchored" data-number="12.6.1" data-anchor-id="postscript-diagrams-for-typeset-documents"><span class="header-section-number">12.6.1</span> PostScript diagrams for typeset documents</h3>
<p>By passing the <code class="code">file</code> argument to the <code class="code">postscript()</code> device driver function, you may store the graphics in PostScript format in a file of your choice. The plot will be in landscape orientation unless the <code class="code">horizontal=FALSE</code> argument is given, and you can control the size of the graphic with the <code class="code">width</code> and <code class="code">height</code> arguments (the plot will be scaled as appropriate to fit these dimensions.) For example, the command</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> postscript<span class="op">(</span><span class="st">"file.ps"</span><span class="op">,</span> horizontal<span class="op">=</span>FALSE<span class="op">,</span> height<span class="op">=</span><span class="dv">5</span><span class="op">,</span> pointsize<span class="op">=</span><span class="dv">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>will produce a file containing PostScript code for a figure five inches high, perhaps for inclusion in a document. It is important to note that if the file named in the command already exists, it will be overwritten. This is the case even if the file was only created earlier in the same R session.</p>
<p>Many usages of PostScript output will be to incorporate the figure in another document. This works best when <em>encapsulated</em> PostScript is produced: R always produces conformant output, but only marks the output as such when the <code class="code">onefile=FALSE</code> argument is supplied. This unusual notation stems from S-compatibility: it really means that the output will be a single page (which is part of the EPSF specification). Thus to produce a plot for inclusion use something like</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> postscript<span class="op">(</span><span class="st">"plot1.eps"</span><span class="op">,</span> horizontal<span class="op">=</span>FALSE<span class="op">,</span> onefile<span class="op">=</span>FALSE<span class="op">,</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>             height<span class="op">=</span><span class="dv">8</span><span class="op">,</span> width<span class="op">=</span><span class="dv">6</span><span class="op">,</span> pointsize<span class="op">=</span><span class="dv">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="multiple-graphics-devices" class="level3 subsection" data-number="12.6.2">
<h3 class="subsection anchored" data-number="12.6.2" data-anchor-id="multiple-graphics-devices"><span class="header-section-number">12.6.2</span> Multiple graphics devices</h3>
<p>In advanced use of R it is often useful to have several graphics devices in use at the same time. Of course only one graphics device can accept graphics commands at any one time, and this is known as the <em>current device</em>. When multiple devices are open, they form a numbered sequence with names giving the kind of device at any position.</p>
<p>The main commands used for operating with multiple devices, and their meanings are as follows:</p>
<dl>
<dt><code class="code">X11()</code></dt>
<dd>
<p>[UNIX]</p>
</dd>
</dl>
<p><code class="code">windows()</code><br>
<code class="code">win.printer()</code><br>
<code class="code">win.metafile()</code></p>
<p>: [Windows]</p>
<dl>
<dt><code class="code">quartz()</code></dt>
<dd>
<p>[macOS]</p>
</dd>
</dl>
<p><code class="code">postscript()</code><br>
<code class="code">pdf()</code><br>
<code class="code">png()</code><br>
<code class="code">jpeg()</code><br>
<code class="code">tiff()</code><br>
<code class="code">bitmap()</code><br>
<code class="code">...</code></p>
<p>: Each new call to a device driver function opens a new graphics device, thus extending by one the device list. This device becomes the current device, to which graphics output will be sent.</p>
<p>: Returns the number and name of all active devices. The device at position 1 on the list is always the <em>null device</em> which does not accept graphics commands at all.</p>
<p><span id="index-dev_002eprev" class="index-entry-id"></span> <span id="index-dev_002enext"></span><code class="code">dev.next()</code><br>
<code class="code">dev.prev()</code></p>
<p>: Returns the number and name of the graphics device next to, or previous to the current device, respectively.</p>
<p>: Can be used to change the current graphics device to the one at position <var class="var">k</var> of the device list. Returns the number and label of the device.</p>
<p>: Terminate the graphics device at point <var class="var">k</var> of the device list. For some devices, such as <code class="code">postscript</code> devices, this will either print the file immediately or correctly complete the file for later printing, depending on how the device was initiated.</p>
<p><code class="code">dev.copy(device, ..., which=</code><var class="var">k</var><code class="code">)</code><br>
<code class="code">dev.print(device, ..., which=</code><var class="var">k</var><code class="code">)</code></p>
<p>: Make a copy of the device <var class="var">k</var>. Here <code class="code">device</code> is a device function, such as <code class="code">postscript</code>, with extra arguments, if needed, specified by <samp class="samp">...</samp>’. <code class="code">dev.print</code> is similar, but the copied device is immediately closed, so that end actions, such as printing hardcopies, are immediately performed.</p>
<dl>
<dt><code class="code">graphics.off()</code></dt>
<dd>
<p>Terminate all graphics devices on the list, except the null device.</p>
</dd>
</dl>
</section>
</section>
<section id="dynamic-graphics" class="level2 section" data-number="12.7">
<h2 class="section anchored" data-number="12.7" data-anchor-id="dynamic-graphics"><span class="header-section-number">12.7</span> Dynamic graphics</h2>
<p>R does not have builtin capabilities for dynamic or interactive graphics, e.g.&nbsp;rotating point clouds or to “brushing” (interactively highlighting) points. However, extensive dynamic graphics facilities are available in the system GGobi by Swayne, Cook and Buja available from</p>
<blockquote class="blockquote">
<p><a href="http://ggobi.org/" class="uref">http://ggobi.org/</a></p>
</blockquote>
<p>and these can be accessed from R via the package <a href="https://CRAN.R-project.org/package=rggobi" class="url"><strong>rggobi</strong></a>, described at <a href="http://ggobi.org/rggobi.html" class="uref">http://ggobi.org/rggobi.html</a>.</p>
<p>Also, package <a href="https://CRAN.R-project.org/package=rgl" class="url"><strong>rgl</strong></a> provides ways to interact with 3D plots, for example of surfaces.</p>

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Statistical-models-in-R.html" class="pagination-link" aria-label="Statistical models in R">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Statistical models in R</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Packages.html" class="pagination-link" aria-label="Packages">
        <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Packages</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>A re-styled version of the original R manuals at <a href="https://cran.r-project.org/manuals.html" class="uri">https://cran.r-project.org/manuals.html</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Built using <a href="https://quarto.org">Quarto</a></p>
</div>
  </div>
</footer>




</body></html>